<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>统计项目代码行数</title>
      <link href="2021/09/10/%E7%BB%9F%E8%AE%A1%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E8%A1%8C%E6%95%B0/"/>
      <url>2021/09/10/%E7%BB%9F%E8%AE%A1%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E8%A1%8C%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="linux-系统下统计代码行数"><a href="#linux-系统下统计代码行数" class="headerlink" title="linux 系统下统计代码行数"></a>linux 系统下统计代码行数</h2><ol><li>包括空行（会列出每个文件的代码行数）：<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find . <span class="string">&quot;(&quot;</span> -name “*.java” -or -name “*.xml” -or -name “*.properties” -or -name “*.js” -or -name “*.css” -or -name “*.html” <span class="string">&quot;)&quot;</span> -<span class="built_in">print</span> | xargs wc -l</span><br></pre></td></tr></table></figure></li><li>不包括空行（只会出现总行数）：<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find . <span class="string">&quot;(&quot;</span> -name “*.java” -or -name “*.xml” -or -name “*.properties” -or -name “*.js” -or -name “*.css” -or -name “*.html” <span class="string">&quot;)&quot;</span> -<span class="built_in">print</span> | xargs grep -v <span class="string">&quot;^$&quot;</span>|wc -l</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> utils </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2021/09/10/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%BE%E7%BD%AE%E5%92%8C%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>2021/09/10/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%BE%E7%BD%AE%E5%92%8C%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux-服务器设置和常用命令"><a href="#Linux-服务器设置和常用命令" class="headerlink" title="Linux 服务器设置和常用命令"></a>Linux 服务器设置和常用命令</h1><h2 id="进程相关"><a href="#进程相关" class="headerlink" title="进程相关"></a>进程相关</h2><h3 id="查看进程pid"><a href="#查看进程pid" class="headerlink" title="查看进程pid"></a>查看进程pid</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ps -ef|grep 进程名</span><br></pre></td></tr></table></figure><h2 id="防火墙及安全"><a href="#防火墙及安全" class="headerlink" title="防火墙及安全"></a>防火墙及安全</h2><h3 id="centos7-linux开端口号"><a href="#centos7-linux开端口号" class="headerlink" title="centos7 linux开端口号"></a>centos7 linux开端口号</h3><p>开放端口号方法(–permanent 永久开放)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --add-port=8080/tcp --permanent</span><br></pre></td></tr></table></figure><p>重启加载规则</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><p>查询端口是否开启命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --query-port=8080/tcp</span><br></pre></td></tr></table></figure><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><h3 id="JDK-1-8"><a href="#JDK-1-8" class="headerlink" title="JDK 1.8"></a>JDK 1.8</h3><p>安装之前先检查一下系统有没有自带open-jdk</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rpm -qa |grep java</span><br><span class="line">rpm -qa |grep jdk</span><br><span class="line">rpm -qa |grep gcj</span><br></pre></td></tr></table></figure><p>如果没有输入信息表示没有安装。</p><blockquote><p>如果安装可以使用rpm -qa | grep java | xargs rpm -e –nodeps 批量卸载所有带有Java的文件  这句命令的关键字是java</p></blockquote><p>首先检索包含java的列表</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum list java*</span><br></pre></td></tr></table></figure><p>检索1.8的列表</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum list java-1.8*</span><br></pre></td></tr></table></figure><p>安装1.8.0的所有文件</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install java-1.8.0-openjdk* -y</span><br></pre></td></tr></table></figure><p>使用命令检查是否安装成功</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure><h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><h3 id="CentOS更换yum安装源"><a href="#CentOS更换yum安装源" class="headerlink" title="CentOS更换yum安装源"></a>CentOS更换yum安装源</h3><blockquote><p>源所在的目录:     /etc/yum.repos.d/    ==在更换之前可以先备份自己的源,防止出错==</p></blockquote><ol><li><p>Centos 5.X 安装阿里或者网易的源</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;repo&#x2F;Centos-5.repo</span><br><span class="line">wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo http:&#x2F;&#x2F;mirrors.163.com&#x2F;.help&#x2F;CentOS5-Base-163.repo</span><br></pre></td></tr></table></figure></li><li><p>Centos 6.X 安装阿里或者网易的源</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;repo&#x2F;Centos-6.repo</span><br><span class="line">wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo http:&#x2F;&#x2F;mirrors.163.com&#x2F;.help&#x2F;CentOS6-Base-163.repo</span><br></pre></td></tr></table></figure></li><li><p>下载成功以后执行命令</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure></li><li><p>当yum makecache完成以后,源就安装完了</p></li></ol><h3 id="CentOS-安装rz和sz命令"><a href="#CentOS-安装rz和sz命令" class="headerlink" title="CentOS 安装rz和sz命令"></a>CentOS 安装rz和sz命令</h3>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install lrzsz</span><br></pre></td></tr></table></figure><h3 id="CentOS-安装Mysql"><a href="#CentOS-安装Mysql" class="headerlink" title="CentOS 安装Mysql"></a>CentOS 安装Mysql</h3><p>  见MySQL总结</p><h3 id="CentOS-安装tomcat"><a href="#CentOS-安装tomcat" class="headerlink" title="CentOS 安装tomcat"></a>CentOS 安装tomcat</h3><p>  见tomcat总结</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2021/09/10/POI%E6%95%B0%E6%8D%AE%E6%9C%89%E6%95%88%E6%80%A7%E6%A0%A1%E9%AA%8C/"/>
      <url>2021/09/10/POI%E6%95%B0%E6%8D%AE%E6%9C%89%E6%95%88%E6%80%A7%E6%A0%A1%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="POI数据有效性校验"><a href="#POI数据有效性校验" class="headerlink" title="POI数据有效性校验"></a>POI数据有效性校验</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 添加数据有效性检查.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> sheet 要添加此检查的Sheet</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> firstRow 开始行</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> lastRow 结束行</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> firstCol 开始列</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> lastCol 结束列</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> explicitListValues 有效性检查的下拉列表</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IllegalArgumentException 如果传入的行或者列小于0(&lt; 0)或者结束行/列比开始行/列小</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setValidationData</span><span class="params">(Sheet sheet, <span class="keyword">int</span> firstRow,  <span class="keyword">int</span> lastRow,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> firstCol,  <span class="keyword">int</span> lastCol,String[] explicitListValues)</span> <span class="keyword">throws</span> IllegalArgumentException</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (firstRow &lt; <span class="number">0</span> || lastRow &lt; <span class="number">0</span> || firstCol &lt; <span class="number">0</span> || lastCol &lt; <span class="number">0</span> || lastRow &lt; firstRow || lastCol &lt; firstCol) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Wrong Row or Column index : &quot;</span> + firstRow+<span class="string">&quot;:&quot;</span>+lastRow+<span class="string">&quot;:&quot;</span>+firstCol+<span class="string">&quot;:&quot;</span> +lastCol);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sheet <span class="keyword">instanceof</span> XSSFSheet) &#123;</span><br><span class="line">        XSSFDataValidationHelper dvHelper = <span class="keyword">new</span> XSSFDataValidationHelper((XSSFSheet)sheet);</span><br><span class="line">        XSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint) dvHelper</span><br><span class="line">                .createExplicitListConstraint(explicitListValues);</span><br><span class="line">        CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(firstRow, lastRow, firstCol, lastCol);</span><br><span class="line">        XSSFDataValidation validation = (XSSFDataValidation) dvHelper.createValidation(dvConstraint, addressList);</span><br><span class="line">        validation.setSuppressDropDownArrow(<span class="keyword">true</span>);</span><br><span class="line">        validation.setShowErrorBox(<span class="keyword">true</span>);</span><br><span class="line">        sheet.addValidationData(validation);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(sheet <span class="keyword">instanceof</span> HSSFSheet)&#123;</span><br><span class="line">        CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(firstRow, lastRow, firstCol, lastCol);</span><br><span class="line">        DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(explicitListValues);</span><br><span class="line">        DataValidation validation = <span class="keyword">new</span> HSSFDataValidation(addressList, dvConstraint);</span><br><span class="line">        validation.setSuppressDropDownArrow(<span class="keyword">true</span>);</span><br><span class="line">        validation.setShowErrorBox(<span class="keyword">true</span>);</span><br><span class="line">        sheet.addValidationData(validation);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2021/09/10/UML%E5%BB%BA%E6%A8%A1/"/>
      <url>2021/09/10/UML%E5%BB%BA%E6%A8%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h1><h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><ul><li>用例视图<ul><li>用例图</li></ul></li><li>逻辑视图<ul><li>静态结构<ul><li>类图</li><li>对象图</li></ul></li><li>动态模型<ul><li>状态图</li><li>时序图</li><li>协作图</li><li>活动图</li></ul></li></ul></li><li>组件视图<ul><li>组件图</li></ul></li><li>实现视图<ul><li>动态图<ul><li>状态图</li><li>协作图</li><li>活动图</li></ul></li><li>实现图<ul><li>组件图</li><li>部署图</li></ul></li></ul></li><li>部署视图<ul><li>部署图</li></ul></li></ul><h2 id="软件开发模型"><a href="#软件开发模型" class="headerlink" title="软件开发模型"></a>软件开发模型</h2><h3 id="软件开发经典模型"><a href="#软件开发经典模型" class="headerlink" title="软件开发经典模型"></a>软件开发经典模型</h3><ul><li>传统软件开发模型<ul><li>瀑布模型/声明周期模型 √</li><li>快速原型 √</li></ul></li><li>软件演化模型<ul><li>增量模型</li><li>螺旋模型</li></ul></li><li>面向对象开发模型<ul><li>喷泉模型 √</li><li>构件集成模型</li></ul></li><li>形式化方法模型<ul><li>转换模型</li><li>净室模型</li></ul></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2021/09/10/mysql%E5%A4%87%E4%BB%BD/"/>
      <url>2021/09/10/mysql%E5%A4%87%E4%BB%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="Mysql备份"><a href="#Mysql备份" class="headerlink" title="Mysql备份"></a>Mysql备份</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">PATH=/<span class="built_in">bin</span>:/sbin:/usr/<span class="built_in">bin</span>:/usr/sbin:/usr/local/<span class="built_in">bin</span>:/usr/local/sbin</span><br><span class="line">export PATH</span><br><span class="line"></span><br><span class="line"><span class="comment">#数据库ip</span></span><br><span class="line">DBHOST=<span class="string">&#x27;xxx.xxx.xxx.xxx&#x27;</span> // your db host</span><br><span class="line"><span class="comment">#数据库用户名</span></span><br><span class="line">DBUSER=<span class="string">&#x27;admin&#x27;</span> // 数据库用户名</span><br><span class="line"><span class="comment">#数据库用密码</span></span><br><span class="line">DBPASSWD=<span class="string">&#x27;password&#x27;</span> // 数据库用户名对应的密码</span><br><span class="line"><span class="comment">#需要备份的数据库，多个数据库用空格分开</span></span><br><span class="line">DBNAME=<span class="string">&#x27;dbname&#x27;</span> // 数据库名</span><br><span class="line"></span><br><span class="line"><span class="comment">#备份时间</span></span><br><span class="line">backtime=`date +%Y-%m-%d_%H%M%S`</span><br><span class="line"><span class="comment">#备份路径（当前目录）</span></span><br><span class="line">BACKPATH=$(dirname $(readlink -f $<span class="number">0</span>))</span><br><span class="line">echo $BACKPATH</span><br><span class="line"><span class="comment">#日志备份路径</span></span><br><span class="line">LOGPATH=<span class="string">&quot;$&#123;BACKPATH&#125;/log&quot;</span></span><br><span class="line"><span class="comment">#数据备份路径</span></span><br><span class="line">DBPATH=<span class="string">&quot;$&#123;BACKPATH&#125;/db&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建备份目录</span></span><br><span class="line">[ ! -d <span class="string">&quot;$&#123;LOGPATH&#125;&quot;</span> ] &amp;&amp; mkdir -p <span class="string">&quot;$&#123;LOGPATH&#125;&quot;</span></span><br><span class="line">[ ! -d <span class="string">&quot;$&#123;DBPATH&#125;&quot;</span> ] &amp;&amp; mkdir -p <span class="string">&quot;$&#123;DBPATH&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#日志记录头部</span></span><br><span class="line">echo <span class="string">&quot;备份时间为$&#123;backtime&#125;,备份数据库表 $&#123;DBNAME&#125; 开始&quot;</span> &gt;&gt; $&#123;LOGPATH&#125;/mysqlback.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#正式备份数据库</span></span><br><span class="line"><span class="keyword">for</span> table <span class="keyword">in</span> $DBNAME; do</span><br><span class="line">source=`mysqldump -u $&#123;DBUSER&#125; -h$&#123;DBHOST&#125; -p$&#123;DBPASSWD&#125; $&#123;table&#125;&gt; $&#123;LOGPATH&#125;/$&#123;backtime&#125;.sql` <span class="number">2</span>&gt;&gt; $&#123;LOGPATH&#125;/mysqlback.log;</span><br><span class="line"></span><br><span class="line"><span class="comment">#备份成功以下操作 $?获取上一个命令的操作结果，0代表成功</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;$?&quot;</span> == <span class="number">0</span> ];then</span><br><span class="line">cd $&#123;LOGPATH&#125;</span><br><span class="line"><span class="comment">#为节约硬盘空间，将数据库压缩</span></span><br><span class="line">tar -czf $&#123;DBPATH&#125;/$&#123;table&#125;$&#123;backtime&#125;.tar.gz ./$&#123;backtime&#125;.sql &gt; /dev/null</span><br><span class="line"><span class="comment">#删除原始文件，只留压缩后文件</span></span><br><span class="line">rm -f $&#123;LOGPATH&#125;/$&#123;backtime&#125;.sql</span><br><span class="line"><span class="comment">#删除七天前备份，也就是只保存7天内的备份</span></span><br><span class="line">find $DBPATH -name <span class="string">&quot;*.tar.gz&quot;</span> -<span class="built_in">type</span> f -mtime +<span class="number">7</span> -<span class="built_in">exec</span> rm -rf &#123;&#125; \; &gt; /dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">echo <span class="string">&quot;数据库表 $&#123;DBNAME&#125; 备份成功!!&quot;</span> &gt;&gt; $&#123;LOGPATH&#125;/mysqlback.log</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="comment">#备份失败则进行以下操作</span></span><br><span class="line">echo <span class="string">&quot;数据库表 $&#123;DBNAME&#125; 备份失败!!&quot;</span> &gt;&gt; $&#123;LOGPATH&#125;/mysqlback.log</span><br><span class="line">fi</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2021/09/10/tomcat%E5%AE%89%E8%A3%85%E8%AE%BE%E7%BD%AE%E5%8F%8A%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>2021/09/10/tomcat%E5%AE%89%E8%A3%85%E8%AE%BE%E7%BD%AE%E5%8F%8A%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="Tomcat-安装设置及性能优化"><a href="#Tomcat-安装设置及性能优化" class="headerlink" title="Tomcat 安装设置及性能优化"></a>Tomcat 安装设置及性能优化</h1><pre><code>apache-tomcat-8.5.9.tar.gz下载地址：http://tomcat.apache.org/download-80.cgi作为进程启动时，需要下载 commons-daemon下载地址： https://www.apache.org/dist/commons/daemon/source/</code></pre><h2 id="tar-安装"><a href="#tar-安装" class="headerlink" title="tar 安装"></a>tar 安装</h2><h3 id="目录配置"><a href="#目录配置" class="headerlink" title="目录配置"></a>目录配置</h3>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">unzip apache-tomcat-8.5.9.zip</span><br><span class="line">mkdir -p /usr/<span class="built_in">local</span>/java</span><br><span class="line">mv apache-tomcat-8.5.9 /usr/<span class="built_in">local</span>/java/tomcat</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/java/tomcat</span><br><span class="line">chmod 777 bin/*</span><br></pre></td></tr></table></figure><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3>  <figure class="highlight"><table><tr><td class="code"><pre><span class="line">echo &quot;export TOMCAT_HOME=/usr/local/java/tomcat&quot; &gt;&gt; /etc/profile</span><br><span class="line">echo &quot;export CATALINA_HOME=/usr/local/java/tomcat&quot; &gt;&gt; /etc/profile</span><br><span class="line">echo &quot;export CATALINA_BASE=/usr/local/java/tomcat&quot; &gt;&gt; /etc/profile</span><br><span class="line">source /etc/profile</span><br><span class="line">echo $TOMCAT_HOME</span><br><span class="line">echo $CATALINA_HOME</span><br><span class="line">echo $CATALINA_BASE</span><br></pre></td></tr></table></figure><h3 id="Tomcat-启动-关闭方法"><a href="#Tomcat-启动-关闭方法" class="headerlink" title="Tomcat 启动/关闭方法"></a>Tomcat 启动/关闭方法</h3>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/startup.sh</span><br><span class="line">./bin/shutdown.sh</span><br></pre></td></tr></table></figure><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h3><pre><code>这个需要在conf/server.xml里面看是否reloadable选项设置为了false，默认是true.</code></pre><h3 id="数据源设置"><a href="#数据源设置" class="headerlink" title="数据源设置"></a>数据源设置</h3><ol><li>context.xml<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ResourceLink</span> <span class="attr">global</span>=<span class="string">&quot;jdbc/ggwl&quot;</span> <span class="attr">name</span>=<span class="string">&quot;jdbc/ggwl&quot;</span> <span class="attr">type</span>=<span class="string">&quot;javax.sql.DataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>server.xml<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Resource</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">scope</span>=<span class="string">&quot;Shareable&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">&quot;javax.sql.DataSource&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">maxActive</span>=<span class="string">&quot;10&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">maxIdle</span>=<span class="string">&quot;5&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">maxWait</span>=<span class="string">&quot;10000&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">&quot;jdbc/ggwl&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">factory</span>=<span class="string">&quot;org.apache.commons.dbcp2.BasicDataSourceFactory&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">driverClassName</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">url</span>=<span class="string">&quot;jdbc:mysql://172.18.66.7:3306/wms?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">username</span>=<span class="string">&quot;wms&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">password</span>=<span class="string">&quot;Wms%#!&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2021/09/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/"/>
      <url>2021/09/10/Redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis安装配置"><a href="#Redis安装配置" class="headerlink" title="Redis安装配置"></a>Redis安装配置</h1><h2 id="安装-配置"><a href="#安装-配置" class="headerlink" title="安装|配置"></a>安装|配置</h2><h3 id="linux版"><a href="#linux版" class="headerlink" title="linux版"></a>linux版</h3><p>linux版的可以到<a href="https://redis.io/">https://redis.io/</a> 或者是 <a href="http://www.redis.cn/">http://www.redis.cn/</a> 下载需要版本的源代码。<br>因为是源代码且底层是c开发的，所以需要c的编译环境。<br>如果make命令能够使用，则证明已经有了c环境了。没有c环境则可以使用yum install gcc-c++</p><p>安装步骤</p><ol><li>把redis的源码包上传到linux系统，如果直接在Linux环境下下载的，不需要这步。</li><li>使用tar -zxvf redis-3.x.x.tar.gz解压源码包</li><li>进入解压出来的目录redis-3.x.x</li><li>使用make install PREFIX=编译源码，生成可执行文件</li></ol><p>- PREFIX参数：指定安装目录</p><h3 id="redis的启动"><a href="#redis的启动" class="headerlink" title="redis的启动"></a>redis的启动</h3><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># ./redis-server redis.conf</span></span><br></pre></td></tr></table></figure><h3 id="Redis的关闭"><a href="#Redis的关闭" class="headerlink" title="Redis的关闭"></a>Redis的关闭</h3><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># ps aux | grep redis</span></span><br><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># kill xxx</span></span><br></pre></td></tr></table></figure><p>PS：也可以使用命令关闭使用命令关闭：</p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># ./redis-server redis.conf</span></span><br><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># ps aux | grep redis</span></span><br><span class="line">  root 1121 0.0 0.7 140840 7460 ? Ssl 15:14 0:00 ./redis-server 127.0.0.1:6379</span><br><span class="line">  root 1139 0.0 0.0 110216 900 pts/0 S+ 15:14 0:00 grep --color=auto redis</span><br><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># ./redis-cli -p 6379 shutdown</span></span><br><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment"># ps aux | grep redis</span></span><br><span class="line">  root 1189 0.0 0.0 110216 896 pts/0 S+ 15:14 0:00 grep --color=auto redis</span><br><span class="line">  root 1892 0.1 0.6 140836 6572 ? Ssl Aug19 146:42 /usr/local/redis/bin/redis-server 127.0.0.1:6379</span><br><span class="line"><span class="section">[root@iZ28xuvyce3Z bin]</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="Redis-conf设置详解"><a href="#Redis-conf设置详解" class="headerlink" title="Redis.conf设置详解"></a>Redis.conf设置详解</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment"># redis 配置文件示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当你需要为某个配置项指定内存大小的时候，必须要带上单位，</span></span><br><span class="line"><span class="comment"># 通常的格式就是 1k 5gb 4m 等酱紫：</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1k  =&gt; 1000 bytes</span></span><br><span class="line"><span class="comment"># 1kb =&gt; 1024 bytes</span></span><br><span class="line"><span class="comment"># 1m  =&gt; 1000000 bytes</span></span><br><span class="line"><span class="comment"># 1mb =&gt; 1024*1024 bytes</span></span><br><span class="line"><span class="comment"># 1g  =&gt; 1000000000 bytes</span></span><br><span class="line"><span class="comment"># 1gb =&gt; 1024*1024*1024 bytes</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 单位是不区分大小写的，你写 1K 5GB 4M 也行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## INCLUDES ###################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 假如说你有一个可用于所有的 redis server 的标准配置模板，</span></span><br><span class="line"><span class="comment"># 但针对某些 server 又需要一些个性化的设置，</span></span><br><span class="line"><span class="comment"># 你可以使用 include 来包含一些其他的配置文件，这对你来说是非常有用的。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 但是要注意哦，include 是不能被 config rewrite 命令改写的</span></span><br><span class="line"><span class="comment"># 由于 redis 总是以最后的加工线作为一个配置指令值，所以你最好是把 include 放在这个文件的最前面，</span></span><br><span class="line"><span class="comment"># 以避免在运行时覆盖配置的改变，相反，你就把它放在后面（外国人真啰嗦）。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># include /path/to/local.conf</span></span><br><span class="line"><span class="comment"># include /path/to/other.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################ 常用 #####################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认情况下 redis 不是作为守护进程运行的，如果你想让它在后台运行，你就把它改成 yes。</span></span><br><span class="line"><span class="comment"># 当redis作为守护进程运行的时候，它会写一个 pid 到 /var/run/redis.pid 文件里面。</span></span><br><span class="line">daemonize no</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当redis作为守护进程运行的时候，它会把 pid 默认写到 /var/run/redis.pid 文件里面，</span></span><br><span class="line"><span class="comment"># 但是你可以在这里自己制定它的文件位置。</span></span><br><span class="line">pidfile /var/run/redis.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听端口号，默认为 6379，如果你设为 0 ，redis 将不在 socket 上监听任何客户端连接。</span></span><br><span class="line">port 6379</span><br><span class="line"></span><br><span class="line"><span class="comment"># TCP 监听的最大容纳数量</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 在高并发的环境下，你需要把这个值调高以避免客户端连接缓慢的问题。</span></span><br><span class="line"><span class="comment"># Linux 内核会一声不响的把这个值缩小成 /proc/sys/net/core/somaxconn 对应的值，</span></span><br><span class="line"><span class="comment"># 所以你要修改这两个值才能达到你的预期。</span></span><br><span class="line">tcp-backlog 511</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认情况下，redis 在 server 上所有有效的网络接口上监听客户端连接。</span></span><br><span class="line"><span class="comment"># 你如果只想让它在一个网络接口上监听，那你就绑定一个IP或者多个IP。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 示例，多个IP用空格隔开:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># bind 192.168.1.100 10.0.0.1</span></span><br><span class="line"><span class="comment"># bind 127.0.0.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定 unix socket 的路径。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># unixsocket /tmp/redis.sock</span></span><br><span class="line"><span class="comment"># unixsocketperm 755</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定在一个 client 空闲多少秒之后关闭连接（0 就是不管它）</span></span><br><span class="line">timeout 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># tcp 心跳包。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 如果设置为非零，则在与客户端缺乏通讯的时候使用 SO_KEEPALIVE 发送 tcp acks 给客户端。</span></span><br><span class="line"><span class="comment"># 这个之所有有用，主要由两个原因：</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1) 防止死的 peers</span></span><br><span class="line"><span class="comment"># 2) Take the connection alive from the point of view of network</span></span><br><span class="line"><span class="comment">#    equipment in the middle.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># On Linux, the specified value (in seconds) is the period used to send ACKs.</span></span><br><span class="line"><span class="comment"># Note that to close the connection the double of the time is needed.</span></span><br><span class="line"><span class="comment"># On other kernels the period depends on the kernel configuration.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A reasonable value for this option is 60 seconds.</span></span><br><span class="line"><span class="comment"># 推荐一个合理的值就是60秒</span></span><br><span class="line">tcp-keepalive 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义日志级别。</span></span><br><span class="line"><span class="comment"># 可以是下面的这些值：</span></span><br><span class="line"><span class="comment"># debug (适用于开发或测试阶段)</span></span><br><span class="line"><span class="comment"># verbose (many rarely useful info, but not a mess like the debug level)</span></span><br><span class="line"><span class="comment"># notice (适用于生产环境)</span></span><br><span class="line"><span class="comment"># warning (仅仅一些重要的消息被记录)</span></span><br><span class="line">loglevel notice</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定日志文件的位置</span></span><br><span class="line">logfile &quot;&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要想把日志记录到系统日志，就把它改成 yes，</span></span><br><span class="line"><span class="comment"># 也可以可选择性的更新其他的syslog 参数以达到你的要求</span></span><br><span class="line"><span class="comment"># syslog-enabled no</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 syslog 的 identity。</span></span><br><span class="line"><span class="comment"># syslog-ident redis</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 syslog 的 facility，必须是 USER 或者是 LOCAL0-LOCAL7 之间的值。</span></span><br><span class="line"><span class="comment"># syslog-facility local0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置数据库的数目。</span></span><br><span class="line"><span class="comment"># 默认数据库是 DB 0，你可以在每个连接上使用 select &lt;dbid&gt; 命令选择一个不同的数据库，</span></span><br><span class="line"><span class="comment"># 但是 dbid 必须是一个介于 0 到 databasees - 1 之间的值</span></span><br><span class="line">databases 16</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ 快照 ################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 存 DB 到磁盘：</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   格式：save &lt;间隔时间（秒）&gt; &lt;写入次数&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   根据给定的时间间隔和写入次数将数据保存到磁盘</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   下面的例子的意思是：</span></span><br><span class="line"><span class="comment">#   900 秒内如果至少有 1 个 key 的值变化，则保存</span></span><br><span class="line"><span class="comment">#   300 秒内如果至少有 10 个 key 的值变化，则保存</span></span><br><span class="line"><span class="comment">#   60 秒内如果至少有 10000 个 key 的值变化，则保存</span></span><br><span class="line"><span class="comment">#　　</span></span><br><span class="line"><span class="comment">#   注意：你可以注释掉所有的 save 行来停用保存功能。</span></span><br><span class="line"><span class="comment">#   也可以直接一个空字符串来实现停用：</span></span><br><span class="line"><span class="comment">#   save &quot;&quot;</span></span><br><span class="line"></span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认情况下，如果 redis 最后一次的后台保存失败，redis 将停止接受写操作，</span></span><br><span class="line"><span class="comment"># 这样以一种强硬的方式让用户知道数据不能正确的持久化到磁盘，</span></span><br><span class="line"><span class="comment"># 否则就会没人注意到灾难的发生。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 如果后台保存进程重新启动工作了，redis 也将自动的允许写操作。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 然而你要是安装了靠谱的监控，你可能不希望 redis 这样做，那你就改成 no 好了。</span></span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否在 dump .rdb 数据库的时候使用 LZF 压缩字符串</span></span><br><span class="line"><span class="comment"># 默认都设为 yes</span></span><br><span class="line"><span class="comment"># 如果你希望保存子进程节省点 cpu ，你就设置它为 no ，</span></span><br><span class="line"><span class="comment"># 不过这个数据集可能就会比较大</span></span><br><span class="line">rdbcompression yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否校验rdb文件</span></span><br><span class="line">rdbchecksum yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 dump 的文件位置</span></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 工作目录</span></span><br><span class="line"><span class="comment"># 例如上面的 dbfilename 只指定了文件名，</span></span><br><span class="line"><span class="comment"># 但是它会写入到这个目录下。这个配置项一定是个目录，而不能是文件名。</span></span><br><span class="line">dir ./</span><br><span class="line"></span><br><span class="line"><span class="comment">################################# 主从复制 #################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主从复制。使用 slaveof 来让一个 redis 实例成为另一个reids 实例的副本。</span></span><br><span class="line"><span class="comment"># 注意这个只需要在 slave 上配置。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 master 需要密码认证，就在这里设置</span></span><br><span class="line"><span class="comment"># masterauth &lt;master-password&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当一个 slave 与 master 失去联系，或者复制正在进行的时候，</span></span><br><span class="line"><span class="comment"># slave 可能会有两种表现：</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1) 如果为 yes ，slave 仍然会应答客户端请求，但返回的数据可能是过时，</span></span><br><span class="line"><span class="comment">#    或者数据可能是空的在第一次同步的时候</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2) 如果为 no ，在你执行除了 info he salveof 之外的其他命令时，</span></span><br><span class="line"><span class="comment">#    slave 都将返回一个 &quot;SYNC with master in progress&quot; 的错误，</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">slave-serve-stale-data yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 你可以配置一个 slave 实体是否接受写入操作。</span></span><br><span class="line"><span class="comment"># 通过写入操作来存储一些短暂的数据对于一个 slave 实例来说可能是有用的，</span></span><br><span class="line"><span class="comment"># 因为相对从 master 重新同步数而言，据数据写入到 slave 会更容易被删除。</span></span><br><span class="line"><span class="comment"># 但是如果客户端因为一个错误的配置写入，也可能会导致一些问题。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 从 redis 2.6 版起，默认 slaves 都是只读的。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> read only slaves are not designed to be exposed to untrusted clients</span></span><br><span class="line"><span class="comment"># on the internet. It&#x27;s just a protection layer against misuse of the instance.</span></span><br><span class="line"><span class="comment"># Still a read only slave exports by default all the administrative commands</span></span><br><span class="line"><span class="comment"># such as CONFIG, DEBUG, and so forth. To a limited extent you can improve</span></span><br><span class="line"><span class="comment"># security of read only slaves using &#x27;rename-command&#x27; to shadow all the</span></span><br><span class="line"><span class="comment"># administrative / dangerous commands.</span></span><br><span class="line"><span class="comment"># 注意：只读的 slaves 没有被设计成在 internet 上暴露给不受信任的客户端。</span></span><br><span class="line"><span class="comment"># 它仅仅是一个针对误用实例的一个保护层。</span></span><br><span class="line">slave-read-only yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slaves 在一个预定义的时间间隔内发送 ping 命令到 server 。</span></span><br><span class="line"><span class="comment"># 你可以改变这个时间间隔。默认为 10 秒。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># repl-ping-slave-period 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The following option sets the replication timeout for:</span></span><br><span class="line"><span class="comment"># 设置主从复制过期时间</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1) Bulk transfer I/O during SYNC, from the point of view of slave.</span></span><br><span class="line"><span class="comment"># 2) Master timeout from the point of view of slaves (data, pings).</span></span><br><span class="line"><span class="comment"># 3) Slave timeout from the point of view of masters (REPLCONF ACK pings).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It is important to make sure that this value is greater than the value</span></span><br><span class="line"><span class="comment"># specified for repl-ping-slave-period otherwise a timeout will be detected</span></span><br><span class="line"><span class="comment"># every time there is low traffic between the master and the slave.</span></span><br><span class="line"><span class="comment"># 这个值一定要比 repl-ping-slave-period 大</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># repl-timeout 60</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Disable TCP_NODELAY on the slave socket after SYNC?</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If you select &quot;yes&quot; Redis will use a smaller number of TCP packets and</span></span><br><span class="line"><span class="comment"># less bandwidth to send data to slaves. But this can add a delay for</span></span><br><span class="line"><span class="comment"># the data to appear on the slave side, up to 40 milliseconds with</span></span><br><span class="line"><span class="comment"># Linux kernels using a default configuration.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If you select &quot;no&quot; the delay for data to appear on the slave side will</span></span><br><span class="line"><span class="comment"># be reduced but more bandwidth will be used for replication.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># By default we optimize for low latency, but in very high traffic conditions</span></span><br><span class="line"><span class="comment"># or when the master and slaves are many hops away, turning this to &quot;yes&quot; may</span></span><br><span class="line"><span class="comment"># be a good idea.</span></span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置主从复制容量大小。这个 backlog 是一个用来在 slaves 被断开连接时</span></span><br><span class="line"><span class="comment"># 存放 slave 数据的 buffer，所以当一个 slave 想要重新连接，通常不希望全部重新同步，</span></span><br><span class="line"><span class="comment"># 只是部分同步就够了，仅仅传递 slave 在断开连接时丢失的这部分数据。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The biggest the replication backlog, the longer the time the slave can be</span></span><br><span class="line"><span class="comment"># disconnected and later be able to perform a partial resynchronization.</span></span><br><span class="line"><span class="comment"># 这个值越大，salve 可以断开连接的时间就越长。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The backlog is only allocated once there is at least a slave connected.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># repl-backlog-size 1mb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># After a master has no longer connected slaves for some time, the backlog</span></span><br><span class="line"><span class="comment"># will be freed. The following option configures the amount of seconds that</span></span><br><span class="line"><span class="comment"># need to elapse, starting from the time the last slave disconnected, for</span></span><br><span class="line"><span class="comment"># the backlog buffer to be freed.</span></span><br><span class="line"><span class="comment"># 在某些时候，master 不再连接 slaves，backlog 将被释放。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A value of 0 means to never release the backlog.</span></span><br><span class="line"><span class="comment"># 如果设置为 0 ，意味着绝不释放 backlog 。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># repl-backlog-ttl 3600</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当 master 不能正常工作的时候，Redis Sentinel 会从 slaves 中选出一个新的 master，</span></span><br><span class="line"><span class="comment"># 这个值越小，就越会被优先选中，但是如果是 0 ， 那是意味着这个 slave 不可能被选中。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 默认优先级为 100。</span></span><br><span class="line">slave-priority 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># It is possible for a master to stop accepting writes if there are less than</span></span><br><span class="line"><span class="comment"># N slaves connected, having a lag less or equal than M seconds.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The N slaves need to be in &quot;online&quot; state.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The lag in seconds, that must be &lt;= the specified value, is calculated from</span></span><br><span class="line"><span class="comment"># the last ping received from the slave, that is usually sent every second.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This option does not GUARANTEES that N replicas will accept the write, but</span></span><br><span class="line"><span class="comment"># will limit the window of exposure for lost writes in case not enough slaves</span></span><br><span class="line"><span class="comment"># are available, to the specified number of seconds.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For example to require at least 3 slaves with a lag &lt;= 10 seconds use:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># min-slaves-to-write 3</span></span><br><span class="line"><span class="comment"># min-slaves-max-lag 10</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Setting one or the other to 0 disables the feature.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># By default min-slaves-to-write is set to 0 (feature disabled) and</span></span><br><span class="line"><span class="comment"># min-slaves-max-lag is set to 10.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## 安全 ###################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Require clients to issue AUTH &lt;PASSWORD&gt; before processing any other</span></span><br><span class="line"><span class="comment"># commands.  This might be useful in environments in which you do not trust</span></span><br><span class="line"><span class="comment"># others with access to the host running redis-server.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This should stay commented out for backward compatibility and because most</span></span><br><span class="line"><span class="comment"># people do not need auth (e.g. they run their own servers).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Warning: since Redis is pretty fast an outside user can try up to</span></span><br><span class="line"><span class="comment"># 150k passwords per second against a good box. This means that you should</span></span><br><span class="line"><span class="comment"># use a very strong password otherwise it will be very easy to break.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 设置认证密码</span></span><br><span class="line"><span class="comment"># requirepass foobared</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Command renaming.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It is possible to change the name of dangerous commands in a shared</span></span><br><span class="line"><span class="comment"># environment. For instance the CONFIG command may be renamed into something</span></span><br><span class="line"><span class="comment"># hard to guess so that it will still be available for internal-use tools</span></span><br><span class="line"><span class="comment"># but not available for general clients.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It is also possible to completely kill a command by renaming it into</span></span><br><span class="line"><span class="comment"># an empty string:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># rename-command CONFIG &quot;&quot;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please note that changing the name of commands that are logged into the</span></span><br><span class="line"><span class="comment"># AOF file or transmitted to slaves may cause problems.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################### 限制 ####################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the max number of connected clients at the same time. By default</span></span><br><span class="line"><span class="comment"># this limit is set to 10000 clients, however if the Redis server is not</span></span><br><span class="line"><span class="comment"># able to configure the process file limit to allow for the specified limit</span></span><br><span class="line"><span class="comment"># the max number of allowed clients is set to the current file limit</span></span><br><span class="line"><span class="comment"># minus 32 (as Redis reserves a few file descriptors for internal uses).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 一旦达到最大限制，redis 将关闭所有的新连接</span></span><br><span class="line"><span class="comment"># 并发送一个‘max number of clients reached’的错误。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># maxclients 10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果你设置了这个值，当缓存的数据容量达到这个值， redis 将根据你选择的</span></span><br><span class="line"><span class="comment"># eviction 策略来移除一些 keys。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 如果 redis 不能根据策略移除 keys ，或者是策略被设置为 ‘noeviction’，</span></span><br><span class="line"><span class="comment"># redis 将开始响应错误给命令，如 set，lpush 等等，</span></span><br><span class="line"><span class="comment"># 并继续响应只读的命令，如 get</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This option is usually useful when using Redis as an LRU cache, or to set</span></span><br><span class="line"><span class="comment"># a hard memory limit for an instance (using the &#x27;noeviction&#x27; policy).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># WARNING: If you have slaves attached to an instance with maxmemory on,</span></span><br><span class="line"><span class="comment"># the size of the output buffers needed to feed the slaves are subtracted</span></span><br><span class="line"><span class="comment"># from the used memory count, so that network problems / resyncs will</span></span><br><span class="line"><span class="comment"># not trigger a loop where keys are evicted, and in turn the output</span></span><br><span class="line"><span class="comment"># buffer of slaves is full with DELs of keys evicted triggering the deletion</span></span><br><span class="line"><span class="comment"># of more keys, and so forth until the database is completely emptied.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># In short... if you have slaves attached it is suggested that you set a lower</span></span><br><span class="line"><span class="comment"># limit for maxmemory so that there is some free RAM on the system for slave</span></span><br><span class="line"><span class="comment"># output buffers (but this is not needed if the policy is &#x27;noeviction&#x27;).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 最大使用内存</span></span><br><span class="line"><span class="comment"># maxmemory &lt;bytes&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 最大内存策略，你有 5 个选择。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># volatile-lru -&gt; remove the key with an expire set using an LRU algorithm</span></span><br><span class="line"><span class="comment"># volatile-lru -&gt; 使用 LRU 算法移除包含过期设置的 key 。</span></span><br><span class="line"><span class="comment"># allkeys-lru -&gt; remove any key accordingly to the LRU algorithm</span></span><br><span class="line"><span class="comment"># allkeys-lru -&gt; 根据 LRU 算法移除所有的 key 。</span></span><br><span class="line"><span class="comment"># volatile-random -&gt; remove a random key with an expire set</span></span><br><span class="line"><span class="comment"># allkeys-random -&gt; remove a random key, any key</span></span><br><span class="line"><span class="comment"># volatile-ttl -&gt; remove the key with the nearest expire time (minor TTL)</span></span><br><span class="line"><span class="comment"># noeviction -&gt; don&#x27;t expire at all, just return an error on write operations</span></span><br><span class="line"><span class="comment"># noeviction -&gt; 不让任何 key 过期，只是给写入操作返回一个错误</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> with any of the above policies, Redis will return an error on write</span></span><br><span class="line"><span class="comment">#       operations, when there are not suitable keys for eviction.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       At the date of writing this commands are: set setnx setex append</span></span><br><span class="line"><span class="comment">#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd</span></span><br><span class="line"><span class="comment">#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby</span></span><br><span class="line"><span class="comment">#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby</span></span><br><span class="line"><span class="comment">#       getset mset msetnx exec sort</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The default is:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># maxmemory-policy noeviction</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LRU and minimal TTL algorithms are not precise algorithms but approximated</span></span><br><span class="line"><span class="comment"># algorithms (in order to save memory), so you can tune it for speed or</span></span><br><span class="line"><span class="comment"># accuracy. For default Redis will check five keys and pick the one that was</span></span><br><span class="line"><span class="comment"># used less recently, you can change the sample size using the following</span></span><br><span class="line"><span class="comment"># configuration directive.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The default of 5 produces good enough results. 10 Approximates very closely</span></span><br><span class="line"><span class="comment"># true LRU but costs a bit more CPU. 3 is very fast but not very accurate.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># maxmemory-samples 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################## APPEND ONLY MODE ###############################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># By default Redis asynchronously dumps the dataset on disk. This mode is</span></span><br><span class="line"><span class="comment"># good enough in many applications, but an issue with the Redis process or</span></span><br><span class="line"><span class="comment"># a power outage may result into a few minutes of writes lost (depending on</span></span><br><span class="line"><span class="comment"># the configured save points).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The Append Only File is an alternative persistence mode that provides</span></span><br><span class="line"><span class="comment"># much better durability. For instance using the default data fsync policy</span></span><br><span class="line"><span class="comment"># (see later in the config file) Redis can lose just one second of writes in a</span></span><br><span class="line"><span class="comment"># dramatic event like a server power outage, or a single write if something</span></span><br><span class="line"><span class="comment"># wrong with the Redis process itself happens, but the operating system is</span></span><br><span class="line"><span class="comment"># still running correctly.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># AOF and RDB persistence can be enabled at the same time without problems.</span></span><br><span class="line"><span class="comment"># If the AOF is enabled on startup Redis will load the AOF, that is the file</span></span><br><span class="line"><span class="comment"># with the better durability guarantees.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please check http://redis.io/topics/persistence for more information.</span></span><br><span class="line"></span><br><span class="line">appendonly no</span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the append only file (default: &quot;appendonly.aof&quot;)</span></span><br><span class="line"></span><br><span class="line">appendfilename &quot;appendonly.aof&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># The fsync() call tells the Operating System to actually write data on disk</span></span><br><span class="line"><span class="comment"># instead to wait for more data in the output buffer. Some OS will really flush</span></span><br><span class="line"><span class="comment"># data on disk, some other OS will just try to do it ASAP.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Redis supports three different modes:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># no: don&#x27;t fsync, just let the OS flush the data when it wants. Faster.</span></span><br><span class="line"><span class="comment"># always: fsync after every write to the append only log . Slow, Safest.</span></span><br><span class="line"><span class="comment"># everysec: fsync only one time every second. Compromise.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The default is &quot;everysec&quot;, as that&#x27;s usually the right compromise between</span></span><br><span class="line"><span class="comment"># speed and data safety. It&#x27;s up to you to understand if you can relax this to</span></span><br><span class="line"><span class="comment"># &quot;no&quot; that will let the operating system flush the output buffer when</span></span><br><span class="line"><span class="comment"># it wants, for better performances (but if you can live with the idea of</span></span><br><span class="line"><span class="comment"># some data loss consider the default persistence mode that&#x27;s snapshotting),</span></span><br><span class="line"><span class="comment"># or on the contrary, use &quot;always&quot; that&#x27;s very slow but a bit safer than</span></span><br><span class="line"><span class="comment"># everysec.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># More details please check the following article:</span></span><br><span class="line"><span class="comment"># http://antirez.com/post/redis-persistence-demystified.html</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If unsure, use &quot;everysec&quot;.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># appendfsync always</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"><span class="comment"># appendfsync no</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># When the AOF fsync policy is set to always or everysec, and a background</span></span><br><span class="line"><span class="comment"># saving process (a background save or AOF log background rewriting) is</span></span><br><span class="line"><span class="comment"># performing a lot of I/O against the disk, in some Linux configurations</span></span><br><span class="line"><span class="comment"># Redis may block too long on the fsync() call. Note that there is no fix for</span></span><br><span class="line"><span class="comment"># this currently, as even performing fsync in a different thread will block</span></span><br><span class="line"><span class="comment"># our synchronous write(2) call.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># In order to mitigate this problem it&#x27;s possible to use the following option</span></span><br><span class="line"><span class="comment"># that will prevent fsync() from being called in the main process while a</span></span><br><span class="line"><span class="comment"># BGSAVE or BGREWRITEAOF is in progress.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This means that while another child is saving, the durability of Redis is</span></span><br><span class="line"><span class="comment"># the same as &quot;appendfsync none&quot;. In practical terms, this means that it is</span></span><br><span class="line"><span class="comment"># possible to lose up to 30 seconds of log in the worst scenario (with the</span></span><br><span class="line"><span class="comment"># default Linux settings).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If you have latency problems turn this to &quot;yes&quot;. Otherwise leave it as</span></span><br><span class="line"><span class="comment"># &quot;no&quot; that is the safest pick from the point of view of durability.</span></span><br><span class="line"></span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"></span><br><span class="line"><span class="comment"># Automatic rewrite of the append only file.</span></span><br><span class="line"><span class="comment"># Redis is able to automatically rewrite the log file implicitly calling</span></span><br><span class="line"><span class="comment"># BGREWRITEAOF when the AOF log size grows by the specified percentage.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This is how it works: Redis remembers the size of the AOF file after the</span></span><br><span class="line"><span class="comment"># latest rewrite (if no rewrite has happened since the restart, the size of</span></span><br><span class="line"><span class="comment"># the AOF at startup is used).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This base size is compared to the current size. If the current size is</span></span><br><span class="line"><span class="comment"># bigger than the specified percentage, the rewrite is triggered. Also</span></span><br><span class="line"><span class="comment"># you need to specify a minimal size for the AOF file to be rewritten, this</span></span><br><span class="line"><span class="comment"># is useful to avoid rewriting the AOF file even if the percentage increase</span></span><br><span class="line"><span class="comment"># is reached but it is still pretty small.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Specify a percentage of zero in order to disable the automatic AOF</span></span><br><span class="line"><span class="comment"># rewrite feature.</span></span><br><span class="line"></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ LUA SCRIPTING  ###############################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Max execution time of a Lua script in milliseconds.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If the maximum execution time is reached Redis will log that a script is</span></span><br><span class="line"><span class="comment"># still in execution after the maximum allowed time and will start to</span></span><br><span class="line"><span class="comment"># reply to queries with an error.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># When a long running script exceed the maximum execution time only the</span></span><br><span class="line"><span class="comment"># SCRIPT KILL and SHUTDOWN NOSAVE commands are available. The first can be</span></span><br><span class="line"><span class="comment"># used to stop a script that did not yet called write commands. The second</span></span><br><span class="line"><span class="comment"># is the only way to shut down the server in the case a write commands was</span></span><br><span class="line"><span class="comment"># already issue by the script but the user don&#x27;t want to wait for the natural</span></span><br><span class="line"><span class="comment"># termination of the script.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Set it to 0 or a negative value for unlimited execution without warnings.</span></span><br><span class="line">lua-time-limit 5000</span><br><span class="line"></span><br><span class="line"><span class="comment">################################ REDIS 集群  ###############################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 启用或停用集群</span></span><br><span class="line"><span class="comment"># cluster-enabled yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Every cluster node has a cluster configuration file. This file is not</span></span><br><span class="line"><span class="comment"># intended to be edited by hand. It is created and updated by Redis nodes.</span></span><br><span class="line"><span class="comment"># Every Redis Cluster node requires a different cluster configuration file.</span></span><br><span class="line"><span class="comment"># Make sure that instances running in the same system does not have</span></span><br><span class="line"><span class="comment"># overlapping cluster configuration file names.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cluster-config-file nodes-6379.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster node timeout is the amount of milliseconds a node must be unreachable</span></span><br><span class="line"><span class="comment"># for it to be considered in failure state.</span></span><br><span class="line"><span class="comment"># Most other internal time limits are multiple of the node timeout.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cluster-node-timeout 15000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A slave of a failing master will avoid to start a failover if its data</span></span><br><span class="line"><span class="comment"># looks too old.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># There is no simple way for a slave to actually have a exact measure of</span></span><br><span class="line"><span class="comment"># its &quot;data age&quot;, so the following two checks are performed:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 1) If there are multiple slaves able to failover, they exchange messages</span></span><br><span class="line"><span class="comment">#    in order to try to give an advantage to the slave with the best</span></span><br><span class="line"><span class="comment">#    replication offset (more data from the master processed).</span></span><br><span class="line"><span class="comment">#    Slaves will try to get their rank by offset, and apply to the start</span></span><br><span class="line"><span class="comment">#    of the failover a delay proportional to their rank.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2) Every single slave computes the time of the last interaction with</span></span><br><span class="line"><span class="comment">#    its master. This can be the last ping or command received (if the master</span></span><br><span class="line"><span class="comment">#    is still in the &quot;connected&quot; state), or the time that elapsed since the</span></span><br><span class="line"><span class="comment">#    disconnection with the master (if the replication link is currently down).</span></span><br><span class="line"><span class="comment">#    If the last interaction is too old, the slave will not try to failover</span></span><br><span class="line"><span class="comment">#    at all.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The point &quot;2&quot; can be tuned by user. Specifically a slave will not perform</span></span><br><span class="line"><span class="comment"># the failover if, since the last interaction with the master, the time</span></span><br><span class="line"><span class="comment"># elapsed is greater than:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   (node-timeout * slave-validity-factor) + repl-ping-slave-period</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># So for example if node-timeout is 30 seconds, and the slave-validity-factor</span></span><br><span class="line"><span class="comment"># is 10, and assuming a default repl-ping-slave-period of 10 seconds, the</span></span><br><span class="line"><span class="comment"># slave will not try to failover if it was not able to talk with the master</span></span><br><span class="line"><span class="comment"># for longer than 310 seconds.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A large slave-validity-factor may allow slaves with too old data to failover</span></span><br><span class="line"><span class="comment"># a master, while a too small value may prevent the cluster from being able to</span></span><br><span class="line"><span class="comment"># elect a slave at all.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For maximum availability, it is possible to set the slave-validity-factor</span></span><br><span class="line"><span class="comment"># to a value of 0, which means, that slaves will always try to failover the</span></span><br><span class="line"><span class="comment"># master regardless of the last time they interacted with the master.</span></span><br><span class="line"><span class="comment"># (However they&#x27;ll always try to apply a delay proportional to their</span></span><br><span class="line"><span class="comment"># offset rank).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Zero is the only value able to guarantee that when all the partitions heal</span></span><br><span class="line"><span class="comment"># the cluster will always be able to continue.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cluster-slave-validity-factor 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster slaves are able to migrate to orphaned masters, that are masters</span></span><br><span class="line"><span class="comment"># that are left without working slaves. This improves the cluster ability</span></span><br><span class="line"><span class="comment"># to resist to failures as otherwise an orphaned master can&#x27;t be failed over</span></span><br><span class="line"><span class="comment"># in case of failure if it has no working slaves.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Slaves migrate to orphaned masters only if there are still at least a</span></span><br><span class="line"><span class="comment"># given number of other working slaves for their old master. This number</span></span><br><span class="line"><span class="comment"># is the &quot;migration barrier&quot;. A migration barrier of 1 means that a slave</span></span><br><span class="line"><span class="comment"># will migrate only if there is at least 1 other working slave for its master</span></span><br><span class="line"><span class="comment"># and so forth. It usually reflects the number of slaves you want for every</span></span><br><span class="line"><span class="comment"># master in your cluster.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Default is 1 (slaves migrate only if their masters remain with at least</span></span><br><span class="line"><span class="comment"># one slave). To disable migration just set it to a very large value.</span></span><br><span class="line"><span class="comment"># A value of 0 can be set but is useful only for debugging and dangerous</span></span><br><span class="line"><span class="comment"># in production.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cluster-migration-barrier 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In order to setup your cluster make sure to read the documentation</span></span><br><span class="line"><span class="comment"># available at http://redis.io web site.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################## SLOW LOG ###################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The Redis Slow Log is a system to log queries that exceeded a specified</span></span><br><span class="line"><span class="comment"># execution time. The execution time does not include the I/O operations</span></span><br><span class="line"><span class="comment"># like talking with the client, sending the reply and so forth,</span></span><br><span class="line"><span class="comment"># but just the time needed to actually execute the command (this is the only</span></span><br><span class="line"><span class="comment"># stage of command execution where the thread is blocked and can not serve</span></span><br><span class="line"><span class="comment"># other requests in the meantime).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># You can configure the slow log with two parameters: one tells Redis</span></span><br><span class="line"><span class="comment"># what is the execution time, in microseconds, to exceed in order for the</span></span><br><span class="line"><span class="comment"># command to get logged, and the other parameter is the length of the</span></span><br><span class="line"><span class="comment"># slow log. When a new command is logged the oldest one is removed from the</span></span><br><span class="line"><span class="comment"># queue of logged commands.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The following time is expressed in microseconds, so 1000000 is equivalent</span></span><br><span class="line"><span class="comment"># to one second. Note that a negative number disables the slow log, while</span></span><br><span class="line"><span class="comment"># a value of zero forces the logging of every command.</span></span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line"></span><br><span class="line"><span class="comment"># There is no limit to this length. Just be aware that it will consume memory.</span></span><br><span class="line"><span class="comment"># You can reclaim memory used by the slow log with SLOWLOG RESET.</span></span><br><span class="line">slowlog-max-len 128</span><br><span class="line"></span><br><span class="line"><span class="comment">############################# Event notification ##############################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis can notify Pub/Sub clients about events happening in the key space.</span></span><br><span class="line"><span class="comment"># This feature is documented at http://redis.io/topics/keyspace-events</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For instance if keyspace events notification is enabled, and a client</span></span><br><span class="line"><span class="comment"># performs a DEL operation on key &quot;foo&quot; stored in the Database 0, two</span></span><br><span class="line"><span class="comment"># messages will be published via Pub/Sub:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># PUBLISH __keyspace@0__:foo del</span></span><br><span class="line"><span class="comment"># PUBLISH __keyevent@0__:del foo</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It is possible to select the events that Redis will notify among a set</span></span><br><span class="line"><span class="comment"># of classes. Every class is identified by a single character:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  K     Keyspace events, published with __keyspace@&lt;db&gt;__ prefix.</span></span><br><span class="line"><span class="comment">#  E     Keyevent events, published with __keyevent@&lt;db&gt;__ prefix.</span></span><br><span class="line"><span class="comment">#  g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...</span></span><br><span class="line"><span class="comment">#  $     String commands</span></span><br><span class="line"><span class="comment">#  l     List commands</span></span><br><span class="line"><span class="comment">#  s     Set commands</span></span><br><span class="line"><span class="comment">#  h     Hash commands</span></span><br><span class="line"><span class="comment">#  z     Sorted set commands</span></span><br><span class="line"><span class="comment">#  x     Expired events (events generated every time a key expires)</span></span><br><span class="line"><span class="comment">#  e     Evicted events (events generated when a key is evicted for maxmemory)</span></span><br><span class="line"><span class="comment">#  A     Alias for g$lshzxe, so that the &quot;AKE&quot; string means all the events.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  The &quot;notify-keyspace-events&quot; takes as argument a string that is composed</span></span><br><span class="line"><span class="comment">#  by zero or multiple characters. The empty string means that notifications</span></span><br><span class="line"><span class="comment">#  are disabled at all.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  Example: to enable list and generic events, from the point of view of the</span></span><br><span class="line"><span class="comment">#           event name, use:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  notify-keyspace-events Elg</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  Example 2: to get the stream of the expired keys subscribing to channel</span></span><br><span class="line"><span class="comment">#             name __keyevent@0__:expired use:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  notify-keyspace-events Ex</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  By default all notifications are disabled because most users don&#x27;t need</span></span><br><span class="line"><span class="comment">#  this feature and the feature has some overhead. Note that if you don&#x27;t</span></span><br><span class="line"><span class="comment">#  specify at least one of K or E, no events will be delivered.</span></span><br><span class="line">notify-keyspace-events &quot;&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment">############################### ADVANCED CONFIG ###############################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hashes are encoded using a memory efficient data structure when they have a</span></span><br><span class="line"><span class="comment"># small number of entries, and the biggest entry does not exceed a given</span></span><br><span class="line"><span class="comment"># threshold. These thresholds can be configured using the following directives.</span></span><br><span class="line">hash-max-ziplist-entries 512</span><br><span class="line">hash-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># Similarly to hashes, small lists are also encoded in a special way in order</span></span><br><span class="line"><span class="comment"># to save a lot of space. The special representation is only used when</span></span><br><span class="line"><span class="comment"># you are under the following limits:</span></span><br><span class="line">list-max-ziplist-entries 512</span><br><span class="line">list-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sets have a special encoding in just one case: when a set is composed</span></span><br><span class="line"><span class="comment"># of just strings that happens to be integers in radix 10 in the range</span></span><br><span class="line"><span class="comment"># of 64 bit signed integers.</span></span><br><span class="line"><span class="comment"># The following configuration setting sets the limit in the size of the</span></span><br><span class="line"><span class="comment"># set in order to use this special memory saving encoding.</span></span><br><span class="line">set-max-intset-entries 512</span><br><span class="line"></span><br><span class="line"><span class="comment"># Similarly to hashes and lists, sorted sets are also specially encoded in</span></span><br><span class="line"><span class="comment"># order to save a lot of space. This encoding is only used when the length and</span></span><br><span class="line"><span class="comment"># elements of a sorted set are below the following limits:</span></span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># HyperLogLog sparse representation bytes limit. The limit includes the</span></span><br><span class="line"><span class="comment"># 16 bytes header. When an HyperLogLog using the sparse representation crosses</span></span><br><span class="line"><span class="comment"># this limit, it is converted into the dense representation.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A value greater than 16000 is totally useless, since at that point the</span></span><br><span class="line"><span class="comment"># dense representation is more memory efficient.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The suggested value is ~ 3000 in order to have the benefits of</span></span><br><span class="line"><span class="comment"># the space efficient encoding without slowing down too much PFADD,</span></span><br><span class="line"><span class="comment"># which is O(N) with the sparse encoding. The value can be raised to</span></span><br><span class="line"><span class="comment"># ~ 10000 when CPU is not a concern, but space is, and the data set is</span></span><br><span class="line"><span class="comment"># composed of many HyperLogLogs with cardinality in the 0 - 15000 range.</span></span><br><span class="line">hll-sparse-max-bytes 3000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in</span></span><br><span class="line"><span class="comment"># order to help rehashing the main Redis hash table (the one mapping top-level</span></span><br><span class="line"><span class="comment"># keys to values). The hash table implementation Redis uses (see dict.c)</span></span><br><span class="line"><span class="comment"># performs a lazy rehashing: the more operation you run into a hash table</span></span><br><span class="line"><span class="comment"># that is rehashing, the more rehashing &quot;steps&quot; are performed, so if the</span></span><br><span class="line"><span class="comment"># server is idle the rehashing is never complete and some more memory is used</span></span><br><span class="line"><span class="comment"># by the hash table.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The default is to use this millisecond 10 times every second in order to</span></span><br><span class="line"><span class="comment"># active rehashing the main dictionaries, freeing memory when possible.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If unsure:</span></span><br><span class="line"><span class="comment"># use &quot;activerehashing no&quot; if you have hard latency requirements and it is</span></span><br><span class="line"><span class="comment"># not a good thing in your environment that Redis can reply form time to time</span></span><br><span class="line"><span class="comment"># to queries with 2 milliseconds delay.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># use &quot;activerehashing yes&quot; if you don&#x27;t have such hard requirements but</span></span><br><span class="line"><span class="comment"># want to free memory asap when possible.</span></span><br><span class="line">activerehashing yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># The client output buffer limits can be used to force disconnection of clients</span></span><br><span class="line"><span class="comment"># that are not reading data from the server fast enough for some reason (a</span></span><br><span class="line"><span class="comment"># common reason is that a Pub/Sub client can&#x27;t consume messages as fast as the</span></span><br><span class="line"><span class="comment"># publisher can produce them).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The limit can be set differently for the three different classes of clients:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># normal -&gt; normal clients</span></span><br><span class="line"><span class="comment"># slave  -&gt; slave clients and MONITOR clients</span></span><br><span class="line"><span class="comment"># pubsub -&gt; clients subscribed to at least one pubsub channel or pattern</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The syntax of every client-output-buffer-limit directive is the following:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># client-output-buffer-limit &lt;class&gt; &lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A client is immediately disconnected once the hard limit is reached, or if</span></span><br><span class="line"><span class="comment"># the soft limit is reached and remains reached for the specified number of</span></span><br><span class="line"><span class="comment"># seconds (continuously).</span></span><br><span class="line"><span class="comment"># So for instance if the hard limit is 32 megabytes and the soft limit is</span></span><br><span class="line"><span class="comment"># 16 megabytes / 10 seconds, the client will get disconnected immediately</span></span><br><span class="line"><span class="comment"># if the size of the output buffers reach 32 megabytes, but will also get</span></span><br><span class="line"><span class="comment"># disconnected if the client reaches 16 megabytes and continuously overcomes</span></span><br><span class="line"><span class="comment"># the limit for 10 seconds.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># By default normal clients are not limited because they don&#x27;t receive data</span></span><br><span class="line"><span class="comment"># without asking (in a push way), but just after a request, so only</span></span><br><span class="line"><span class="comment"># asynchronous clients may create a scenario where data is requested faster</span></span><br><span class="line"><span class="comment"># than it can read.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Instead there is a default limit for pubsub and slave clients, since</span></span><br><span class="line"><span class="comment"># subscribers and slaves receive data in a push fashion.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Both the hard or the soft limit can be disabled by setting them to zero.</span></span><br><span class="line">client-output-buffer-limit normal 0 0 0</span><br><span class="line">client-output-buffer-limit slave 256mb 64mb 60</span><br><span class="line">client-output-buffer-limit pubsub 32mb 8mb 60</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis calls an internal function to perform many background tasks, like</span></span><br><span class="line"><span class="comment"># closing connections of clients in timeout, purging expired keys that are</span></span><br><span class="line"><span class="comment"># never requested, and so forth.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Not all tasks are performed with the same frequency, but Redis checks for</span></span><br><span class="line"><span class="comment"># tasks to perform accordingly to the specified &quot;hz&quot; value.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># By default &quot;hz&quot; is set to 10. Raising the value will use more CPU when</span></span><br><span class="line"><span class="comment"># Redis is idle, but at the same time will make Redis more responsive when</span></span><br><span class="line"><span class="comment"># there are many keys expiring at the same time, and timeouts may be</span></span><br><span class="line"><span class="comment"># handled with more precision.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The range is between 1 and 500, however a value over 100 is usually not</span></span><br><span class="line"><span class="comment"># a good idea. Most users should use the default of 10 and raise this up to</span></span><br><span class="line"><span class="comment"># 100 only in environments where very low latency is required.</span></span><br><span class="line">hz 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># When a child rewrites the AOF file, if the following option is enabled</span></span><br><span class="line"><span class="comment"># the file will be fsync-ed every 32 MB of data generated. This is useful</span></span><br><span class="line"><span class="comment"># in order to commit the file to the disk more incrementally and avoid</span></span><br><span class="line"><span class="comment"># big latency spikes.</span></span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>抽象工厂模式(Abstract Factory Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-abstract-factory-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-abstract-factory-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>抽象工厂模式(Abstract Factory Pattern)：提供一个创建一系列相关或相互依赖对象的接口，而无须指定它们具体的类。抽象工厂模式又称为Kit模式，属于对象创建型模式。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><p>抽象工厂模式包含如下角色：</p><ul><li>AbstractFactory：抽象工厂</li><li>ConcreteFactory：具体工厂</li><li>AbstractProduct：抽象产品</li><li>Product：具体产品</li></ul><p><img src="/assets/img/pattern/class_AbatractFactory.jpg" alt="class_AbatractFactory"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/assets/img/pattern/seq_AbatractFactory.jpg" alt="seq_AbatractFactory"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 抽象产品 A</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Television</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体产品 A1</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HaierTelevision</span> <span class="keyword">extends</span> <span class="title">Television</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;This is Haier TV show&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体产品 A2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaomiTelevision</span> <span class="keyword">extends</span> <span class="title">Television</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;This is xiaomi TV show&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 抽象产品 B</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Refrigerator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">freeze</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体产品 B1</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HaierRefrigerator</span> <span class="keyword">extends</span> <span class="title">Refrigerator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">freeze</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Freezed by Haier&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体产品 B2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaomiRefrigerator</span> <span class="keyword">extends</span> <span class="title">Refrigerator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">freeze</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Freezed by xiaomi&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 抽象工厂</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Television <span class="title">getTelevision</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Refrigerator <span class="title">getRefrigerator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体工厂 1</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HaierFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Television <span class="title">getTelevision</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HaierTelevision();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Refrigerator <span class="title">getRefrigerator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HaierRefrigerator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体工厂 2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaomiFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Television <span class="title">getTelevision</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> XiaomiTelevision();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Refrigerator <span class="title">getRefrigerator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> XiaomiRefrigerator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 海尔系列家电</span></span><br><span class="line">        Factory haier = <span class="keyword">new</span> HaierFactory();</span><br><span class="line">        Television haierTelevision = haier.getTelevision();</span><br><span class="line">        Refrigerator haierRefrigerator = haier.getRefrigerator();</span><br><span class="line">        haierTelevision.play(); <span class="comment">// This is Haier TV show</span></span><br><span class="line">        haierRefrigerator.freeze(); <span class="comment">// Freezed by Haier</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 小米系列家电</span></span><br><span class="line">        Factory xiaomi = <span class="keyword">new</span> XiaomiFactory();</span><br><span class="line">        Television xiaomiTelevision = xiaomi.getTelevision();</span><br><span class="line">        Refrigerator xiaomiRefrigerator = xiaomi.getRefrigerator();</span><br><span class="line">        xiaomiTelevision.play(); <span class="comment">// This is xiaomi TV show</span></span><br><span class="line">        xiaomiRefrigerator.freeze(); <span class="comment">// Freezed by xiaomi</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>抽象工厂模式隔离了具体类的生成，使得客户并不需要知道什么被创建。由于这种隔离，更换一个具体工厂就变得相对容易。所有的具体工厂都实现了抽象工厂中定义的那些公共接口，因此只需改变具体工厂的实例，就可以在某种程度上改变整个软件系统的行为。另外，应用抽象工厂模式可以实现高内聚低耦合的设计目的，因此抽象工厂模式得到了广泛的应用。</li><li>当一个产品族中的多个对象被设计成一起工作时，它能够保证客户端始终只使用同一个产品族中的对象。这对一些需要根据当前环境来决定其行为的软件系统来说，是一种非常实用的设计模式。</li><li>增加新的具体工厂和产品族很方便，无须修改已有系统，符合“开闭原则”。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul><li>在添加新的产品对象时，难以扩展抽象工厂来生产新种类的产品，这是因为在抽象工厂角色中规定了所有可能被创建的产品集合，要支持新种类的产品就意味着要对该接口进行扩展，而这将涉及到对抽象工厂角色及其所有子类的修改，显然会带来较大的不便。</li><li>开闭原则的倾斜性（增加新的工厂和产品族容易，增加新的产品等级结构麻烦）。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>一个系统不应当依赖于产品类实例如何被创建、组合和表达的细节，这对于所有类型的工厂模式都是重要的。</li><li>系统中有多于一个的产品族，而每次只使用其中某一产品族。</li><li>属于同一个产品族的产品将在一起使用，这一约束必须在系统的设计中体现出来。</li><li>系统提供一个产品类的库，所有的产品以同样的接口出现，从而使客户端不依赖于具体实现。</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><p>在很多软件系统中需要更换界面主题，要求界面中的按钮、文本框、背景色等一起发生改变时，可以使用抽象工厂模式进行设计。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>抽象工厂模式提供一个创建一系列相关或相互依赖对象的接口，而无须指定它们具体的类。抽象工厂模式又称为Kit模式，属于对象创建型模式。</li><li>抽象工厂模式包含四个角色：抽象工厂用于声明生成抽象产品的方法；具体工厂实现了抽象工厂声明的生成抽象产品的方法，生成一组具体产品，这些产品构成了一个产品族，每一个产品都位于某个产品等级结构中；抽象产品为每种产品声明接口，在抽象产品中定义了产品的抽象业务方法；具体产品定义具体工厂生产的具体产品对象，实现抽象产品接口中定义的业务方法。</li><li>抽象工厂模式是所有形式的工厂模式中最为抽象和最具一般性的一种形态。抽象工厂模式与工厂方法模式最大的区别在于，工厂方法模式针对的是一个产品等级结构，而抽象工厂模式则需要面对多个产品等级结构。</li><li>抽象工厂模式的主要优点是隔离了具体类的生成，使得客户并不需要知道什么被创建，而且每次可以通过具体工厂类创建一个产品族中的多个对象，增加或者替换产品族比较方便，增加新的具体工厂和产品族很方便；主要缺点在于增加新的产品等级结构很复杂，需要修改抽象工厂和所有的具体工厂类，对“开闭原则”的支持呈现倾斜性。</li><li>抽象工厂模式适用情况包括：一个系统不应当依赖于产品类实例如何被创建、组合和表达的细节；系统中有多于一个的产品族，而每次只使用其中某一产品族；属于同一个产品族的产品将在一起使用；系统提供一个产品类的库，所有的产品以同样的接口出现，从而使客户端不依赖于具体实现。</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>适配器模式(Adapter Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-adapter-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-adapter-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>适配器模式(Adapter Pattern)将一个接口转换成客户希望的另一个接口，适配器模式使接口不兼容的那些类可以一起工作，其别名为包装器(Wrapper)。适配器模式既可以作为类结构型模式，也可以作为对象结构型模式。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><p>适配器模式包含如下角色：</p><ul><li>Target：目标抽象类</li><li>Adapter：适配器类</li><li>Adaptee：适配者类</li><li>Client：客户类</li></ul><p>对象适配器</p><p><img src="/assets/img/pattern/class_Adapter.jpg" alt="class_Adapter"></p><p>类适配器</p><p><img src="/assets/img/pattern/class_Adapter_classModel.jpg" alt="class_Adapter_classModel"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/assets/img/pattern/seq_Adapter.jpg" alt="seq_Adapter"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 源码来自 http://www.runoob.com/design-pattern/adapter-pattern.html</span></span><br><span class="line"><span class="comment">// 需要深入学习思考</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MediaPlayer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">play</span><span class="params">(String audioType, String fileName)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AdvancedMediaPlayer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">playVlc</span><span class="params">(String fileName)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">playMp4</span><span class="params">(String fileName)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mp4Player</span> <span class="keyword">implements</span> <span class="title">AdvancedMediaPlayer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playVlc</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Can do nothing.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playMp4</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Playing mp4 file. Name: &quot;</span>+fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VlcPlayer</span> <span class="keyword">implements</span> <span class="title">AdvancedMediaPlayer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playVlc</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Playing vlc file. Name: &quot;</span>+fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">playMp4</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Can do nothing.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MediaAdapter</span> <span class="keyword">implements</span> <span class="title">MediaPlayer</span> </span>&#123;</span><br><span class="line">    AdvancedMediaPlayer advancedMediaPlayer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MediaAdapter</span><span class="params">(String audioType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (audioType.equalsIgnoreCase(<span class="string">&quot;vlc&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">this</span>.advancedMediaPlayer = <span class="keyword">new</span> VlcPlayer();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(audioType.equalsIgnoreCase(<span class="string">&quot;mp4&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">this</span>.advancedMediaPlayer = <span class="keyword">new</span> Mp4Player();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(String audioType, String fileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(audioType.equalsIgnoreCase(<span class="string">&quot;vlc&quot;</span>))&#123;</span><br><span class="line">            advancedMediaPlayer.playVlc(fileName);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(audioType.equalsIgnoreCase(<span class="string">&quot;mp4&quot;</span>))&#123;</span><br><span class="line">            advancedMediaPlayer.playMp4(fileName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AudioPlayer</span> <span class="keyword">implements</span> <span class="title">MediaPlayer</span> </span>&#123;</span><br><span class="line">    MediaAdapter mediaAdapter;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(String audioType, String fileName)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//播放 mp3 音乐文件的内置支持</span></span><br><span class="line">        <span class="keyword">if</span>(audioType.equalsIgnoreCase(<span class="string">&quot;mp3&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Playing mp3 file. Name: &quot;</span>+ fileName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//mediaAdapter 提供了播放其他文件格式的支持</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(audioType.equalsIgnoreCase(<span class="string">&quot;vlc&quot;</span>)</span><br><span class="line">                || audioType.equalsIgnoreCase(<span class="string">&quot;mp4&quot;</span>))&#123;</span><br><span class="line">            mediaAdapter = <span class="keyword">new</span> MediaAdapter(audioType);</span><br><span class="line">            mediaAdapter.play(audioType, fileName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Invalid media. &quot;</span>+</span><br><span class="line">                    audioType + <span class="string">&quot; format not supported&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdapterPatternDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AudioPlayer audioPlayer = <span class="keyword">new</span> AudioPlayer();</span><br><span class="line"></span><br><span class="line">        audioPlayer.play(<span class="string">&quot;mp3&quot;</span>, <span class="string">&quot;beyond the horizon.mp3&quot;</span>);</span><br><span class="line">        audioPlayer.play(<span class="string">&quot;mp4&quot;</span>, <span class="string">&quot;alone.mp4&quot;</span>);</span><br><span class="line">        audioPlayer.play(<span class="string">&quot;vlc&quot;</span>, <span class="string">&quot;far far away.vlc&quot;</span>);</span><br><span class="line">        audioPlayer.play(<span class="string">&quot;avi&quot;</span>, <span class="string">&quot;mind me.avi&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 源码来自 http://www.runoob.com/design-pattern/adapter-pattern.html</span></span><br><span class="line"><span class="comment">// 需要深入学习思考</span></span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>将目标类和适配者类解耦，通过引入一个适配器类来重用现有的适配者类，而无须修改原有代码。</li><li>增加了类的透明性和复用性，将具体的实现封装在适配者类中，对于客户端类来说是透明的，而且提高了适配者的复用性。</li><li>灵活性和扩展性都非常好，通过使用配置文件，可以很方便地更换适配器，也可以在不修改原有代码的基础上增加新的适配器类，完全符合“开闭原则”。</li></ul><p>类适配器模式还具有如下优点：</p><ul><li>由于适配器类是适配者类的子类，因此可以在适配器类中置换一些适配者的方法，使得适配器的灵活性更强。</li></ul><p>对象适配器模式还具有如下优点：</p><ul><li>一个对象适配器可以把多个不同的适配者适配到同一个目标，也就是说，同一个适配器可以把适配者类和它的子类都适配到目标接口。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>类适配器模式的缺点如下：</p><ul><li>对于Java、C#等不支持多重继承的语言，一次最多只能适配一个适配者类，而且目标抽象类只能为抽象类，不能为具体类，其使用有一定的局限性，不能将一个适配者类和它的子类都适配到目标接口。</li></ul><p>对象适配器模式的缺点如下：</p><ul><li>与类适配器模式相比，要想置换适配者类的方法就不容易。如果一定要置换掉适配者类的一个或多个方法，就只好先做一个适配者类的子类，将适配者类的方法置换掉，然后再把适配者类的子类当做真正的适配者进行适配，实现过程较为复杂。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>系统需要使用现有的类，而这些类的接口不符合系统的需要。</li><li>想要建立一个可以重复使用的类，用于与一些彼此之间没有太大关联的一些类，包括一些可能在将来引进的类一起工作。</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><p>Sun公司在1996年公开了Java语言的数据库连接工具JDBC，JDBC使得Java语言程序能够与数据库连接，并使用SQL语言来查询和操作数据。JDBC给出一个客户端通用的抽象接口，每一个具体数据库引擎（如SQL Server、Oracle、MySQL等）的JDBC驱动软件都是一个介于JDBC接口和数据库引擎接口之间的适配器软件。抽象的JDBC接口和各个数据库引擎API之间都需要相应的适配器软件，这就是为各个不同数据库引擎准备的驱动程序。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>结构型模式描述如何将类或者对象结合在一起形成更大的结构。</li><li>适配器模式用于将一个接口转换成客户希望的另一个接口，适配器模式使接口不兼容的那些类可以一起工作，其别名为包装器。适配器模式既可以作为类结构型模式，也可以作为对象结构型模式。</li><li>适配器模式包含四个角色：目标抽象类定义客户要用的特定领域的接口；适配器类可以调用另一个接口，作为一个转换器，对适配者和抽象目标类进行适配，它是适配器模式的核心；适配者类是被适配的角色，它定义了一个已经存在的接口，这个接口需要适配；在客户类中针对目标抽象类进行编程，调用在目标抽象类中定义的业务方法。</li><li>在类适配器模式中，适配器类实现了目标抽象类接口并继承了适配者类，并在目标抽象类的实现方法中调用所继承的适配者类的方法；在对象适配器模式中，适配器类继承了目标抽象类并定义了一个适配者类的对象实例，在所继承的目标抽象类方法中调用适配者类的相应业务方法。</li><li>适配器模式的主要优点是将目标类和适配者类解耦，增加了类的透明性和复用性，同时系统的灵活性和扩展性都非常好，更换适配器或者增加新的适配器都非常方便，符合“开闭原则”；类适配器模式的缺点是适配器类在很多编程语言中不能同时适配多个适配者类，对象适配器模式的缺点是很难置换适配者类的方法。</li><li>适配器模式适用情况包括：系统需要使用现有的类，而这些类的接口不符合系统的需要；想要建立一个可以重复使用的类，用于与一些彼此之间没有太大关联的一些类一起工作。</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>桥接模式(Bridge Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-bridge-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-bridge-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>桥接模式(Bridge Pattern)将抽象部分与它的实现部分分离，使它们都可以独立地变化。它是一种对象结构型模式，又称为柄体(Handle and Body)模式或接口(Interface)模式。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><ul><li>Abstraction：抽象类</li><li>RefinedAbstraction：扩充抽象类</li><li>Implementor：实现类接口</li><li>ConcreteImplementor：具体实现类</li></ul><p><img src="/../../../images/pattern/class_Bridge.jpg" alt="class_Bridge"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/../../../images/pattern/seq_Bridge.jpg" alt="seq_Bridge"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><ul><li>抽象化：抽象化就是忽略一些信息，把不同的实体当作同样的实体对待。在面向对象中，将对象的共同性质抽取出来形成类的过程即为抽象化的过程。</li><li>实现化：针对抽象化给出的具体实现，就是实现化，抽象化与实现化是一对互逆的概念，实现化产生的对象比抽象化更具体，是对抽象化事物的进一步具体化的产物。</li><li>脱耦：脱耦就是将抽象化和实现化之间的耦合解脱开，或者说是将它们之间的强关联改换成弱关联，将两个角色之间的继承关系改为关联关系。桥接模式中的所谓脱耦，就是指在一个软件系统的抽象化和实现化之间使用关联关系（组合或者聚合关系）而不是继承关系，从而使两者可以相对独立地变化，这就是桥接模式的用意。</li></ul><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>分离抽象接口及其实现部分。</li><li>桥接模式有时类似于多继承方案，但是多继承方案违背了类的单一职责原则（即一个类只有一个变化的原因），复用性比较差，而且多继承结构中类的个数非常庞大，桥接模式是比多继承方案更好的解决方法。</li><li>桥接模式提高了系统的可扩充性，在两个变化维度中任意扩展一个维度，都不需要修改原有系统。</li><li>实现细节对客户透明，可以对用户隐藏实现细节。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul><li>桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。</li><li>桥接模式要求正确识别出系统中两个独立变化的维度，因此其使用范围具有一定的局限性。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。</li><li>抽象化角色和实现化角色可以以继承的方式独立扩展而互不影响，在程序运行时可以动态将一个抽象化子类的对象和一个实现化子类的对象进行组合，即系统需要对抽象化角色和实现化角色进行动态耦合。</li><li>一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。</li><li>虽然在系统中使用继承是没有问题的，但是由于抽象化角色和具体化角色需要独立变化，设计要求需要独立管理这两者。</li><li>对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><p>一个Java桌面软件总是带有所在操作系统的视感(LookAndFeel)，如果一个Java软件是在Unix系统上开发的，那么开发人员看到的是Motif用户界面的视感；在Windows上面使用这个系统的用户看到的是Windows用户界面的视感；而一个在Macintosh上面使用的用户看到的则是Macintosh用户界面的视感，Java语言是通过所谓的Peer架构做到这一点的。Java为AWT中的每一个GUI构件都提供了一个Peer构件，在AWT中的Peer架构就使用了桥接模式</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>桥接模式将抽象部分与它的实现部分分离，使它们都可以独立地变化。它是一种对象结构型模式，又称为柄体(Handle and Body)模式或接口(Interface)模式。</li><li>桥接模式包含如下四个角色：抽象类中定义了一个实现类接口类型的对象并可以维护该对象；扩充抽象类扩充由抽象类定义的接口，它实现了在抽象类中定义的抽象业务方法，在扩充抽象类中可以调用在实现类接口中定义的业务方法；实现类接口定义了实现类的接口，实现类接口仅提供基本操作，而抽象类定义的接口可能会做更多更复杂的操作；具体实现类实现了实现类接口并且具体实现它，在不同的具体实现类中提供基本操作的不同实现，在程序运行时，具体实现类对象将替换其父类对象，提供给客户端具体的业务操作方法。</li><li>在桥接模式中，抽象化(Abstraction)与实现化(Implementation)脱耦，它们可以沿着各自的维度独立变化。</li><li>桥接模式的主要优点是分离抽象接口及其实现部分，是比多继承方案更好的解决方法，桥接模式还提高了系统的可扩充性，在两个变化维度中任意扩展一个维度，都不需要修改原有系统，实现细节对客户透明，可以对用户隐藏实现细节；其主要缺点是增加系统的理解与设计难度，且识别出系统中两个独立变化的维度并不是一件容易的事情。</li><li>桥接模式适用情况包括：需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系；抽象化角色和实现化角色可以以继承的方式独立扩展而互不影响；一个类存在两个独立变化的维度，且这两个维度都需要进行扩展；设计要求需要独立管理抽象化角色和具体化角色；不希望使用继承或因为多层次继承导致系统类的</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>建造者模式(Builder Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-builder-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-builder-pattern/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>不甚理解</strong></p></blockquote><h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>造者模式(Builder Pattern)：将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</p><p>建造者模式是一步一步创建一个复杂的对象，它允许用户只通过指定复杂对象的类型和内容就可以构建它们，用户不需要知道内部的具体构建细节。建造者模式属于对象创建型模式。根据中文翻译的不同，建造者模式又可以称为生成器模式。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><ul><li>Builder：抽象建造者</li><li>ConcreteBuilder：具体建造者</li><li>Director：指挥者</li><li>Product：产品角色</li></ul><p><img src="/assets/img/pattern/class_Builder.jpg" alt="class_Builder"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/assets/img/pattern/seq_Builder.jpg" alt="seq_Builder"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 建造者角色：</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildPart1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildPart2</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildPart3</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监工角色：</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> </span>&#123;    <span class="comment">// 将一个复杂的构建过程与其表示相分离</span></span><br><span class="line">    <span class="keyword">private</span> Builder builder;    <span class="comment">// 针对接口编程，而不是针对实现编程</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.builder = builder;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBuilder</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.builder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">construct</span><span class="params">()</span> </span>&#123;   <span class="comment">// 控制（定义）一个复杂的构建过程</span></span><br><span class="line">        builder.buildPart1();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;   <span class="comment">// 提示：如果想在运行过程中替换构建算法，可以考虑结合策略模式。</span></span><br><span class="line">            builder.buildPart2();</span><br><span class="line">        &#125;</span><br><span class="line">        builder.buildPart3();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体的建造者角色：</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此处实现了建造纯文本文档的具体建造者。</span></span><br><span class="line"><span class="comment"> * 可以考虑再实现一个建造HTML文档、XML文档，或者其它什么文档的具体建造者。</span></span><br><span class="line"><span class="comment"> * 这样，就可以使得同样的构建过程可以创建不同的表示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteBuilder1</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> StringBuffer buffer = <span class="keyword">new</span> StringBuffer();<span class="comment">//假设 buffer.toString() 就是最终生成的产品</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildPart1</span><span class="params">()</span> </span>&#123;<span class="comment">//实现构建最终实例需要的所有方法</span></span><br><span class="line">        buffer.append(<span class="string">&quot;Builder1 : Part1\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildPart2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        buffer.append(<span class="string">&quot;Builder1 : Part2\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildPart3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        buffer.append(<span class="string">&quot;Builder1 : Part3\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getResult</span><span class="params">()</span> </span>&#123;<span class="comment">//定义获取最终生成实例的方法</span></span><br><span class="line">        <span class="keyword">return</span> buffer.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 客户角色：</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testBuilderPattern</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ConcreteBuilder1 b1 = <span class="keyword">new</span> ConcreteBuilder1();<span class="comment">//建造者</span></span><br><span class="line">        Director director = <span class="keyword">new</span> Director(b1);<span class="comment">//监工</span></span><br><span class="line">        director.construct();<span class="comment">//建造实例(监工负责监督，建造者实际建造)</span></span><br><span class="line">        String result = b1.getResult();<span class="comment">//获取最终生成结果</span></span><br><span class="line">        System.out.printf(<span class="string">&quot;the result is :%n%s&quot;</span>, result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>实例：KFC套餐</p><p>建造者模式可以用于描述KFC如何创建套餐：套餐是一个复杂对象，它一般包含主食（如汉堡、鸡肉卷等）和饮料（如果汁、 可乐等）等组成部分，不同的套餐有不同的组成部分，而KFC的服务员可以根据顾客的要求，一步一步装配这些组成部分，构造一份完整的套餐，然后返回给顾客。</p><p><img src="/assets/img/pattern/KFCBuilder.jpg" alt="KFCBuilder"></p><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><p>抽象建造者类中定义了产品的创建方法和返回方法;</p><p>建造者模式的结构中还引入了一个指挥者类Director，该类的作用主要有两个：一方面它隔离了客户与生产过程；另一方面它负责控制产品的生成过程。指挥者针对抽象建造者编程，客户端只需要知道具体建造者的类型，即可通过指挥者类调用建造者的相关方法，返回一个完整的产品对象</p><p>在客户端代码中，无须关心产品对象的具体组装过程，只需确定具体建造者的类型即可，建造者模式将复杂对象的构建与对象的表现分离开来，这样使得同样的构建过程可以创建出不同的表现。</p><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>在建造者模式中， 客户端不必知道产品内部组成的细节，将产品本身与产品的创建过程解耦，使得相同的创建过程可以创建不同的产品对象。</li><li>每一个具体建造者都相对独立，而与其他的具体建造者无关，因此可以很方便地替换具体建造者或增加新的具体建造者， 用户使用不同的具体建造者即可得到不同的产品对象 。</li><li>可以更加精细地控制产品的创建过程 。将复杂产品的创建步骤分解在不同的方法中，使得创建过程更加清晰，也更方便使用程序来控制创建过程。</li><li>增加新的具体建造者无须修改原有类库的代码，指挥者类针对抽象建造者类编程，系统扩展方便，符合“开闭原则”。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul><li>建造者模式所创建的产品一般具有较多的共同点，其组成部分相似，如果产品之间的差异性很大，则不适合使用建造者模式，因此其使用范围受到一定的限制。</li><li>如果产品的内部变化复杂，可能会导致需要定义很多具体建造者类来实现这种变化，导致系统变得很庞大。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>需要生成的产品对象有复杂的内部结构，这些产品对象通常包含多个成员属性。</li><li>需要生成的产品对象的属性相互依赖，需要指定其生成顺序。</li><li>对象的创建过程独立于创建该对象的类。在建造者模式中引入了指挥者类，将创建过程封装在指挥者类中，而不在建造者类中。</li><li>隔离复杂对象的创建和使用，并使得相同的创建过程可以创建不同的产品。</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><ul><li>在很多游戏软件中，地图包括天空、地面、背景等组成部分，人物角色包括人体、服装、装备等组成部分，可以使用建造者模式对其进行设计，通过不同的具体建造者创建不同类型的地图或人物。</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>建造者模式将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。建造者模式是一步一步创建一个复杂的对象，它允许用户只通过指定复杂对象的类型和内容就可以构建它们，用户不需要知道内部的具体构建细节。建造者模式属于对象创建型模式。</li><li>建造者模式包含如下四个角色：抽象建造者为创建一个产品对象的各个部件指定抽象接口；具体建造者实现了抽象建造者接口，实现各个部件的构造和装配方法，定义并明确它所创建的复杂对象，也可以提供一个方法返回创建好的复杂产品对象；产品角色是被构建的复杂对象，包含多个组成部件；指挥者负责安排复杂对象的建造次序，指挥者与抽象建造者之间存在关联关系，可以在其construct()建造方法中调用建造者对象的部件构造与装配方法，完成复杂对象的建造</li><li>在建造者模式的结构中引入了一个指挥者类，该类的作用主要有两个：一方面它隔离了客户与生产过程；另一方面它负责控制产品的生成过程。指挥者针对抽象建造者编程，客户端只需要知道具体建造者的类型，即可通过指挥者类调用建造者的相关方法，返回一个完整的产品对象。</li><li>建造者模式的主要优点在于客户端不必知道产品内部组成的细节，将产品本身与产品的创建过程解耦，使得相同的创建过程可以创建不同的产品对象，每一个具体建造者都相对独立，而与其他的具体建造者无关，因此可以很方便地替换具体建造者或增加新的具体建造者，符合“开闭原则”，还可以更加精细地控制产品的创建过程；其主要缺点在于由于建造者模式所创建的产品一般具有较多的共同点，其组成部分相似，因此其使用范围受到一定的限制，如果产品的内部变化复杂，可能会导致需要定义很多具体建造者类来实现这种变化，导致系统变得很庞大。</li><li>建造者模式适用情况包括：需要生成的产品对象有复杂的内部结构，这些产品对象通常包含多个成员属性；需要生成的产品对象的属性相互依赖，需要指定其生成顺序；对象的创建过程独立于创建该对象的类；隔离复杂对象的创建和使用，并使得相同的创建过程可以创建不同类型的产品。</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>装饰模式(Decorator Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-decorator-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-decorator-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>装饰模式(Decorator Pattern)动态地给一个对象增加一些额外的职责(Responsibility)，就增加对象功能来说，装饰模式比生成子类实现更为灵活。其别名也可以称为包装器(Wrapper)，与适配器模式的别名相同，但它们适用于不同的场合。根据翻译的不同，装饰模式也有人称之为“油漆工模式”，它是一种对象结构型模式。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><ul><li>Component: 抽象构件</li><li>ConcreteComponent: 具体构件</li><li>Decorator: 抽象装饰类</li><li>ConcreteDecorator: 具体装饰类</li></ul><p><img src="/../../../images/pattern/class_Decorator.jpg" alt="class_Bridge"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/../../../images/pattern/seq_Decorator.jpg" alt="seq_Bridge"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> draft </tag>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工厂方法模式(Factory Method Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-factory-method-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-factory-method-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>工厂方法模式(Factory Method Pattern)又称为工厂模式，也叫虚拟构造器(Virtual Constructor)模式或者多态工厂(Polymorphic Factory)模式，它属于类创建型模式。在工厂方法模式中，工厂父类负责定义创建产品对象的公共接口，而工厂子类则负责生成具体的产品对象，这样做的目的是将产品类的实例化操作延迟到工厂子类中完成，即通过工厂子类来确定究竟应该实例化哪一个具体产品类。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><p>工厂方法模式包含如下角色：</p><ul><li>Product：抽象产品</li><li>ConcreteProduct：具体产品</li><li>Factory：抽象工厂</li><li>ConcreteFactory：具体工厂</li></ul><p><img src="/assets/img/pattern/class_FactoryMethod.jpg" alt="class_FactoryMethod"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/assets/img/pattern/seq_FactoryMethod.jpg" alt="seq_FactoryMethod"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//抽象产品角色</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体产品角色A</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductA</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;You are using ProductA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体产品角色B</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductB</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;You are using ProductB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//抽象工厂</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">factoryMethod</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体工厂A</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FactoryA</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">factoryMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductA();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体工厂B</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FactoryB</span> <span class="keyword">extends</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">factoryMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductB();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Factory factoryA = <span class="keyword">new</span> FactoryA();</span><br><span class="line">        Product productA = factoryA.factoryMethod();</span><br><span class="line">        productA.use(); <span class="comment">// You are using ProductA</span></span><br><span class="line"></span><br><span class="line">        Factory factoryB = <span class="keyword">new</span> FactoryB();</span><br><span class="line">        Product productB = factoryB.factoryMethod();</span><br><span class="line">        productB.use(); <span class="comment">// You are using ProductB</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><p>工厂方法模式是简单工厂模式的进一步抽象和推广。由于使用了面向对象的多态性，工厂方法模式保持了简单工厂模式的优点，而且克服了它的缺点。在工厂方法模式中，核心的工厂类不再负责所有产品的创建，而是将具体创建工作交给子类去做。这个核心类仅仅负责给出具体工厂必须实现的接口，而不负责哪一个产品类被实例化这种细节，这使得工厂方法模式可以允许系统在不修改工厂角色的情况下引进新产品。</p><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>在工厂方法模式中，工厂方法用来创建客户所需要的产品，同时还向客户隐藏了哪种具体产品类将被实例化这一细节，用户只需要关心所需产品对应的工厂，无须关心创建细节，甚至无须知道具体产品类的类名。</li><li>基于工厂角色和产品角色的多态性设计是工厂方法模式的关键。它能够使工厂可以自主确定创建何种产品对象，而如何创建这个对象的细节则完全封装在具体工厂内部。工厂方法模式之所以又被称为多态工厂模式，是因为所有的具体工厂类都具有同一抽象父类。</li><li>使用工厂方法模式的另一个优点是在系统中加入新产品时，无须修改抽象工厂和抽象产品提供的接口，无须修改客户端，也无须修改其他的具体工厂和具体产品，而只要添加一个具体工厂和具体产品就可以了。这样，系统的可扩展性也就变得非常好，完全符合“开闭原则”。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul><li>在添加新产品时，需要编写新的具体产品类，而且还要提供与之对应的具体工厂类，系统中类的个数将成对增加，在一定程度上增加了系统的复杂度，有更多的类需要编译和运行，会给系统带来一些额外的开销。</li><li>由于考虑到系统的可扩展性，需要引入抽象层，在客户端代码中均使用抽象层进行定义，增加了系统的抽象性和理解难度，且在实现时可能需要用到DOM、反射等技术，增加了系统的实现难度。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>一个类不知道它所需要的对象的类：在工厂方法模式中，客户端不需要知道具体产品类的类名，只需要知道所对应的工厂即可，具体的产品对象由具体工厂类创建；客户端需要知道创建具体产品的工厂类。</li><li>一个类通过其子类来指定创建哪个对象：在工厂方法模式中，对于抽象工厂类只需要提供一个创建产品的接口，而由其子类来确定具体要创建的对象，利用面向对象的多态性和里氏代换原则，在程序运行时，子类对象将覆盖父类对象，从而使得系统更容易扩展。</li><li>将创建对象的任务委托给多个工厂子类中的某一个，客户端在使用时可以无须关心是哪一个工厂子类创建产品子类，需要时再动态指定，可将具体工厂类的类名存储在配置文件或数据库中。</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//JDBC中的工厂方法</span></span><br><span class="line">Connection conn=DriverManager.getConnection(<span class="string">&quot;jdbc:microsoft:sqlserver://localhost:1433; DatabaseName=DB;user=sa;password=&quot;</span>);</span><br><span class="line">Statement statement=conn.createStatement();</span><br><span class="line">ResultSet rs=statement.executeQuery(<span class="string">&quot;select * from UserInfo&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>工厂方法模式又称为工厂模式，它属于类创建型模式。在工厂方法模式中，工厂父类负责定义创建产品对象的公共接口，而工厂子类则负责生成具体的产品对象，这样做的目的是将产品类的实例化操作延迟到工厂子类中完成，即通过工厂子类来确定究竟应该实例化哪一个具体产品类。</li><li>工厂方法模式包含四个角色：抽象产品是定义产品的接口，是工厂方法模式所创建对象的超类型，即产品对象的共同父类或接口；具体产品实现了抽象产品接口，某种类型的具体产品由专门的具体工厂创建，它们之间往往一一对应；抽象工厂中声明了工厂方法，用于返回一个产品，它是工厂方法模式的核心，任何在模式中创建对象的工厂类都必须实现该接口；具体工厂是抽象工厂类的子类，实现了抽象工厂中定义的工厂方法，并可由客户调用，返回一个具体产品类的实例。</li><li>工厂方法模式是简单工厂模式的进一步抽象和推广。由于使用了面向对象的多态性，工厂方法模式保持了简单工厂模式的优点，而且克服了它的缺点。在工厂方法模式中，核心的工厂类不再负责所有产品的创建，而是将具体创建工作交给子类去做。这个核心类仅仅负责给出具体工厂必须实现的接口，而不负责产品类被实例化这种细节，这使得工厂方法模式可以允许系统在不修改工厂角色的情况下引进新产品。</li><li>工厂方法模式的主要优点是增加新的产品类时无须修改现有系统，并封装了产品对象的创建细节，系统具有良好的灵活性和可扩展性；其缺点在于增加新产品的同时需要增加新的工厂，导致系统类的个数成对增加，在一定程度上增加了系统的复杂性。</li><li>工厂方法模式适用情况包括：一个类不知道它所需要的对象的类；一个类通过其子类来指定创建哪个对象；将创建对象的任务委托给多个工厂子类中的某一个，客户端在使用时可以无须关心是哪一个工厂子类创建产品子类，需要时再动态指定。</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单工厂模式(Simple Factory Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-simple-factory-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-simple-factory-pattern/</url>
      
        <content type="html"><![CDATA[<h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>简单工厂模式(Simple Factory Pattern)：又称为静态工厂方法(Static Factory Method)模式，它属于类创建型模式。在简单工厂模式中，可以根据参数的不同返回不同类的实例。简单工厂模式专门定义一个类来负责创建其他类的实例，被创建的实例通常都具有共同的父类。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><p>简单工厂模式包含如下角色：</p><ul><li>Factory：工厂角色</li><li>Product：抽象产品角色</li><li>ConcreteProduct：具体产品角色</li></ul><p><img src="/assets/img/pattern/class_SimpleFactory.png" alt="class_SimpleFactory"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/assets/img/pattern/seq_SimpleFactory.png" alt="seq_SimpleFactory"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//抽象产品角色</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体产品角色A</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductA</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;You are using ProductA&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体产品角色B</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductB</span> <span class="keyword">extends</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">use</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;You are using ProductB&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//工厂角色</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Product <span class="title">createProduct</span><span class="params">(String product)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (product==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (product.equals(<span class="string">&quot;A&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ProductA();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (product.equals(<span class="string">&quot;B&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ProductB();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Product productA = Factory.createProduct(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">        Product productB = Factory.createProduct(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">        productA.use(); <span class="comment">// You are using ProductA</span></span><br><span class="line">        productB.use(); <span class="comment">// You are using ProductB</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><ul><li>将对象的创建和对象本身业务处理分离可以降低系统的耦合度，使得两者修改起来都相对容易。</li><li>在调用工厂类的工厂方法时，由于工厂方法是静态方法，使用起来很方便，可通过类名直接调用，而且只需要传入一个简单的参数即可，在实际开发中，还可以在调用时将所传入的参数保存在XML等格式的配置文件中，修改参数时无须修改任何源代码。</li><li>简单工厂模式最大的问题在于工厂类的职责相对过重，增加新的产品需要修改工厂类的判断逻辑，这一点与开闭原则是相违背的。</li><li>简单工厂模式的要点在于：当你需要什么，只需要传入一个正确的参数，就可以获取你所需要的对象，而无须知道其创建细节。</li></ul><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>工厂类含有必要的判断逻辑，可以决定在什么时候创建哪一个产品类的实例，客户端可以免除直接创建产品对象的责任，而仅仅“消费”产品；简单工厂模式通过这种做法实现了对责任的分割，它提供了专门的工厂类用于创建对象。</li><li>客户端无须知道所创建的具体产品类的类名，只需要知道具体产品类所对应的参数即可，对于一些复杂的类名，通过简单工厂模式可以减少使用者的记忆量。</li><li>通过引入配置文件，可以在不修改任何客户端代码的情况下更换和增加新的具体产品类，在一定程度上提高了系统的灵活性。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul><li>由于工厂类集中了所有产品创建逻辑，一旦不能正常工作，整个系统都要受到影响。</li><li>使用简单工厂模式将会增加系统中类的个数，在一定程序上增加了系统的复杂度和理解难度。</li><li>系统扩展困难，一旦添加新产品就不得不修改工厂逻辑，在产品类型较多时，有可能造成工厂逻辑过于复杂，不利于系统的扩展和维护。</li><li>简单工厂模式由于使用了静态工厂方法，造成工厂角色无法形成基于继承的等级结构。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>工厂类负责创建的对象比较少：由于创建的对象较少，不会造成工厂方法中的业务逻辑太过复杂。</li><li>客户端只知道传入工厂类的参数，对于如何创建对象不关心：客户端既不需要关心创建细节，甚至连类名都不需要记住，只需要知道类型所对应的参数。</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><p>1 JDK类库中广泛使用了简单工厂模式，如工具类java.text.DateFormat，它用于格式化一个本地日期或者时间。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> DateFormat <span class="title">getDateInstance</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> DateFormat <span class="title">getDateInstance</span><span class="params">(<span class="keyword">int</span> style)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> DateFormat <span class="title">getDateInstance</span><span class="params">(<span class="keyword">int</span> style,Locale locale)</span></span>;</span><br></pre></td></tr></table></figure><p>2 Java加密技术</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取不同加密算法的密钥生成器:</span></span><br><span class="line">KeyGenerator keyGen=KeyGenerator.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建密码器:</span></span><br><span class="line">Cipher cp=Cipher.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>创建型模式对类的实例化过程进行了抽象，能够将对象的创建与对象的使用过程分离。</li><li>简单工厂模式又称为静态工厂方法模式，它属于类创建型模式。在简单工厂模式中，可以根据参数的不同返回不同类的实例。简单工厂模式专门定义一个类来负责创建其他类的实例，被创建的实例通常都具有共同的父类。</li><li>简单工厂模式包含三个角色：工厂角色负责实现创建所有实例的内部逻辑；抽象产品角色是所创建的所有对象的父类，负责描述所有实例所共有的公共接口；具体产品角色是创建目标，所有创建的对象都充当这个角色的某个具体类的实例。</li><li>简单工厂模式的要点在于：当你需要什么，只需要传入一个正确的参数，就可以获取你所需要的对象，而无须知道其创建细节。</li><li>简单工厂模式最大的优点在于实现对象的创建和对象的使用分离，将对象的创建交给专门的工厂类负责，但是其最大的缺点在于工厂类不够灵活，增加新的具体产品需要修改工厂类的判断逻辑代码，而且产品较多时，工厂方法代码将会非常复杂。</li><li>简单工厂模式适用情况包括：工厂类负责创建的对象比较少；客户端只知道传入工厂类的参数，对于如何创建对象不关心。</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单例模式(Singleton Pattern)</title>
      <link href="2021/09/10/2018-12-19-design-pattern-singleton-pattern/"/>
      <url>2021/09/10/2018-12-19-design-pattern-singleton-pattern/</url>
      
        <content type="html"><![CDATA[<h1 id="单例模式（Singleton-Pattern）"><a href="#单例模式（Singleton-Pattern）" class="headerlink" title="单例模式（Singleton Pattern）"></a>单例模式（Singleton Pattern）</h1><h2 id="模式定义"><a href="#模式定义" class="headerlink" title="模式定义"></a>模式定义</h2><p>单例模式(Singleton Pattern)确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例，这个类称为单例类，它提供全局访问的方法。</p><p>单例模式的要点有三个：一是某个类只能有一个实例；二是它必须自行创建这个实例；三是它必须自行向整个系统提供这个实例。单例模式是一种对象创建型模式。单例模式又名单件模式或单态模式。</p><h2 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h2><p>单例模式包含如下角色：</p><ul><li>Singleton：单例</li></ul><p><img src="/assets/img/pattern/class_Singleton.jpg" alt="class_Singleton"></p><h2 id="时序图"><a href="#时序图" class="headerlink" title="时序图"></a>时序图</h2><p><img src="/assets/img/pattern/seq_Singleton.jpg" alt="seq_Singleton"></p><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 单例</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建 SingleObject 的一个对象，类加载时就初始化了</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="comment">//让构造函数为 private，这样该类就不会被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="comment">//获取唯一可用的对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.hashCode()+<span class="string">&quot; : Hello World!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Singleton singleton1 = Singleton.getInstance();</span><br><span class="line">        singleton1.showMessage(); <span class="comment">// 135721597 : Hello World!</span></span><br><span class="line"></span><br><span class="line">        Singleton singleton2 = Singleton.getInstance();</span><br><span class="line">        singleton2.showMessage(); <span class="comment">// 135721597 : Hello World!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="模式分析"><a href="#模式分析" class="headerlink" title="模式分析"></a>模式分析</h2><p>单例模式的目的是保证一个类仅有一个实例，并提供一个访问它的全局访问点。单例模式包含的角色只有一个，就是单例类——Singleton。单例类拥有一个私有构造函数，确保用户无法通过new关键字直接实例化它。除此之外，该模式中包含一个静态私有成员变量与静态公有的工厂方法，该工厂方法负责检验实例的存在性并实例化自己，然后存储在静态成员变量中，以确保只有一个实例被创建。</p><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ul><li>提供了对唯一实例的受控访问。因为单例类封装了它的唯一实例，所以它可以严格控制客户怎样以及何时访问它，并为设计及开发团队提供了共享的概念。</li><li>由于在系统内存中只存在一个对象，因此可以节约系统资源，对于一些需要频繁创建和销毁的对象，单例模式无疑可以提高系统的性能。</li><li>允许可变数目的实例。我们可以基于单例模式进行扩展，使用与单例控制相似的方法来获得指定个数的对象实例。</li></ul><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ul><li>由于单例模式中没有抽象层，因此单例类的扩展有很大的困难。</li><li>单例类的职责过重，在一定程度上违背了“单一职责原则”。因为单例类既充当了工厂角色，提供了工厂方法，同时又充当了产品角色，包含一些业务方法，将产品的创建和产品的本身的功能融合到一起。</li><li>滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；现在很多面向对象语言(如Java、C#)的运行环境都提供了自动垃圾回收的技术，因此，如果实例化的对象长时间不被利用，系统会认为它是垃圾，会自动销毁并回收资源，下次利用时又将重新实例化，这将导致对象状态的丢失。</li></ul><h2 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h2><ul><li>系统只需要一个实例对象，如系统要求提供一个唯一的序列号生成器，或者需要考虑资源消耗太大而只允许创建一个对象。</li><li>客户调用类的单个实例只允许使用一个公共访问点，除了该公共访问点，不能通过其他途径访问该实例。</li><li>在一个系统中要求一个类只有一个实例时才应当使用单例模式。反过来，如果一个类可以有几个实例共存，就需要对单例模式进行改进，使之成为多例模式</li></ul><h2 id="模式应用"><a href="#模式应用" class="headerlink" title="模式应用"></a>模式应用</h2><p>一个具有自动编号主键的表可以有多个用户同时使用，但数据库中只能有一个地方分配下一个主键编号，否则会出现主键重复，因此该主键编号生成器必须具备唯一性，可以通过单例模式来实现。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>单例模式确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例，这个类称为单例类，它提供全局访问的方法。单例模式的要点有三个：一是某个类只能有一个实例；二是它必须自行创建这个实例；三是它必须自行向整个系统提供这个实例。单例模式是一种对象创建型模式。</li><li>单例模式只包含一个单例角色：在单例类的内部实现只生成一个实例，同时它提供一个静态的工厂方法，让客户可以使用它的唯一实例；为了防止在外部对其实例化，将其构造函数设计为私有。</li><li>单例模式的目的是保证一个类仅有一个实例，并提供一个访问它的全局访问点。单例类拥有一个私有构造函数，确保用户无法通过new关键字直接实例化它。除此之外，该模式中包含一个静态私有成员变量与静态公有的工厂方法。该工厂方法负责检验实例的存在性并实例化自己，然后存储在静态成员变量中，以确保只有一个实例被创建。</li><li>单例模式的主要优点在于提供了对唯一实例的受控访问并可以节约系统资源；其主要缺点在于因为缺少抽象层而难以扩展，且单例类职责过重。</li><li>单例模式适用情况包括：系统只需要一个实例对象；客户调用类的单个实例只允许使用一个公共访问点。</li></ul><hr><p>原文出处：<a href="http://design-patterns.readthedocs.org/zh_CN/latest/index.html">图说设计模式</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Design pattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CORS跨域</title>
      <link href="2021/09/10/2018-12-19-http-cors-java-filter/"/>
      <url>2021/09/10/2018-12-19-http-cors-java-filter/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是跨域"><a href="#什么是跨域" class="headerlink" title="什么是跨域"></a>什么是跨域</h2><p>Cross-Origin Resource Sharing(CORS) 是W3C为浏览器制定的可以跨域通信的规范。通过使用 XMLHttpRequest 对象, CORS可以让开发者方便的进行跨域通信, 就像在使用同域通信一样。</p><p>CORS的使用十分简单。想象一下有一个网站 a.com 想要获取另一个网站 b.com 的数据。但由于浏览器的同源策略, 这样的请求将会被禁止. 这时我们可以使用CORS, 通过添加一些特殊的请求\响应头, 可以让 a.com 访问 b.com 的数据。</p><p>根据浏览器的同源策略, 当请求的地址与来源地址的协议、域名、端口中的任一值不相同时, 均视为是一个跨域的请求。</p><h2 id="解决跨域问题"><a href="#解决跨域问题" class="headerlink" title="解决跨域问题"></a>解决跨域问题</h2><ol><li><p>jsonp跨域</p><p> JSONP（JSON with Padding：填充式JSON)，应用JSON的一种新方法，JSON、JSONP的区别：</p><ul><li>JSON返回的是一串数据、JSONP返回的是脚本代码(包含一个函数调用)</li><li>JSONP 只支持get请求、不支持post请求(类似往页面添加一个script标签，通过src属性去触发对指定地址的请求,故只能是Get请求)</li></ul></li><li><p>nginx反向代理：</p><p> <a href="http://www.baidu.com/index.html%E9%9C%80%E8%A6%81%E8%B0%83%E7%94%A8www.sina.com/server.php%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%86%99%E4%B8%80%E4%B8%AA%E6%8E%A5%E5%8F%A3www.baidu.com/server.php%EF%BC%8C%E7%94%B1%E8%BF%99%E4%B8%AA%E6%8E%A5%E5%8F%A3%E5%9C%A8%E5%90%8E%E7%AB%AF%E5%8E%BB%E8%B0%83%E7%94%A8www.sina.com/server.php%E5%B9%B6%E6%8B%BF%E5%88%B0%E8%BF%94%E5%9B%9E%E5%80%BC%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E8%BF%94%E5%9B%9E%E7%BB%99index.html">www.baidu.com/index.html需要调用www.sina.com/server.php，可以写一个接口www.baidu.com/server.php，由这个接口在后端去调用www.sina.com/server.php并拿到返回值，然后再返回给index.html</a></p></li><li><p>PHP端修改header</p><p> header(‘Access-Control-Allow-Origin:*’);//允许所有来源访问<br> header(‘Access-Control-Allow-Method:POST,GET’);//允许访问的方式</p></li><li><p>document.domain</p><p> 跨域分为两种，一种xhr不能访问不同源的文档，另一种是不同window之间不能进行交互操作;</p><ul><li>document.domain主要是解决第二种情况，且只能适用于主域相同子域不同的情况；</li><li>document.domain的设置是有限制的，我们只能把document.domain设置成自身或更高一级的父域，且主域必须相同。例如：a.b.example.com中某个文档的document.domain可以设成a.b.example.com、b.example.com 、example.com中的任意一个，但是不可以设成c.a.b.example.com，因为这是当前域的子域，也不可以设成baidu.com，因为主域已经不相同了。</li><li>兼容性：所有浏览器都支持；</li><li>优点：可以实现不同window之间的相互访问和操作；</li><li>缺点：只适用于父子window之间的通信，不能用于xhr；只能在主域相同且子域不同的情况下使用；</li></ul></li></ol><h3 id="Filter文件"><a href="#Filter文件" class="headerlink" title="Filter文件"></a>Filter文件</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 支持 CORS 跨域</span></span><br><span class="line"><span class="comment"> * web先OPTIONS请求，若 Access-Control-Allow-Origin：*，则发送真正的请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String allowOrigin;</span><br><span class="line">    <span class="keyword">private</span> String allowMethods;</span><br><span class="line">    <span class="keyword">private</span> String allowCredentials;</span><br><span class="line">    <span class="keyword">private</span> String allowHeaders;</span><br><span class="line">    <span class="keyword">private</span> String exposeHeaders;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        allowOrigin = filterConfig.getInitParameter(<span class="string">&quot;allowOrigin&quot;</span>);</span><br><span class="line">        allowMethods = filterConfig.getInitParameter(<span class="string">&quot;allowMethods&quot;</span>);</span><br><span class="line">        allowCredentials = filterConfig.getInitParameter(<span class="string">&quot;allowCredentials&quot;</span>);</span><br><span class="line">        allowHeaders = filterConfig.getInitParameter(<span class="string">&quot;allowHeaders&quot;</span>);</span><br><span class="line">        exposeHeaders = filterConfig.getInitParameter(<span class="string">&quot;exposeHeaders&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span></span></span><br><span class="line"><span class="function">     <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">        <span class="keyword">if</span> (!CStringUtils.isEmpty(allowOrigin)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;*&quot;</span>.equals(allowOrigin))&#123;</span><br><span class="line">                response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                List&lt;String&gt; allowOriginList = Arrays.asList(allowOrigin.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">                <span class="keyword">if</span> (!CollectionUtils.isEmpty(allowOriginList)) &#123;</span><br><span class="line">                    String currentOrigin = request.getHeader(<span class="string">&quot;Origin&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (allowOriginList.contains(currentOrigin)) &#123;</span><br><span class="line">                        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, currentOrigin);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowMethods)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, allowMethods);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowCredentials)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, allowCredentials);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowHeaders)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, allowHeaders);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(exposeHeaders)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Expose-Headers&quot;</span>, exposeHeaders);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;OPTIONS&quot;</span>.equals(request.getMethod()))&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="web-xml配置"><a href="#web-xml配置" class="headerlink" title="web.xml配置"></a>web.xml配置</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CorsFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.sgai.sadp.core.cors.CorsFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>allowOrigin<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>allowMethods<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>GET,PUT,DELETE,POST<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>allowHeaders<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>Origin,X-Requested-With,Content-Type,Accept<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CorsFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基础编程题目集 6-10 阶乘计算升级版</title>
      <link href="2021/09/10/2018-12-26-programing-big-number-multiple/"/>
      <url>2021/09/10/2018-12-26-programing-big-number-multiple/</url>
      
        <content type="html"><![CDATA[<h1 id="基础编程题目集-6-10-阶乘计算升级版"><a href="#基础编程题目集-6-10-阶乘计算升级版" class="headerlink" title="基础编程题目集 6-10 阶乘计算升级版"></a>基础编程题目集 6-10 阶乘计算升级版</h1><blockquote><p>本题要求实现一个打印非负整数阶乘的函数。</p></blockquote><h2 id="函数接口定义："><a href="#函数接口定义：" class="headerlink" title="函数接口定义："></a>函数接口定义：</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br></pre></td></tr></table></figure><p>其中N是用户传入的参数，其值不超过1000。如果N是非负整数，则该函数必须在一行中打印出N!的值，否则打印“Invalid input”。</p><h2 id="裁判测试程序样例："><a href="#裁判测试程序样例：" class="headerlink" title="裁判测试程序样例："></a>裁判测试程序样例：</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;N);</span><br><span class="line">    Print_Factorial(N);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 你的代码将被嵌在这里 */</span></span><br></pre></td></tr></table></figure><h2 id="输入样例："><a href="#输入样例：" class="headerlink" title="输入样例："></a>输入样例：</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">15</span><br></pre></td></tr></table></figure><h2 id="输出样例："><a href="#输出样例：" class="headerlink" title="输出样例："></a>输出样例：</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">1307674368000</span><br></pre></td></tr></table></figure><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print_Factorial</span> <span class="params">( <span class="keyword">const</span> <span class="keyword">int</span> N )</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">3000</span>];</span><br><span class="line">    <span class="keyword">int</span> temp,num,digit;           <span class="comment">//temp：每一位的结果  num:进位   digit：结果的位数</span></span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    a[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    digit=<span class="number">1</span>;                      <span class="comment">//从第1位开始</span></span><br><span class="line">    <span class="keyword">if</span>(N&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=N;i++)&#123;</span><br><span class="line">            num=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;digit;j++)&#123;</span><br><span class="line">              temp=a[j]*i+num;</span><br><span class="line">              a[j]=temp%<span class="number">10</span>;       <span class="comment">//把当前位的数字存入数字</span></span><br><span class="line">              num=temp/<span class="number">10</span>;        <span class="comment">//向前面一位进位</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(num)&#123;           <span class="comment">//当i的阶乘算完，若有进位，则数组需扩大</span></span><br><span class="line">                a[digit]=num%<span class="number">10</span>;</span><br><span class="line">                num/=<span class="number">10</span>;</span><br><span class="line">                digit++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=digit<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;Invalid input&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="java方案"><a href="#java方案" class="headerlink" title="java方案"></a>java方案</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factorial</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        factorial(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] result = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2570</span>]; <span class="comment">//原文 3000</span></span><br><span class="line">        <span class="keyword">int</span> tmp, digit, num;</span><br><span class="line">        digit = <span class="number">1</span>;</span><br><span class="line">        result[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (N &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i++) &#123;</span><br><span class="line">                num = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; digit; j++) &#123;</span><br><span class="line">                    tmp = result[j] * i + num;</span><br><span class="line">                    result[j] = tmp % <span class="number">10</span>;</span><br><span class="line">                    num = tmp / <span class="number">10</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    result[digit] = num % <span class="number">10</span>;</span><br><span class="line">                    num /= <span class="number">10</span>;</span><br><span class="line">                    digit++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = digit - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                System.out.print(result[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Invalid Input&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> programing </tag>
            
            <tag> PTA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Comparator使用</title>
      <link href="2021/09/10/2019-01-09-programing-Comparator/"/>
      <url>2021/09/10/2019-01-09-programing-Comparator/</url>
      
        <content type="html"><![CDATA[<h1 id="Comparator使用"><a href="#Comparator使用" class="headerlink" title="Comparator使用"></a>Comparator使用</h1><h2 id="JDK"><a href="#JDK" class="headerlink" title="JDK"></a>JDK</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Collections.sort(list,</span><br><span class="line">    Comparator.comparing(MinitaskVo::getStartPlace, Comparator.nullsLast(String::compareTo))</span><br><span class="line">    <span class="comment">//按年月日，不按具体时间</span></span><br><span class="line">    .thenComparing(e-&gt;DateUtil.formatDate(e.getOutWarehouseDt(),<span class="string">&quot;yyyyMMdd&quot;</span>),Comparator.nullsLast(String::compareTo))</span><br><span class="line">    .thenComparing(MinitaskVo::getDeliveryId, Comparator.nullsLast(String::compareTo))</span><br><span class="line">    .thenComparing(MinitaskVo::getPlateNo, Comparator.nullsLast(String::compareTo))</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> programing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javascript Utils</title>
      <link href="2021/09/10/2019-04-12-utils-javascript/"/>
      <url>2021/09/10/2019-04-12-utils-javascript/</url>
      
        <content type="html"><![CDATA[<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">~(<span class="function"><span class="keyword">function</span> (<span class="params">win</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xmUtils = &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 小数格式化</span></span><br><span class="line"><span class="comment">         * 使用方法 xmUtils.floatFormatter(123.222,2,true)</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>src 需要格式化的小数</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>pos 小数最多保留的位数</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>flag 小数位数不足是否补0</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        floatFormatter: <span class="function"><span class="keyword">function</span> (<span class="params">src, pos, flag</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (pos == <span class="literal">undefined</span> || pos &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                pos = <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isNaN</span>(src)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> f = <span class="built_in">Math</span>.round(src * <span class="built_in">Math</span>.pow(<span class="number">10</span>, pos)) / <span class="built_in">Math</span>.pow(<span class="number">10</span>, pos);</span><br><span class="line">            <span class="keyword">var</span> s = f.toString();</span><br><span class="line">            <span class="keyword">if</span> (pos &amp;&amp; pos &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> rs = s.indexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> (rs &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    rs = s.length;</span><br><span class="line">                    s += <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                    <span class="keyword">while</span> (s.length &lt;= rs + pos) &#123;</span><br><span class="line">                        s += <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * json对象自定义排序，原对象排好序</span></span><br><span class="line"><span class="comment">         * 实际上指定desc才倒序，其他的都是正序的</span></span><br><span class="line"><span class="comment">         * 使用 arrayObj.sort(function (a, b) &#123;</span></span><br><span class="line"><span class="comment">                    return xmUtils.sortByProps(a, b, &#123; &quot;propA&quot;: &quot;asc&quot;, &quot;propB&quot;: &quot;desc&quot; &#125;);</span></span><br><span class="line"><span class="comment">                &#125;);</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>item1 前一个对象</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>item2 后一个对象</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>obj   需要比较的属性及排序方式</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        sortByProps: <span class="function"><span class="keyword">function</span> (<span class="params">item1, item2, obj</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> props = [];</span><br><span class="line">            <span class="keyword">if</span> (obj) &#123;</span><br><span class="line">                props.push(obj)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> cps = []; <span class="comment">// 存储排序属性比较结果。</span></span><br><span class="line">            <span class="comment">// 如果未指定排序属性(即obj不存在)，则按照全属性升序排序。</span></span><br><span class="line">            <span class="comment">// 记录下两个排序项按照各个排序属性进行比较得到的结果</span></span><br><span class="line">            <span class="keyword">var</span> desc = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (props.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> item1) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (item1[p] &gt; item2[p]) &#123;</span><br><span class="line">                        cps.push(<span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">break</span>; <span class="comment">// 大于时跳出循环。</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item1[p] === item2[p]) &#123;</span><br><span class="line">                        cps.push(<span class="number">0</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cps.push(-<span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">break</span>; <span class="comment">// 小于时跳出循环。</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.length; i++) &#123;</span><br><span class="line">                    <span class="keyword">var</span> prop = props[i];</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> o <span class="keyword">in</span> prop) &#123;</span><br><span class="line">                        desc = prop[o] === <span class="string">&quot;desc&quot;</span>;</span><br><span class="line">                        <span class="keyword">if</span> (item1[o] &gt; item2[o]) &#123;</span><br><span class="line">                            cps.push(desc ? -<span class="number">1</span> : <span class="number">1</span>);</span><br><span class="line">                            <span class="keyword">break</span>; <span class="comment">// 大于时跳出循环。</span></span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item1[o] === item2[o]) &#123;</span><br><span class="line">                            cps.push(<span class="number">0</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            cps.push(desc ? <span class="number">1</span> : -<span class="number">1</span>);</span><br><span class="line">                            <span class="keyword">break</span>; <span class="comment">// 小于时跳出循环。</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 根据各排序属性比较结果综合判断得出两个比较项的最终大小关系</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; cps.length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cps[j] === <span class="number">1</span> || cps[j] === -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> cps[j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    win.xmUtils = xmUtils;</span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br></pre></td></tr></table></figure><h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><ol><li>格式化</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(xmUtils.floatFormatter(<span class="number">123.222</span>, <span class="number">2</span>, <span class="literal">true</span>));</span><br></pre></td></tr></table></figure><ol><li>排序</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [&#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">2</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">1</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    a: <span class="number">3</span>,</span><br><span class="line">    b: <span class="number">2</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    a: <span class="number">4</span>,</span><br><span class="line">    b: <span class="number">2</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    a: <span class="number">3</span>,</span><br><span class="line">    b: <span class="number">1</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    a: <span class="number">4</span>,</span><br><span class="line">    b: <span class="number">1</span></span><br><span class="line">&#125;];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> xmUtils.sortByProps(a, b, &#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: <span class="string">&quot;asc&quot;</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: <span class="string">&quot;desc&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> utils </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java日志框架</title>
      <link href="2021/04/27/java%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/"/>
      <url>2021/04/27/java%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JVM笔记</title>
      <link href="2021/04/26/JVM%E7%AC%94%E8%AE%B0/"/>
      <url>2021/04/26/JVM%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="JMM"><a href="#JMM" class="headerlink" title="JMM"></a>JMM</h2><p><img src="/2021/04/26/JVM%E7%AC%94%E8%AE%B0/JMM.svg" alt="JMM"></p><h2 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h2><p><img src="/2021/04/26/JVM%E7%AC%94%E8%AE%B0/class_loader.svg" alt="class_loader"></p><h2 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC</h2><p><img src="/2021/04/26/JVM%E7%AC%94%E8%AE%B0/JVM_GC.jpg" alt="JVM_GC"></p><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><h2 id="调优"><a href="#调优" class="headerlink" title="调优"></a>调优</h2>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库版本管理</title>
      <link href="2021/04/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/"/>
      <url>2021/04/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="关于数据库版本"><a href="#关于数据库版本" class="headerlink" title="关于数据库版本"></a>关于数据库版本</h2><p>三个主要概念</p><ol><li><p>配置项<br>数据库相关的配置项包括所有的数据库元素，如 Model、DDL、DML 及各种配置文件。</p></li><li><p>变更集<br>变更集就是数据库变更的最小单元，一个 Change Set 在物理表现上就是一个脚本文件。初始化后的数据库通过变更集进行统一的更新，每个变更集都应有对应的回滚脚本，吐过更新失败则使用该回滚脚本进行回滚。</p></li><li><p>基线<br>基线就是数据库在特定时期的一个“快照”，为随后的工作提供一个标准和起点，通常根据功能发布范围建立数据库基线。</p></li></ol><h2 id="思路与目标"><a href="#思路与目标" class="headerlink" title="思路与目标"></a>思路与目标</h2><ol><li><p>开发部署分离<br>开发环境、测试环境、生产环境严格分离是进行数据库版本控制的第一步，通常生产环境和其他环境的分离没有问题，但也要确保开发环境和测试环境的分离。开发环境和测试环境分离是确保开发过程中的数据库版本控制能够在测试环境得到第一轮的检验，避免生产环境中出现问题。</p></li><li><p>版本可见<br>版本号在开发、测试和实施等步骤中确保所有人都能可见是执行数据库版本的基础。</p></li><li><p>版本一致<br>版本一致指要满足系统版本等式，即正确的服务器+正确的客户端+正确的数据库=正确的服务</p></li><li><p>版本可回滚<br>当更新之后的最新版本有问题时，需要支持回滚到稳定版本。</p></li><li><p>版本可兼容<br>一个数据库版本对应着一批有效服务器版本</p></li></ol><p>设计如下要素：  </p><ol><li>版本号</li><li>版本校验</li><li>版本更新</li><li>版本回滚</li><li>版本基线</li></ol><h2 id="流程与实践"><a href="#流程与实践" class="headerlink" title="流程与实践"></a>流程与实践</h2><ol><li>版本号<br>通过创建版本表来存储和管理版本号<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- create table</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `db_version`(</span><br><span class="line">    `DATABASE_VERSION` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `MIN_SERVER_VERSION` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `UPDATE_DESCRIPTION` <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `UPDATE_TIME` <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> </span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- init</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `db_version` <span class="keyword">VALUES</span> (<span class="string">&#x27;MC-1.0.0-0001&#x27;</span>,<span class="string">&#x27;MC-1.0.0-001&#x27;</span>,<span class="string">&#x27;系统初始化&#x27;</span>,SYSDATE());</span><br></pre></td></tr></table></figure></li><li>版本校验<br>通过存储过程进行版本校验的脚本如下<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> db_version_check(<span class="keyword">IN</span> version <span class="type">varchar</span>(<span class="number">30</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> <span class="variable">@result</span> <span class="keyword">FROM</span> db_version <span class="keyword">where</span> DATABASE_VERSION <span class="operator">=</span> version;</span><br><span class="line">    IF <span class="variable">@result</span> <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="comment">-- 抛出自定义异常</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> db_version_not_match;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure></li><li>版本更新<br>根据比对老版本后、更新新版本号和描述，并根据需要更新服务器最小版本号，如下<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--检查版本号</span></span><br><span class="line"><span class="keyword">CALL</span> db_version_check(<span class="string">&#x27;MC-1.0.0-002&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更新版本号</span></span><br><span class="line"><span class="keyword">update</span> db_version <span class="keyword">set</span> DATABASE_VERSION <span class="operator">=</span> <span class="string">&#x27;MC-1.0.0-003&#x27;</span>, MIN_SERVER_VERSION <span class="operator">=</span></span><br><span class="line"> <span class="string">&#x27;MC-1.0.0-003&#x27;</span>, UPDATE_DESCRIPTION <span class="operator">=</span> <span class="string">&#x27;新增表&#x27;</span>, UPDATE_TIME <span class="operator">=</span> SYSDATE();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更新表结构</span></span><br></pre></td></tr></table></figure></li><li>版本回滚<br>比对版本号，回滚老版本号、更新描述并回滚更新内容<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--检查版本号</span></span><br><span class="line"><span class="keyword">CALL</span> db_version_check(<span class="string">&#x27;MC-1.0.0-003&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 回滚版本号</span></span><br><span class="line"><span class="keyword">update</span> db_version <span class="keyword">set</span> DATABASE_VERSION <span class="operator">=</span> <span class="string">&#x27;MC-1.0.0-002&#x27;</span>, MIN_SERVER_VERSION <span class="operator">=</span> </span><br><span class="line"><span class="string">&#x27;MC-1.0.0-002&#x27;</span>, UPDATE_DESCRIPTION <span class="operator">=</span> <span class="string">&#x27;更新回滚&#x27;</span>, UPDATE_TIME <span class="operator">=</span> SYSDATE();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 回滚表结构</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> TEMP <span class="keyword">drop</span> <span class="keyword">column</span> XXX;</span><br></pre></td></tr></table></figure></li><li>版本基线<br>完整的表DDL，及初始化的DML；即从一个可发布版本递增到另一个可发布版本。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 项目管理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见的安全相关HTTP响应头介绍</title>
      <link href="2021/04/21/%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3HTTP%E5%93%8D%E5%BA%94%E5%A4%B4%E4%BB%8B%E7%BB%8D/"/>
      <url>2021/04/21/%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3HTTP%E5%93%8D%E5%BA%94%E5%A4%B4%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<p>以下这些，可以通过设置Nginx返回头部信息，或者在代码里添加filter，统一添加返回头信息。</p><h2 id="X-Frame-Options"><a href="#X-Frame-Options" class="headerlink" title="X-Frame-Options"></a>X-Frame-Options</h2><ol><li><p>介绍<br><code>X-Frame-Options</code> 是为了减少点击劫持（Clickjacking）而引入的一个响应头。Chrome4+、Firefox3.6.9+、IE8+均支持，详细的浏览器支持情况<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options?redirectlocale=en-US&redirectslug=The_X-FRAME-OPTIONS_response_header#browser_compatibility">看这里</a>。<br>如果某页面被不被允许的页面以<code>&lt;iframe&gt;</code>或<code>&lt;frame&gt;</code>的形式嵌入，IE会显示类似于“此内容无法在框架中显示”的提示信息，Chrome和Firefox都会在控制台打印信息。由于嵌入的页面不会加载，这就减少了点击劫持的发生。</p></li><li><p>用例</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">x-frame-options: SAMEORIGIN</span><br></pre></td></tr></table></figure></li><li><p>取值：</p></li></ol><ul><li>DENY：不允许被任何页面嵌入；</li><li>SAMEORIGIN：不允许被本域以外的页面嵌入；</li><li>ALLOW-FROM uri：不允许被指定的域名以外的页面嵌入（Chrome现阶段不支持）；</li></ul><h2 id="X-XSS-Protection"><a href="#X-XSS-Protection" class="headerlink" title="X-XSS-Protection"></a>X-XSS-Protection</h2><ol><li><p>介绍<br>顾名思义，这个响应头是用来防范XSS的。浏览器提供的XSS保护机制并不完美，但是开启后仍然可以提升攻击难度，如果没有特殊需要，建议开启它。</p></li><li><p>用例</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X-XSS-Protection: 1; mode&#x3D;block</span><br></pre></td></tr></table></figure></li><li><p>取值：</p></li></ol><ul><li>0：禁用XSS保护；</li><li>1：启用XSS保护；</li><li>1; mode=block：启用XSS保护，并在检查到XSS攻击时，停止渲染页面（例如IE8中，检查到攻击时，整个页面会被一个#替换）；</li></ul><h2 id="X-Content-Type-Options"><a href="#X-Content-Type-Options" class="headerlink" title="X-Content-Type-Options"></a>X-Content-Type-Options</h2><ol><li>介绍<br>互联网上的资源有各种类型，通常浏览器会根据响应头的 <code>Content-Type</code> 字段来分辨它们的类型。<br>例如：<code>text/html</code> 代表html文档，<code>image/png</code>是PNG图片，<code>text/css</code>是CSS样式文档。</li></ol><p>然而，有些资源的 <code>Content-Type</code> 是错的或者未定义。这时，某些浏览器会启用 <code>MIME-sniffing</code> 来猜测该资源的类型，解析内容并执行。<br>例如，我们即使给一个html文档指定<code>Content-Type为text/plain</code>，在IE8-中这个文档依然会被当做html来解析。利用浏览器的这个特性，攻击者甚至可以让原本应该解析为图片的请求被解析为JavaScript。</p><ol start="2"><li>用例<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X-Content-Type-Options: nosniff</span><br></pre></td></tr></table></figure></li><li>取值：<br>这个响应头的值只能是 nosniff，可用于IE8+和Chrome。另外，它还被Chrome用于扩展下载，<a href="https://developer.chrome.com/extensions/hosting">见这里</a>。</li></ol><h2 id="Strict-Transport-Security"><a href="#Strict-Transport-Security" class="headerlink" title="Strict-Transport-Security"></a>Strict-Transport-Security</h2><ol><li>介绍<br>HTTP Strict Transport Security，简称为 HSTS 。它允许一个HTTPS网站，要求浏览器总是通过HTTPS来访问它。<br>现阶段，除了Chrome浏览器，Firefox4+，以及Firefox的NoScript扩展都支持这个响应头。</li></ol><p>我们知道HTTPS相对于HTTP有更好的安全性，而很多HTTPS网站，也可以通过HTTP来访问。开发人员的失误或者用户主动输入地址，都有可能导致用户以HTTP访问网站，降低了安全性。一般，我们会通过Web Server发送301/302重定向来解决这个问题。<br>现在有了HSTS，可以让浏览器帮你做这个跳转，省一次HTTP请求。另外，浏览器本地替换可以保证只会发送HTTPS请求，避免被劫持。</p><ol start="2"><li>用例<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">strict-transport-security: max-age&#x3D;16070400; includeSubDomains</span><br></pre></td></tr></table></figure></li><li>取值：<br><code>includeSubDomains</code> 是可选的，用来指定是否作用于子域名。支持HSTS的浏览器遇到这个响应头，会把当前网站加入<code>HSTS</code>列表，然后在max-age指定的秒数内，当前网站所有请求都会被重定向为https。即使用户主动输入 <code>http://</code> 或者不输入协议部分，都将重定向到 <code>https://</code> 地址。</li></ol><p>Chrome内置了一个HSTS列表，默认包含Google、Paypal、Twitter、Linode等等服务。我们也可以在Chrome输入<code>chrome://net-internals/#hsts</code>，进入HSTS管理界面。在这个页面，你可以增加/删除/查询<code>HSTS</code>记录。例如，你想一直以<code>https</code>访问某网址，通过<code>“add Domain”</code>加上去就好了。<br>查看Chrome内置的全部HSTS列表，或者想把自己的网站加入这个列表，<a href="https://www.chromium.org/hsts">请点这里</a>。</p><h2 id="X-Content-Security-Policy"><a href="#X-Content-Security-Policy" class="headerlink" title="X-Content-Security-Policy"></a>X-Content-Security-Policy</h2><ol><li>介绍<br>Content Security Policy，简称 CSP。顾名思义，这个规范与内容安全有关，主要是用来定义页面可以加载哪些资源，减少 XSS 的发生。<br>CSP 协议可以控制的内容非常多。而且如果不特别指定 unsafe-inline 时，页面上所有 inline 样式和脚本都不会执行；不特别指定 unsafe-eval，页面上不允许使用 new Function，setTimeout，eval 等方式执行动态代码。在限制了页面资源来源之后，被 XSS 的风险确实小不少。</li></ol><p>当然，仅仅依靠 CSP 来防范 XSS 是远远不够的，不支持全部浏览器是它的硬伤。不过，鉴于低廉的开发成本，加上也没什么坏处</p><ol start="2"><li><p>用例</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Security-Policy: default-src &#39;self&#39;</span><br></pre></td></tr></table></figure><p>注：default-src 是 CSP 指令，多个指令之间用英文分号分割；‘self’ 是指令值，多个指令值用英文空格分割</p></li><li><p>取值：</p></li></ol><table><thead><tr><th>指令</th><th>指令值示例</th><th>说明</th></tr></thead><tbody><tr><td>default-src</td><td>‘self’ cnd.a.com</td><td>定义针对所有类型（js、image、css、web font，ajax 请求，iframe，多媒体等）资源的默认加载策略，某类型资源如果没有单独定义策略，就使用默认的。</td></tr><tr><td>script-src</td><td>‘self’ js.a.com</td><td>定义针对 JavaScript 的加载策略。</td></tr><tr><td>style-src</td><td>‘self’ css.a.com</td><td>定义针对样式的加载策略。</td></tr><tr><td>img-src</td><td>‘self’ img.a.com</td><td>定义针对图片的加载策略。</td></tr><tr><td>connect-src</td><td>‘self’</td><td>针对 Ajax、WebSocket 等请求的加载策略。不允许的情况下，浏览器会模拟一个状态为 400 的响应。</td></tr><tr><td>font-src</td><td>font.a.com</td><td>针对 WebFont 的加载策略。</td></tr><tr><td>object-src</td><td>‘self’</td><td>针对 <code>&lt;object&gt;</code>、<code>&lt;embed&gt;</code> 或 <code>&lt;applet&gt;</code> 等标签引入的 flash 等插件的加载策略。</td></tr><tr><td>media-src</td><td>media.a.com</td><td>针对 <code>&lt;audio&gt;</code> 或 <code>&lt;video&gt;</code> 等标签引入的 HTML 多媒体的加载策略。</td></tr><tr><td>frame-src</td><td>‘self’</td><td>针对 frame 的加载策略。</td></tr><tr><td>sandbox</td><td>allow-forms</td><td>对请求的资源启用 sandbox（类似于 iframe 的 sandbox 属性）。</td></tr><tr><td>report-uri</td><td>/report-uri</td><td>告诉浏览器如果请求的资源不被策略允许时，往哪个地址提交日志信息。 特别的：如果想让浏览器只汇报日志，不阻止任何内容，可以改用 <code>Content-Security-Policy-Report-Only</code> 头。</td></tr></tbody></table><p>待处理</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>Referrer-Policy<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>no-referrer-when-downgrade<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>X-Permitted-Cross-Domain-Policies<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>master-only<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>X-Download-Options<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>noopen<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>————————————————<br>版权声明：本文为CSDN博主「小白旗」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_37788558/article/details/105460837">https://blog.csdn.net/qq_37788558/article/details/105460837</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle常用操作</title>
      <link href="2021/02/25/Oracle%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
      <url>2021/02/25/Oracle%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p>select * from v$session t1, v$locked_object t2 where t1.sid = t2.SESSION_ID; </p><p>alter system kill session ‘28,26421’; </p><p>drop sequence seq_t_test;<br>create sequence seq_t_test increment by 1 start with 你想要的值 maxvalue 999999999;</p><p>1 查看表空间路径<br>select * from dba_data_files;<br>2、创建用户表空间：<br>CREATE TABLESPACE NOTIFYDB DATAFILE ‘/oracle/oradata/test/notifydb.dbf’ SIZE 200M AUTOEXTEND ON EXTENT MANAGEMENT LOCAL SEGMENT SPACE MANAGEMENT AUTO;<br>3、创建用户，指定密码和上边创建的用户表空间<br>CREATE USER hc_notify IDENTIFIED BY hc_password DEFAULT TABLESPACE NOTIFYDB;<br>4、赋予权限<br>grant connect,resource to hc_notify;<br>grant unlimited tablespace to hc_notify;<br>grant create database link to hc_notify;<br>grant select any sequence,create materialized view to hc_notify;</p><p>grant create view to wms;</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java导入Excel特殊字符处理</title>
      <link href="2021/02/03/Java%E5%AF%BC%E5%85%A5Excel%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E5%A4%84%E7%90%86/"/>
      <url>2021/02/03/Java%E5%AF%BC%E5%85%A5Excel%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>导入Excel数据时，经常出现单元格里有空格、制表符、不显示的特殊字符；下面进行处理</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 去除字符串中的空格、制表符、特殊字符:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * \t \r \n</span></span><br><span class="line"><span class="comment"> * `&quot;\u202C&quot;` `&quot;\u202D&quot;` `&quot;\u202E&quot;`</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">replaceBlank</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (str == <span class="keyword">null</span>) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     Pattern p = Pattern.compile(<span class="string">&quot;[\u202C\u202D\u202E\\s(\\t\\n)\\n]&quot;</span>);</span><br><span class="line">     Matcher m = p.matcher(str);</span><br><span class="line">     <span class="keyword">return</span> m.replaceAll(<span class="string">&quot;&quot;</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 编程随笔 </category>
          
          <category> 代码片段 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 工具集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>base64格式处理</title>
      <link href="2021/02/02/base64%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86/"/>
      <url>2021/02/02/base64%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Base64 支持类型，并转换数据格式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Base64Type</span> </span>&#123;</span><br><span class="line">    IMAGE_GIF(<span class="string">&quot;data:image/gif;base64,&quot;</span>,<span class="string">&quot;gif&quot;</span>),</span><br><span class="line">    IMAGE_PNG(<span class="string">&quot;data:image/png;base64,&quot;</span>,<span class="string">&quot;png&quot;</span>),</span><br><span class="line">    IMAGE_JPG(<span class="string">&quot;data:image/jpg;base64,&quot;</span>,<span class="string">&quot;jpg&quot;</span>),</span><br><span class="line">    IMAGE_JPEG(<span class="string">&quot;data:image/jpeg;base64,&quot;</span>,<span class="string">&quot;jpeg&quot;</span>),</span><br><span class="line">    IMAGE_ICON(<span class="string">&quot;data:image/x-icon;base64,&quot;</span>,<span class="string">&quot;ico&quot;</span>),</span><br><span class="line">    TEXT_PLAIN(<span class="string">&quot;data:text/plain,bas64,&quot;</span>,<span class="string">&quot;txt&quot;</span>),</span><br><span class="line">    APPLICATION_PDF(<span class="string">&quot;data:application/pdf;base64,&quot;</span>,<span class="string">&quot;pdf&quot;</span>),</span><br><span class="line">    APPLICATION_DOC(<span class="string">&quot;data:application/doc;base64,&quot;</span>,<span class="string">&quot;doc&quot;</span>),</span><br><span class="line">    APPLICATION_DOCX(<span class="string">&quot;data:application/docx;base64,&quot;</span>,<span class="string">&quot;docx&quot;</span>),</span><br><span class="line">    APPLICATION_XLS(<span class="string">&quot;data:application/xls;base64,&quot;</span>,<span class="string">&quot;xls&quot;</span>),</span><br><span class="line">    APPLICATION_XLSX(<span class="string">&quot;data:application/xlsx;base64,&quot;</span>,<span class="string">&quot;xlsx&quot;</span>),</span><br><span class="line">    APPLICATION_PPT(<span class="string">&quot;data:application/ppt;base64,&quot;</span>,<span class="string">&quot;ppt&quot;</span>),</span><br><span class="line">    APPLICATION_PPTX(<span class="string">&quot;data:application/pptx;base64,&quot;</span>,<span class="string">&quot;pptx&quot;</span>),</span><br><span class="line">    APPLICATION_OTHER(<span class="string">&quot;data:application/*;base64,&quot;</span>,<span class="string">&quot;*&quot;</span>),</span><br><span class="line">    </span><br><span class="line">    ;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String prefix;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String type;</span><br><span class="line">    Base64Type(String prefix,String type)&#123;</span><br><span class="line">        <span class="keyword">this</span>.prefix = prefix;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPrefix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> prefix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @功能  精确计算base64字符串文件大小（单位：B）</span></span><br><span class="line"><span class="comment"> * @注意  base64字符串(不含data:audio/wav;base64,文件头)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">base64file_size</span><span class="params">( String base64String )</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//1.获取base64字符串长度(不含data:audio/wav;base64,文件头)</span></span><br><span class="line">        <span class="keyword">int</span> size0 = base64String.length();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.获取字符串的尾巴的最后10个字符，用于判断尾巴是否有等号，正常生成的base64文件&#x27;等号&#x27;不会超过4个</span></span><br><span class="line">        String tail = base64String.substring(size0-<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.找到等号，把等号也去掉,(等号其实是空的意思,不能算在文件大小里面)</span></span><br><span class="line">        <span class="keyword">int</span> equalIndex = tail.indexOf(<span class="string">&quot;=&quot;</span>);        </span><br><span class="line">        <span class="keyword">if</span>(equalIndex &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                size0 = size0 - (<span class="number">10</span> - equalIndex);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.计算后得到的文件流大小，单位为字节</span></span><br><span class="line">        <span class="keyword">return</span> size0 -( (<span class="keyword">double</span>)size0 / <span class="number">8</span> ) * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Richardson Maturity Model</title>
      <link href="2020/01/31/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/"/>
      <url>2020/01/31/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<pre><code>A model (developed by Leonard Richardson) that breaks down the principal elements of a REST approach into three steps. These introduce resources, http verbs, and hypermedia controls.</code></pre><p>Recently I’ve been reading drafts of Rest In Practice: a book that a couple of my colleagues have been working on. Their aim is to explain how to use Restful web services to handle many of the integration problems that enterprises face. At the heart of the book is the notion that the web is an existence proof of a massively scalable distributed system that works really well, and we can take ideas from that to build integrated systems more easily.</p><p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure1.png" alt="Steps toward REST"><br>Figure 1.Steps toward REST</p><p>To help explain the specific properties of a web-style system, the authors use a model of restful maturity that was developed by Leonard Richardson and <a href="https://www.crummy.com/writing/speaking/2008-QCon/act3.html">explained</a> at a QCon talk. The model is nice way to think about using these techniques, so I thought I’d take a stab of my own explanation of it. (The protocol examples here are only illustrative, I didn’t feel it was worthwhile to code and test them up, so there may be problems in the detail.)</p><h2 id="Level-0"><a href="#Level-0" class="headerlink" title="Level 0"></a>Level 0</h2><p>The starting point for the model is using HTTP as a transport system for remote interactions, but without using any of the mechanisms of the web. Essentially what you are doing here is using HTTP as a tunneling mechanism for your own remote interaction mechanism, usually based on <a href="https://www.enterpriseintegrationpatterns.com/patterns/messaging/EncapsulatedSynchronousIntegration.html">Remote Procedure Invocation</a>.</p><p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure2.png" alt="An example interaction at Level 0"><br>Figure 2.An example interaction at Level 0</p><p>Let’s assume I want to book an appointment with my doctor. My appointment software first needs to know what open slots my doctor has on a given date, so it makes a request of the hospital appointment system to obtain that information. In a level 0 scenario, the hospital will expose a service endpoint at some URI. I then post to that endpoint a document containing the details of my request.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/appointmentService</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotRequest date = &quot;2010-01-04&quot; doctor = &quot;mjones&quot;/&gt;</span><br></pre></td></tr></table></figure><p>The server then will return a document giving me this information</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotList&gt;</span><br><span class="line">  &lt;slot start = &quot;1400&quot; end = &quot;1450&quot;&gt;</span><br><span class="line">    &lt;doctor id = &quot;mjones&quot;/&gt;</span><br><span class="line">  &lt;/slot&gt;</span><br><span class="line">  &lt;slot start = &quot;1600&quot; end = &quot;1650&quot;&gt;</span><br><span class="line">    &lt;doctor id = &quot;mjones&quot;/&gt;</span><br><span class="line">  &lt;/slot&gt;</span><br><span class="line">&lt;/openSlotList&gt;</span><br></pre></td></tr></table></figure><p>I’m using XML here for the example, but the content can actually be anything: JSON, YAML, key-value pairs, or any custom format.</p><p>My next step is to book an appointment, which I can again do by posting a document to the endpoint.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/appointmentService</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line">&lt;appointmentRequest&gt;</span><br><span class="line">  &lt;slot doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointmentRequest&gt;</span><br></pre></td></tr></table></figure><p>If all is well I get a response saying my appointment is booked.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;appointment&gt;</span><br><span class="line">  &lt;slot doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointment&gt;</span><br></pre></td></tr></table></figure><p>If there is a problem, say someone else got in before me, then I’ll get some kind of error message in the reply body.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;appointmentRequestFailure&gt;</span><br><span class="line">  &lt;slot doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">  &lt;reason&gt;Slot not available&lt;/reason&gt;</span><br><span class="line">&lt;/appointmentRequestFailure&gt;</span><br></pre></td></tr></table></figure><p>So far this is a straightforward RPC style system. It’s simple as it’s just slinging plain old XML (POX) back and forth. If you use SOAP or XML-RPC it’s basically the same mechanism, the only difference is that you wrap the XML messages in some kind of envelope.</p><h2 id="Level-1-Resources"><a href="#Level-1-Resources" class="headerlink" title="Level 1 - Resources"></a>Level 1 - Resources</h2><p>The first step towards the Glory of Rest in the RMM is to introduce resources. So now rather than making all our requests to a singular service endpoint, we now start talking to individual resources.</p><p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure3.png" alt="Level 1 adds resources"><br>Figure 3.Level 1 adds resources</p><p>So with our initial query, we might have a resource for given doctor.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/doctors/mjones</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotRequest date = &quot;2010-01-04&quot;/&gt;</span><br></pre></td></tr></table></figure><p>The reply carries the same basic information, but each slot is now a resource that can be addressed individually.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotList&gt;</span><br><span class="line">  &lt;slot id = &quot;1234&quot; doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;slot id = &quot;5678&quot; doctor = &quot;mjones&quot; start = &quot;1600&quot; end = &quot;1650&quot;/&gt;</span><br><span class="line">&lt;/openSlotList&gt;</span><br></pre></td></tr></table></figure><p>With specific resources booking an appointment means posting to a particular slot.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/slots/1234</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line">&lt;appointmentRequest&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointmentRequest&gt;</span><br></pre></td></tr></table></figure><p>If all goes well I get a similar reply to before.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;appointment&gt;</span><br><span class="line">  &lt;slot id = &quot;1234&quot; doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointment&gt;</span><br></pre></td></tr></table></figure><p>The difference now is that if anyone needs to do anything about the appointment, like book some tests, they first get hold of the appointment resource, which might have a URI like <code>http://royalhope.nhs.uk/slots/1234/appointment</code>, and post to that resource.</p><p>To an object guy like me this is like the notion of object identity. Rather than calling some function in the ether and passing arguments, we call a method on one particular object providing arguments for the other information.</p><h2 id="Level-2-HTTP-Verbs"><a href="#Level-2-HTTP-Verbs" class="headerlink" title="Level 2 - HTTP Verbs"></a>Level 2 - HTTP Verbs</h2><p>I’ve used HTTP POST verbs for all my interactions here in level 0 and 1, but some people use GETs instead or in addition. At these levels it doesn’t make much difference, they are both being used as tunneling mechanisms allowing you to tunnel your interactions through HTTP. Level 2 moves away from this, using the HTTP verbs as closely as possible to how they are used in HTTP itself.</p><p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure4.png" alt="Level 2 addes HTTP verbs"><br>Figure 4.Level 2 addes HTTP verbs</p><p>For our the list of slots, this means we want to use GET.</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/doctors/mjones/slots?date=20100104&amp;status=open</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>royalhope.nhs.uk</span><br></pre></td></tr></table></figure><p>The reply is the same as it would have been with the POST</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotList&gt;</span><br><span class="line">  &lt;slot id = &quot;1234&quot; doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;slot id = &quot;5678&quot; doctor = &quot;mjones&quot; start = &quot;1600&quot; end = &quot;1650&quot;/&gt;</span><br><span class="line">&lt;/openSlotList&gt;</span><br></pre></td></tr></table></figure><p>At Level 2, the use of GET for a request like this is crucial. HTTP defines GET as a safe operation, that is it doesn’t make any significant changes to the state of anything. This allows us to invoke GETs safely any number of times in any order and get the same results each time. An important consequence of this is that it allows any participant in the routing of requests to use caching, which is a key element in making the web perform as well as it does. HTTP includes various measures to support caching, which can be used by all participants in the communication. By following the rules of HTTP we’re able to take advantage of that capability.</p><p>To book an appointment we need an HTTP verb that does change state, a POST or a PUT. I’ll use the same POST that I did earlier.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/slots/1234</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line">&lt;appointmentRequest&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointmentRequest&gt;</span><br></pre></td></tr></table></figure><p>The trade-offs between using POST and PUT here are more than I want to go into here, maybe I’ll do a separate article on them some day. But I do want to point out that some people incorrectly make a correspondence between POST/PUT and create/update. The choice between them is rather different to that.</p><p>Even if I use the same post as level 1, there’s another significant difference in how the remote service responds. If all goes well, the service replies with a response code of 201 to indicate that there’s a new resource in the world.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>slots/1234/appointment</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;appointment&gt;</span><br><span class="line">  &lt;slot id = &quot;1234&quot; doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointment&gt;</span><br></pre></td></tr></table></figure><p>The 201 response includes a location attribute with a URI that the client can use to GET the current state of that resource in the future. The response here also includes a representation of that resource to save the client an extra call right now.</p><p>There is another difference if something goes wrong, such as someone else booking the session.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">409</span> Conflict</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotList&gt;</span><br><span class="line">  &lt;slot id = &quot;5678&quot; doctor = &quot;mjones&quot; start = &quot;1600&quot; end = &quot;1650&quot;/&gt;</span><br><span class="line">&lt;/openSlotList&gt;</span><br></pre></td></tr></table></figure><p>The important part of this response is the use of an HTTP response code to indicate something has gone wrong. In this case a 409 seems a good choice to indicate that someone else has already updated the resource in an incompatible way. Rather than using a return code of 200 but including an error response, at level 2 we explicitly use some kind of error response like this. It’s up to the protocol designer to decide what codes to use, but there should be a non-2xx response if an error crops up. Level 2 introduces using HTTP verbs and HTTP response codes.</p><p>There is an inconsistency creeping in here. REST advocates talk about using all the HTTP verbs. They also justify their approach by saying that REST is attempting to learn from the practical success of the web. But the world-wide web doesn’t use PUT or DELETE much in practice. There are sensible reasons for using PUT and DELETE more, but the existence proof of the web isn’t one of them.</p><p>The key elements that are supported by the existence of the web are the strong separation between safe (eg GET) and non-safe operations, together with using status codes to help communicate the kinds of errors you run into.</p><h2 id="Level-3-Hypermedia-Controls"><a href="#Level-3-Hypermedia-Controls" class="headerlink" title="Level 3 - Hypermedia Controls"></a>Level 3 - Hypermedia Controls</h2><p>The final level introduces something that you often hear referred to under the ugly acronym of HATEOAS (Hypertext As The Engine Of Application State). It addresses the question of how to get from a list open slots to knowing what to do to book an appointment.</p><p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure5.png" alt="Level 3 adds hypermedia controls"><br>Figure 5.Level 3 adds hypermedia controls</p><p>We begin with the same initial GET that we sent in level 2</p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/doctors/mjones/slots?date=20100104&amp;status=open</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>royalhope.nhs.uk</span><br></pre></td></tr></table></figure><p>But the response has a new element</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;openSlotList&gt;</span><br><span class="line">  &lt;slot id = &quot;1234&quot; doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;&gt;</span><br><span class="line">     &lt;link rel = &quot;/linkrels/slot/book&quot; </span><br><span class="line">           uri = &quot;/slots/1234&quot;/&gt;</span><br><span class="line">  &lt;/slot&gt;</span><br><span class="line">  &lt;slot id = &quot;5678&quot; doctor = &quot;mjones&quot; start = &quot;1600&quot; end = &quot;1650&quot;&gt;</span><br><span class="line">     &lt;link rel = &quot;/linkrels/slot/book&quot; </span><br><span class="line">           uri = &quot;/slots/5678&quot;/&gt;</span><br><span class="line">  &lt;/slot&gt;</span><br><span class="line">&lt;/openSlotList&gt;</span><br></pre></td></tr></table></figure><p>Each slot now has a link element which contains a URI to tell us how to book an appointment.</p><p>The point of hypermedia controls is that they tell us what we can do next, and the URI of the resource we need to manipulate to do it. Rather than us having to know where to post our appointment request, the hypermedia controls in the response tell us how to do it.</p><p>The POST would again copy that of level 2</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/slots/1234</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line">&lt;appointmentRequest&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">&lt;/appointmentRequest&gt;</span><br></pre></td></tr></table></figure><p>And the reply contains a number of hypermedia controls for different things to do next.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>http://royalhope.nhs.uk/slots/1234/appointment</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line">&lt;appointment&gt;</span><br><span class="line">  &lt;slot id = &quot;1234&quot; doctor = &quot;mjones&quot; start = &quot;1400&quot; end = &quot;1450&quot;/&gt;</span><br><span class="line">  &lt;patient id = &quot;jsmith&quot;/&gt;</span><br><span class="line">  &lt;link rel = &quot;/linkrels/appointment/cancel&quot;</span><br><span class="line">        uri = &quot;/slots/1234/appointment&quot;/&gt;</span><br><span class="line">  &lt;link rel = &quot;/linkrels/appointment/addTest&quot;</span><br><span class="line">        uri = &quot;/slots/1234/appointment/tests&quot;/&gt;</span><br><span class="line">  &lt;link rel = &quot;self&quot;</span><br><span class="line">        uri = &quot;/slots/1234/appointment&quot;/&gt;</span><br><span class="line">  &lt;link rel = &quot;/linkrels/appointment/changeTime&quot;</span><br><span class="line">        uri = &quot;/doctors/mjones/slots?date=20100104&amp;status=open&quot;/&gt;</span><br><span class="line">  &lt;link rel = &quot;/linkrels/appointment/updateContactInfo&quot;</span><br><span class="line">        uri = &quot;/patients/jsmith/contactInfo&quot;/&gt;</span><br><span class="line">  &lt;link rel = &quot;/linkrels/help&quot;</span><br><span class="line">        uri = &quot;/help/appointment&quot;/&gt;</span><br><span class="line">&lt;/appointment&gt;</span><br></pre></td></tr></table></figure><p>One obvious benefit of hypermedia controls is that it allows the server to change its URI scheme without breaking clients. As long as clients look up the “addTest” link URI then the server team can juggle all URIs other than the initial entry points.</p><p>A further benefit is that it helps client developers explore the protocol. The links give client developers a hint as to what may be possible next. It doesn’t give all the information: both the “self” and “cancel” controls point to the same URI - they need to figure out that one is a GET and the other a DELETE. But at least it gives them a starting point as to what to think about for more information and to look for a similar URI in the protocol documentation.</p><p>Similarly it allows the server team to advertise new capabilities by putting new links in the responses. If the client developers are keeping an eye out for unknown links these links can be a trigger for further exploration.</p><p>There’s no absolute standard as to how to represent hypermedia controls. What I’ve done here is to use the current recommendations of the REST in Practice team, which is to follow ATOM (RFC 4287) I use a <code>&lt;link&gt;</code> element with a uri attribute for the target URI and a rel attribute for to describe the kind of relationship. A well known relationship (such as self for a reference to the element itself) is bare, any specific to that server is a fully qualified URI. ATOM states that the definition for well-known linkrels is the <a href="https://www.iana.org/assignments/link-relations/link-relations.xhtml">Registry of Link Relations</a> . As I write these are confined to what’s done by ATOM, which is generally seen as a leader in level 3 restfulness.</p><h2 id="The-Meaning-of-the-Levels"><a href="#The-Meaning-of-the-Levels" class="headerlink" title="The Meaning of the Levels"></a>The Meaning of the Levels</h2><p>I should stress that the RMM, while a good way to think about what the elements of REST, is not a definition of levels of REST itself. Roy Fielding has made it clear that <a href="https://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven">level 3 RMM is a pre-condition of REST</a>. Like many terms in software, REST gets lots of definitions, but since Roy Fielding coined the term, his definition should carry more weight than most.</p><p>What I find useful about this RMM is that it provides a good step by step way to understand the basic ideas behind restful thinking. As such I see it as tool to help us learn about the concepts and not something that should be used in some kind of assessment mechanism. I don’t think we have enough examples yet to be really sure that the restful approach is the right way to integrate systems, I do think it’s a very attractive approach and the one that I would recommend in most situations.</p><p>Talking about this with Ian Robinson, he stressed that something he found attractive about this model when Leonard Richardson first presented it was its relationship to common design techniques.</p><ul><li>Level 1 tackles the question of handling complexity by using divide and conquer, breaking a large service endpoint down into multiple resources.</li><li>Level 2 introduces a standard set of verbs so that we handle similar situations in the same way, removing unnecessary variation.</li><li>Level 3 introduces discoverability, providing a way of making a protocol more self-documenting.</li></ul><p>The result is a model that helps us think about the kind of HTTP service we want to provide and frame the expectations of people looking to interact with it.</p><h2 id="RMM-Richardson-Maturity-Model"><a href="#RMM-Richardson-Maturity-Model" class="headerlink" title="*[RMM]: Richardson Maturity Model"></a>*[RMM]: Richardson Maturity Model</h2><p>原文作者：Martin Fowler<br><a href="https://martinfowler.com/articles/richardsonMaturityModel.html">链接</a></p><p><a href="https://www.jianshu.com/p/2eac3dc053c1">中文译文</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 架构理论 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 架构 </tag>
            
            <tag> rest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>面试题目收集002</title>
      <link href="2020/01/30/%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86002/"/>
      <url>2020/01/30/%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86002/</url>
      
        <content type="html"><![CDATA[<h2 id="性能优化面试专栏"><a href="#性能优化面试专栏" class="headerlink" title="性能优化面试专栏"></a>性能优化面试专栏</h2><h3 id="tomcat性能优化整理"><a href="#tomcat性能优化整理" class="headerlink" title="tomcat性能优化整理"></a>tomcat性能优化整理</h3><ol><li>你怎样给tomcat调优？</li><li>如何加大comcat连接数？</li><li>怎样加大tomcat的内存？</li><li>tomcat中如何禁止列目录下的文件？</li><li>Tomcat有几种部署方式？</li><li>Tomcat的优化经验</li></ol><h3 id="JVM性能优化整理"><a href="#JVM性能优化整理" class="headerlink" title="JVM性能优化整理"></a>JVM性能优化整理</h3><ol><li>Java类加载过程</li><li>java内存分配</li><li>描述一下JVM加载Class文件的原理机制？</li><li>GC 是什么? 为什么要有 GC?</li><li>简述 Java 垃圾回收机制。</li><li>如何判断一个对象是否存活?(或者 GC 对象的判定方法)</li><li>垃圾回收的优点和原理。并考虑 2 种回收机制。</li><li>垃圾回收器的基本原理是什么?垃圾回收器可以马上回收内存吗?有什么办法主动通知虚拟机进行垃圾回收?</li><li>Java 中会存在内存泄漏吗，请简单描述。</li><li>深拷贝和浅拷贝。</li><li>System.gc() 和 Runtime.gc() 会做什么事情?</li><li>finalize() 方法什么时候被调用?析构函数 (finalization) 的 目的是什么?</li><li>如果对象的引用被置为 null，垃圾收集器是否会立即释放对象占 用的内存?</li><li>什么是分布式垃圾回收(DGC)?它是如何工作的?</li><li>串行(serial)收集器和吞吐量(throughput)收集器的区别 是什么?</li><li>在 Java 中，对象什么时候可以被垃圾回收?</li><li>简述 Java 内存分配与回收策率以及 Minor GC 和 Major GC。</li><li>JVM 的永久代中会发生垃圾回收么?</li><li>Java 中垃圾收集的方法有哪些?</li><li>什么是类加载器，类加载器有哪些?</li><li>类加载器双亲委派模型机制?</li></ol><h3 id="Mysql性能优化整理"><a href="#Mysql性能优化整理" class="headerlink" title="Mysql性能优化整理"></a>Mysql性能优化整理</h3><h2 id="微服务架构面试专栏"><a href="#微服务架构面试专栏" class="headerlink" title="微服务架构面试专栏"></a>微服务架构面试专栏</h2><h3 id="SpringCloud面试整理"><a href="#SpringCloud面试整理" class="headerlink" title="SpringCloud面试整理"></a>SpringCloud面试整理</h3><ol><li>什么是 Spring Cloud?</li><li>使用 Spring Cloud 有什么优势?</li><li>服务注册和发现是什么意思?Spring Cloud 如何实现?</li><li>负载平衡的意义什么?</li><li>什么是 Hystrix?它如何实现容错?</li><li>什么是 Hystrix 断路器?我们需要它吗?</li><li>什么是 Netflix Feign?它的优点是什么?</li><li>什么是 Spring Cloud Bus?我们需要它吗?</li></ol><h3 id="SpringBoot面试整理"><a href="#SpringBoot面试整理" class="headerlink" title="SpringBoot面试整理"></a>SpringBoot面试整理</h3><ol><li>什么是 Spring Boot?</li><li>Spring Boot 有哪些优点?</li><li>什么是 JavaConfig?</li><li>如何重新加载 Spring Boot 上的更改，而无需重新启动服务器?</li><li>Spring Boot 中的监视器是什么?</li><li>如何在 Spring Boot 中禁用 Actuator 端点安全性?</li><li>如何在自定义端口上运行 Spring Boot 应用程序?</li><li>什么是 YAML?</li><li>如何实现 Spring Boot 应用程序的安全性?</li><li>如何集成 Spring Boot 和 ActiveMQ?</li><li>如何使用 Spring Boot 实现分页和排序?</li><li>什么是 Swagger?你用 Spring Boot 实现了它吗?</li><li>什么是 Spring Profiles?</li><li>什么是 Spring Batch?</li><li>什么是 FreeMarker 模板？</li><li>如何使用 Spring Boot 实现异常处理?</li><li>您使用了哪些 starter maven 依赖项?</li><li>什么是 CSRF 攻击?</li><li>什么是 WebSockets?</li><li>什么是 AOP?</li><li>什么是 Apache Kafka?</li><li>我们如何监视所有 Spring Boot 微服务?</li></ol><h3 id="Dubbo面试整理"><a href="#Dubbo面试整理" class="headerlink" title="Dubbo面试整理"></a>Dubbo面试整理</h3><ol><li>Dubbo 中 zookeeper 做注册中心，如果注册中心集群都挂掉，发布者和订阅者之间还能通信么?</li><li>Dubbo 服务负载均衡策略?</li><li>Dubbo 在安全机制方面是如何解决的</li><li>Dubbo 连接注册中心和直连的区别</li></ol><h2 id="并发编程高级面试专栏"><a href="#并发编程高级面试专栏" class="headerlink" title="并发编程高级面试专栏"></a>并发编程高级面试专栏</h2><ol><li>Synchronized用过吗，其原理是什么？</li><li>你刚才提到获取对象的锁，这个 “锁 ”到底是什么？如何确定对象的锁？</li><li>什么是可重入性，为什么说 Synchronized 是可重入锁?</li><li>JVM 对 Java 的原生锁做了哪些优化?</li><li>为什么说 Synchronized 是非公平锁?</li><li>什么是锁消除和锁粗化?</li><li>为什么说 Synchronized 是一个悲观锁?乐观锁的实现原理 又是什么?什么是 CAS，它有什么特性?</li><li>乐观锁一定就是好的吗?</li><li>跟 Synchronized 相比，可重入锁 ReentrantLock 其实现 原理有什么不同?</li><li>那么请谈谈 AQS 框架是怎么回事儿?</li><li>请尽可能详尽地对比下 Synchronized 和 ReentrantLock 的异同。</li><li>ReentrantLock 是如何实现可重入性的?</li><li>除了 ReetrantLock，你还接触过 JUC 中的哪些并发工具?</li><li>请谈谈 ReadWriteLock 和 StampedLock。</li><li>如何让 Java 的线程彼此同步?你了解过哪些同步器?请分别介绍下。</li><li>CyclicBarrier 和 CountDownLatch 看起来很相似，请对比下呢?</li><li>Java 中的线程池是如何实现的?</li><li>创建线程池的几个核心构造参数?</li><li>线程池中的线程是怎么创建的?是一开始就随着线程池的启动 创建好的吗?</li><li>既然提到可以通过配置不同参数创建出不同的线程池，那么 Java 中默认实现好的线程池又有哪些呢?请比较它们的异同。</li><li>如何在 Java 线程池中提交线程?</li><li>什么是 Java 的内存模型，Java 中各个线程是怎么彼此看到 对方的变量的?</li><li>请谈谈 volatile 有什么特点，为什么它能保证变量对所有线 程的可见性?</li><li>既然 volatile 能够保证线程间的变量可见性，是不是就意味 着基于 volatile 变量的运算就是并发安全的?</li><li>请对比下 volatile 对比 Synchronized 的异同。</li><li>请谈谈 ThreadLocal 是怎么解决并发安全的?</li><li>很多人都说要慎用 ThreadLocal，谈谈你的理解，使用 ThreadLocal 需要注意些什么?</li></ol><h2 id="开源框架面试题专栏"><a href="#开源框架面试题专栏" class="headerlink" title="开源框架面试题专栏"></a>开源框架面试题专栏</h2><h3 id="Spring面试整理"><a href="#Spring面试整理" class="headerlink" title="Spring面试整理"></a>Spring面试整理</h3><ol><li>什么是 Spring 框架?Spring 框架有哪些主要模块?</li><li>使用 Spring 框架能带来哪些好处?</li><li>什么是控制反转(IOC)?什么是依赖注入?</li><li>请解释下 Spring 框架中的 IoC?</li><li>BeanFactory 和 ApplicationContext 有什么区别?</li><li>Spring 有几种配置方式?</li><li>如何用基于 XML 配置的方式配置 Spring?</li><li>如何用基于 Java 配置的方式配置 Spring?</li><li>怎样用注解的方式配置 Spring?</li><li>请解释 Spring Bean 的生命周期?</li><li>Spring Bean 的作用域之间有什么区别?</li><li>什么是 Spring inner beans?</li><li>Spring 框架中的单例 Beans 是线程安全的么?</li><li>请举例说明如何在 Spring 中注入一个 Java Collection?</li><li>如何向 Spring Bean 中注入一个 Java.util.Properties?</li><li>请解释 Spring Bean 的自动装配?</li><li>请解释自动装配模式的区别?</li><li>如何开启基于注解的自动装配?</li><li>请举例解释@Required 注解?</li><li>请举例解释@Autowired 注解?</li><li>请举例说明@Qualifier 注解?</li><li>构造方法注入和设值注入有什么区别? 请注意以下明显的区别:</li><li>Spring 框架中有哪些不同类型的事件?</li><li>FileSystemResource 和 ClassPathResource 有何区别?</li><li>Spring 框架中都用到了哪些设计模式?</li><li>开发中主要使用 Spring 的什么技术 ?</li><li>简述 AOP 和 IOC 概念 AOP:</li><li>在 Spring 中如何配置 Bean ?</li><li>IOC 容器对 Bean 的生命周期:</li></ol><h3 id="SpringMVC面试整理"><a href="#SpringMVC面试整理" class="headerlink" title="SpringMVC面试整理"></a>SpringMVC面试整理</h3><ol><li>什么是 SpringMvc?</li><li>Spring MVC 的优点:</li><li>SpringMVC 工作原理?</li><li>SpringMVC 流程?</li><li>SpringMvc 的控制器是不是单例模式,如果是,有什么问题,怎么解决?</li><li>如果你也用过 struts2.简单介绍下 springMVC 和 struts2 的区别有哪些?</li><li>SpingMvc 中的控制器的注解一般用那个,有没有别的注解可以替代?</li><li> @RequestMapping 注解用在类上面有什么作用?</li><li>怎么样把某个请求映射到特定的方法上面?</li><li>如果在拦截请求中,我想拦截 get 方式提交的方法,怎么配置?</li><li>怎么样在方法里面得到 Request,或者 Session?</li><li>我想在拦截的方法里面得到从前台传入的参数,怎么得到?</li><li>如果前台有很多个参数传入,并且这些参数都是一个对象的,那么怎么样快速得到这个对象?</li><li>SpringMvc 中函数的返回值是什么?</li><li>SpringMVC 怎么样设定重定向和转发的?</li><li>SpringMvc 用什么对象从后台向前台传递数据的?</li><li>SpringMvc 中有个类把视图和数据都合并的一起的,叫什么?</li><li>怎么样把 ModelMap 里面的数据放入 Session 里面?</li><li>SpringMvc 怎么和 AJAX 相互调用的?</li><li>当一个方法向 AJAX 返回特殊对象,譬如 Object,List 等,需要做什么处理?</li><li>SpringMvc 里面拦截器是怎么写的</li><li>讲下 SpringMvc 的执行流程</li></ol><h3 id="MyBatis面试整理"><a href="#MyBatis面试整理" class="headerlink" title="MyBatis面试整理"></a>MyBatis面试整理</h3><ol><li>什么是 MyBatis?</li><li>讲下 MyBatis 的缓存</li><li>Mybatis 是如何进行分页的?分页插件的原理是什么?</li><li>简述 Mybatis 的插件运行原理，以及如何编写一个插件?</li><li>Mybatis 动态 sql 是做什么的?都有哪些动态 sql?能简述一下动态 sql 的执行原理吗?</li><li>#{}和${}的区别是什么?</li><li>为什么说 Mybatis 是半自动 ORM 映射工具?它与全自动的区别在哪里?</li><li>Mybatis 是否支持延迟加载?如果支持，它的实现原理是什么?</li><li>MyBatis 与 Hibernate 有哪些不同?</li><li>MyBatis 的好处是什么?</li><li>简述 Mybatis 的 Xml 映射文件和 Mybatis 内部数据结构之间的映射关系?</li><li>什么是 MyBatis 的接口绑定,有什么好处?</li><li>接口绑定有几种实现方式,分别是怎么实现的?</li><li>什么情况下用注解绑定,什么情况下用 xml 绑定?</li><li>MyBatis 实现一对一有几种方式?具体怎么操作的?</li><li>Mybatis 能执行一对一、一对多的关联查询吗?都有哪些实现方式，以及它们之间的区别?</li><li>MyBatis 里面的动态 Sql 是怎么设定的?用什么语法?</li><li>Mybatis 是如何将 sql 执行结果封装为目标对象并返回的?都有哪些映射形式?</li><li>Xml 映射文件中，除了常见的 select|insert|updae|delete 标签之外，还有哪些标签?</li><li>当实体类中的属性名和表中的字段名不一样，如果将查询的结果封装到指定 pojo?</li><li>模糊查询 like 语句该怎么写</li><li>通常一个 Xml 映射文件，都会写一个 Dao 接口与之对应, Dao 的工作原理，是否可以重载?</li><li>Mybatis 映射文件中，如果 A 标签通过 include 引用了 B 标签的内容，请问，B 标签能 否定义在 A 标签的后面，还是说必须定义在 A 标签的前面?</li><li>Mybatis 的 Xml 映射文件中，不同的 Xml 映射文件，id 是否可以重复?</li><li>Mybatis 中如何执行批处理?</li><li>Mybatis 都有哪些 Executor 执行器?它们之间的区别是什么?</li><li>Mybatis 中如何指定使用哪一种 Executor 执行器?</li><li>Mybatis 执行批量插入，能返回数据库主键列表吗?</li><li>Mybatis 是否可以映射 Enum 枚举类?</li><li>如何获取自动生成的(主)键值?</li><li>在 mapper 中如何传递多个参数?</li><li>resultType resultMap 的区别?</li><li>使用 MyBatis 的 mapper 接口调用时有哪些要求?</li><li>Mybatis 比 IBatis 比较大的几个改进是什么?</li><li>IBatis 和 MyBatis 在核心处理类分别叫什么?</li><li>IBatis 和 MyBatis 在细节上的不同有哪些?</li></ol><h2 id="分布式面试专栏"><a href="#分布式面试专栏" class="headerlink" title="分布式面试专栏"></a>分布式面试专栏</h2><h3 id="ZooKeeper专题"><a href="#ZooKeeper专题" class="headerlink" title="ZooKeeper专题"></a>ZooKeeper专题</h3><ol><li>ZooKeeper 是什么?</li><li>ZooKeeper 提供了什么?</li><li>Zookeeper 文件系统</li><li>四种类型的 znode</li><li>Zookeeper 通知机制</li><li>Zookeeper 做了什么?</li><li>Zookeeper 的命名服务(文件系统)</li><li>Zookeeper 的配置管理(文件系统、通知机制)</li><li>Zookeeper 集群管理(文件系统、通知机制)</li><li>Zookeeper 分布式锁(文件系统、通知 机制)</li><li>获取分布式锁的流程</li><li>Zookeeper 队列管理(文件系统、通知机制)</li><li>Zookeeper 数据复制</li><li>Zookeeper 工作原理</li><li>zookeeper 是如何保证事务的顺序一致性的?</li><li>Zookeeper 下 Server 工作状态</li><li>zookeeper 是如何选取主 leader 的?</li><li>Zookeeper 同步流程</li><li>分布式通知和协调</li><li>机器中为什么会有 leader?</li><li>Zookeeper 节点宕机如何处理?</li><li>zookeeper 负载均衡和 nginx 负载均衡区别</li><li>zookeeper watch 机制</li></ol><h3 id="Nginx面试专题"><a href="#Nginx面试专题" class="headerlink" title="Nginx面试专题"></a>Nginx面试专题</h3><ol><li>请解释一下什么是 Nginx?</li><li>请列举 Nginx 的一些特性。</li><li>请解释 Nginx 如何处理 HTTP 请求</li><li>在 Nginx 中，如何使用未定义的服务器名称来阻止处理请求?</li><li> 使用“反向代理服务器”的优点是什么?</li><li>请列举 Nginx 服务器的最佳用途。</li><li>请解释 Nginx 服务器上的 Master 和 Worker 进程分别是什么?</li><li>请解释你如何通过不同于 80 的端口开启 Nginx?</li><li>请解释是否有可能将 Nginx 的错误替换为 502 错误、503?</li><li>在 Nginx 中，解释如何在 URL 中保留双斜线?</li><li>请解释 ngx_http_upstream_module 的作用是什么?</li><li>请解释什么是 C10K 问题?</li><li>请陈述 stub_status 和 sub_filter 指令的作用是什么?</li><li>解释 Nginx 是否支持将请求压缩到上游?</li><li>解释如何在 Nginx 中获得当前的时间?</li></ol><h2 id="分布式通讯面试整理"><a href="#分布式通讯面试整理" class="headerlink" title="分布式通讯面试整理"></a>分布式通讯面试整理</h2><h3 id="RabbitMQ消息中间件面试专题"><a href="#RabbitMQ消息中间件面试专题" class="headerlink" title="RabbitMQ消息中间件面试专题"></a>RabbitMQ消息中间件面试专题</h3><ol><li>RabbitMQ 中的 broker 是指什么?cluster 又是指什么?</li><li>什么是元数据?元数据分为哪些类型?包括哪些内容?与 cluster 相关的元数据 有哪些?元数据是如何保存的?元数据在 cluster 中是如何分布的?</li><li>RAM node 和 disk node 的区别?</li><li>RabbitMQ 上的一个 queue 中存放的 message 是否有数量限制?</li><li>vhost 是什么?起什么作用?</li><li>在单 node 系统和多 node 构成的 cluster 系统中声明 queue、exchange ，以及进行 binding 会有什么不同?</li><li>客户端连接到 cluster 中的任意 node 上是否都能正常工作?</li><li>若 cluster 中拥有某个 queue 的 owner node 失效了，且该 queue 被声明具有 durable 属性，是否能够成功从其他 node 上重新声明该 queue ?</li><li>cluster 中 node 的失效会对 consumer 产生什么影响?若是在 cluster 中创建了 mirrored queue ，这时 node 失效会对 consumer 产生什么影响?</li><li>能够在地理上分开的不同数据中心使用 RabbitMQ cluster 么?</li><li>为什么 heavy RPC 的使用场景下不建议采用 disk node</li><li>向不存在的 exchange 发 publish 消息会发生什么?向不存在的 queue 执行consume 动作会发生什么?</li><li>routing_key 和 binding_key 的最大长度是多少?</li><li>RabbitMQ 允许发送的 message 最大可达多大?</li><li>什么情况下 producer 不主动创建 queue 是安全的?</li><li>“dead letter”queue 的用途?</li><li>什么说保证 message 被可靠持久化的条件是 queue 和 exchange 具有 durable 属性，同时 message 具有 persistent 属性才行?</li><li>什么情况下会出现 blackholed 问题?</li><li>如何防止出现 blackholed 问题?</li><li>Consumer Cancellation Notification 机制用于什么场景?</li><li>Basic.Reject 的用法是什么?</li><li>为什么不应该对所有的 message 都使用持久化机制?</li></ol><h3 id="Kafka面试专题"><a href="#Kafka面试专题" class="headerlink" title="Kafka面试专题"></a>Kafka面试专题</h3><ol><li>Kafka 的设计时什么样的呢?</li><li>数据传输的事物定义有哪三种?</li><li>Kafka 判断一个节点是否还活着有那两个条件?</li><li>producer 是否直接将数据发送到 broker 的 leader(主节点)?</li><li>Kafa consumer 是否可以消费指定分区消息?</li><li>Kafka 消息是采用 Pull 模式，还是 Push 模式?</li><li>Kafka 存储在硬盘上的消息格式是什么?</li><li>Kafka 高效文件存储设计特点:</li><li>Kafka 与传统消息系统之间有三个关键区别</li><li>Kafka 创建 Topic 时如何将分区放置到不同的 Broker 中</li><li>Kafka 新建的分区会在哪个目录下创建</li><li>partition 的数据如何保存到硬盘</li><li>kafka 的 ack 机制</li><li>Kafka 的消费者如何消费数据</li><li>消费者负载均衡策略</li><li>数据有序</li><li>kafaka 生产数据时数据的分组策略</li></ol><h3 id="ActiveMQ消息中间件面试专题"><a href="#ActiveMQ消息中间件面试专题" class="headerlink" title="ActiveMQ消息中间件面试专题"></a>ActiveMQ消息中间件面试专题</h3><ol><li>什么是 ActiveMQ?</li><li>ActiveMQ 服务器宕机怎么办?</li><li>丢消息怎么办?</li><li>持久化消息非常慢。</li><li>消息的不均匀消费。</li><li>死信队列。</li><li>ActiveMQ 中的消息重发时间间隔和重发次数吗?</li></ol><h2 id="分布式数据库面试整理"><a href="#分布式数据库面试整理" class="headerlink" title="分布式数据库面试整理"></a>分布式数据库面试整理</h2><h3 id="redis面试专题"><a href="#redis面试专题" class="headerlink" title="redis面试专题"></a>redis面试专题</h3><ol><li>redis 和 memcached 什么区别?为什么高并发下有时单线程的 redis 比多线程的 memcached 效率要高?</li><li>redis 主从复制如何实现的?redis 的集群模式如何实现?redis 的 key 是如何寻址的?</li><li>使用 redis 如何设计分布式锁?说一下实现思路?使用 zk 可以吗?如何实现?这两种有什么区别?</li><li>知道 redis 的持久化吗?底层如何实现的?有什么优点缺点?</li><li>redis 过期策略都有哪些?LRU 算法知道吗?写一下 java 代码实现?</li><li>缓存穿透、缓存击穿、缓存雪崩解决方案?</li><li>在选择缓存时，什么时候选择 redis，什么时候选择 memcached</li><li>缓存与数据库不一致怎么办</li><li>主从数据库不一致如何解决</li><li>Redis 常见的性能问题和解决方案</li><li>Redis 的数据淘汰策略有哪些</li><li>Redis 当中有哪些数据结构</li><li>假如 Redis 里面有 1 亿个 key，其中有 10w 个 key 是以某个固定的已知的前缀开头的，如果将它们全部找出来?</li><li>使用 Redis 做过异步队列吗，是如何实现的</li><li>Redis 如何实现延时队列</li><li>什么是 Redis?简述它的优缺点?</li><li>Redis 相比 memcached 有哪些优势?</li><li>Redis 支持哪几种数据类型?</li><li>Redis 主要消耗什么物理资源?</li><li>Redis 的全称是什么?</li><li>Redis 有哪几种数据淘汰策略?</li><li>Redis 官方为什么不提供 Windows 版本?</li><li>一个字符串类型的值能存储最大容量是多少?</li><li>为什么 Redis 需要把所有数据放到内存中?</li><li>Redis 集群方案应该怎么做?都有哪些方案?</li><li>Redis 集群方案什么情况下会导致整个集群不可用?</li><li>MySQL 里有 2000w 数据，redis 中只存 20w 的数据，如何保证 redis 中的数据都是热点数据?</li><li>Redis 有哪些适合的场景?</li><li>Redis 支持的 Java 客户端都有哪些?官方推荐用哪个?</li><li>Redis 和 Redisson 有什么关系?</li><li>Jedis 与 Redisson 对比有什么优缺点?</li><li>Redis 如何设置密码及验证密码?</li><li>说说 Redis 哈希槽的概念?</li><li>Redis 集群的主从复制模型是怎样的?</li><li>Redis 集群会有写操作丢失吗?为什么?</li><li>Redis 集群之间是如何复制的?</li><li>Redis 集群最大节点个数是多少?</li><li>Redis 集群如何选择数据库?</li><li>怎么测试 Redis 的连通性?</li><li>Redis 中的管道有什么用?</li><li>怎么理解 Redis 事务?</li><li>Redis 事务相关的命令有哪几个?</li><li>Redis key的过期时间和永久有效分别怎么设置?</li><li>Redis 如何做内存优化?</li><li>Redis 回收进程如何工作的?</li></ol><h3 id="MongoDB面试专题"><a href="#MongoDB面试专题" class="headerlink" title="MongoDB面试专题"></a>MongoDB面试专题</h3><ol><li>你说的 NoSQL 数据库是什么意思?NoSQL 与 RDBMS 直接有什么区别?为什么要使用和不使用 NoSQL 数据库?说一说 NoSQL 数据库的几个优点?</li><li>NoSQL 数据库有哪些类型?</li><li>MySQL 与 MongoDB 之间最基本的差别是什么?</li><li>你怎么比较 MongoDB、CouchDB 及 CouchBase?</li><li>MongoDB 成为最好 NoSQL 数据库的原因是什么?</li><li>32 位系统上有什么细微差别?</li><li>journal 回放在条目(entry)不完整时(比如恰巧有一个中途故障了)会遇到问题吗?</li><li>分析器在 MongoDB 中的作用是什么?</li><li>名字空间(namespace)是什么?</li><li>如果用户移除对象的属性，该属性是否从存储层中删除?</li><li>能否使用日志特征进行安全备份?</li><li>允许空值 null 吗?</li><li>更新操作立刻 fsync 到磁盘?</li><li>如何执行事务/加锁?</li><li>为什么我的数据文件如此庞大?</li><li>启用备份故障恢复需要多久?</li><li>什么是 master 或 primary?</li><li>什么是 secondary 或 slave?</li><li>我必须调用 getLastError 来确保写操作生效了么?</li><li>我应该启动一个集群分片(sharded)还是一个非集群分片的 MongoDB 环境?</li><li>分片(sharding)和复制(replication)是怎样工作的?</li><li>数据在什么时候才会扩展到多个分片(shard)里?</li><li>当我试图更新一个正在被迁移的块(chunk)上的文档时会发生什么?</li><li>如果在一个分片(shard)停止或者很慢的时候，我发起一个查询会怎样?</li><li>我可以把 moveChunk 目录里的旧文件删除吗?</li><li>我怎么查看 Mongo 正在使用的链接?</li><li>如果块移动操作(moveChunk)失败了，我需要手动清除部分转移的文档吗?</li><li>如果我在使用复制技术(replication)，可以一部分使用日志(journaling)而其他部分则不使用吗?</li><li>当更新一个正在被迁移的块(Chunk)上的文档时会发生什么?</li><li>MongoDB 在 A:{B,C}上建立索引，查询 A:{B,C}和 A:{C,B}都会使用索引吗?</li><li>如果一个分片(Shard)停止或很慢的时候，发起一个查询会怎样?</li><li>MongoDB 支持存储过程吗?如果支持的话，怎么用?</li><li>如何理解 MongoDB 中的 GridFS 机制，MongoDB 为何使用 GridFS 来存储文件?</li></ol><h3 id="memcached面试专题"><a href="#memcached面试专题" class="headerlink" title="memcached面试专题"></a>memcached面试专题</h3><ol><li>memcached是怎么工作的?</li><li>memcached 最大的优势是什么?</li><li>memcached 和 MySQL 的query cache 相比有什么优缺点?</li><li>memcached 和服务器的 local cache (比如 PHP 的 APC、mmap 文件等）相比，有什么优缺点？</li><li>memcached 的 cache 机制是怎样的?</li><li>memcached 如何实现冗余机制?</li><li>memcached 如何处理容错的?</li><li>如何将 memcached 中 item 批量导入导出?</li><li>我需要把 memcached 中的 item 批量导出导入，怎么办?</li><li>memcached 是如何做身份验证的?</li><li>memcached 的多线程是什么?如何使用它们?</li><li>memcached 能接受的 key 的最大长度是多少?</li><li>memcached 对 item 的过期时间有什么限制?</li><li>memcached 最大能存储多大的单个 item?</li></ol><hr><p>作者：楚阳<br>链接：<a href="https://leetcode-cn.com/circle/article/LcV4q1/">https://leetcode-cn.com/circle/article/LcV4q1/</a><br>来源：力扣（LeetCode）<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问答 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字符串匹配算法</title>
      <link href="2020/01/30/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95/"/>
      <url>2020/01/30/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="详见"><a href="#详见" class="headerlink" title="详见"></a>详见</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MjM5MjAwODM4MA==&amp;mid=2650737867&amp;idx=2&amp;sn=3d96f28f0a72d050ab8e319505fd0b34&amp;chksm=bea77d1889d0f40e05eee3ac744350c33a88b9fe93ca7167497c91f74f54905ddf2f39d103a2&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1580359826790&amp;sharer_shareid=a13757509c959280de99eee610e2d081#rd">https://mp.weixin.qq.com/s?__biz=MjM5MjAwODM4MA==&amp;mid=2650737867&amp;idx=2&amp;sn=3d96f28f0a72d050ab8e319505fd0b34&amp;chksm=bea77d1889d0f40e05eee3ac744350c33a88b9fe93ca7167497c91f74f54905ddf2f39d103a2&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1580359826790&amp;sharer_shareid=a13757509c959280de99eee610e2d081#rd</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 算法题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问答 </tag>
            
            <tag> programing </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>面试题目收集001</title>
      <link href="2020/01/30/%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86001/"/>
      <url>2020/01/30/%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86001/</url>
      
        <content type="html"><![CDATA[<h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><ol><li>接雨水(被问很多次)</li><li>链表反转</li><li>链表快排和归并排序</li><li>堆排序</li><li>数据流中位数</li><li>给定n个数，找出和为k的最少数字个数，例如，给定数组是1，2，3，k=4,那么，需要1,3这两个数(应该是dp)</li><li>字符串反转，给定i work it,输出it work i</li><li>给一个数，例如1234，把这个数的所有数字排列，下一个比他大的数是1243,输出1243(被问很多次)</li><li>给一个数字，例如100,200,100,300,输出每个数下个比他大的数，复杂度要求o(n),例如，输出200，300，300，0(没有输出0)(栈))</li><li>给定{开始时间，结束时间}的一个数组，每个员工在这时间内工作，求最多多少人同时工作(按时间排序，遇见开始就加1，遇见结束减1)</li><li>矩阵连乘问题，求A1A2A3*..An的最小花费(算法导论经典题)</li><li>链表中间节点和扩展(找三分点之一位置，到数第n个节点)</li><li>空间n个点(xi,yi)，x,y&lt;1e8,求一个矩形内有多少个点,多次查询，(个人想法：将x坐标划分成sqrt(max(x))份，设sqrt(max(x))这个值为sqx,即0-sqx,sqx+1-2*sqx,以此类推，然后将每个区间按y值排序，设矩形左下坐标(x1,y1),右上坐标(x2,y2),找到x1和x2对应的区间，对应x1和x2这两个边界区间单独考虑，其余区间堆y1，y2分别使用二分)(RMQ问题)</li><li>((xy)z),将括号内字符反转，结果是zxy(栈))</li><li>求一个数平方根(牛顿法或者二分)</li></ol><h2 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h2><ol><li>局部性原理(空间和时间上的)</li><li>线程进程协程</li><li>共享内存实现(shget,shat,shctl等)</li><li>管层实现</li><li>fork</li><li>死锁，手写死锁</li><li>银行家算法</li><li>信号量应用，手写信号量实现</li><li>内核态线程和用户态</li><li>线程通信</li><li>进程通信</li></ol><h2 id="机算机网络"><a href="#机算机网络" class="headerlink" title="机算机网络"></a>机算机网络</h2><ol><li>https通信过程和加密算法</li><li>http1.0,http1.1,http2.0,http3.0</li><li>7层结构(应用层等等)</li><li>tcp三次握手四次挥手（被问无数次)</li><li>time_wait状态，close_wait状态</li><li>time_wait状态太多原因和怎么处理</li><li>close_wait状态太多原因</li><li>syn连接太多怎么办</li><li>tcp问什么3次握手(不是2次或者4次)和4次挥手</li><li>tcp和udp区别</li><li>get post区别</li><li>怎么设计稳定的udp(我是按tcp那一套来答得)</li><li>tcp nat穿孔</li><li>ping过程以及ping使用什么协议</li><li>tcp滑动窗口</li><li>tcp怎么保证稳定</li><li>tcp nagle粘包问题</li><li>tcp拥塞控制，慢开始和快重传</li><li>ARP协议</li><li>DDOS攻击</li><li>cookie欺骗</li></ol><h2 id="C-问题"><a href="#C-问题" class="headerlink" title="C++问题"></a>C++问题</h2><ol><li>volatile关键字</li><li>智能指针原理及实现</li><li>悬垂指针</li><li>异常相关(c++11 noexcept和之前throw的区别，为什么用noexcept)</li><li>c++11新特性有哪些</li><li>map实现(没看过源码，就没继续问了)</li></ol><h2 id="JVM问题"><a href="#JVM问题" class="headerlink" title="JVM问题"></a>JVM问题</h2><ol><li>gc算法</li><li>CMS和G1区别</li><li>java和c++区别，为什么java是解释性语言，c++编译性语言</li><li>新生代哪些情况进入老年代</li><li>调用system.gc()一定进行full gc吗</li><li>java内存区域</li><li>java内存模型和happen before原则</li><li>可达性分析法和引用计数，循环引用怎么解决</li><li>对象初始化过程</li></ol><h2 id="java多线程"><a href="#java多线程" class="headerlink" title="java多线程"></a>java多线程</h2><ol><li>volatile关键字原理</li><li>synchronized关键字原理</li><li>volatile关键字和synchronized区别</li><li>多线程原理，增长策略和饱和策略</li><li>消费者生产者代码</li><li>多线程种类</li><li>fork-join简介</li><li>三个线程同步代码</li></ol><h2 id="java基础"><a href="#java基础" class="headerlink" title="java基础"></a>java基础</h2><ol><li>lambda表达式优点</li><li>comparator和comparatable区别</li><li>string为什么是final</li><li>静态内部类和非静态内部类，匿名内部类</li><li>final用途</li><li>linkedlist和arraylist</li><li>实现简单的arraylist</li><li>范型T和通配符?区别</li><li>concurrenthashmap原理</li><li>hashmap原理</li><li>hashmap多线程出现哪些问题</li><li>equal和==区别</li></ol><h2 id="Mysql数据库"><a href="#Mysql数据库" class="headerlink" title="Mysql数据库"></a>Mysql数据库</h2><ol><li>优化问题，例如使用exist不使用in</li><li>count()和count(1)区别，count()计算null,count(1)不考虑</li><li>innodb和memory区别</li><li>数据库实现数据结构（B+树)</li><li>B+树优点，为什么不使用B树，平衡二叉树,红黑树</li><li>B+树B是什么(Balance)</li><li>索引有哪些</li><li>怎么建立索引</li><li>索引有哪些优点</li><li>左前缀问题,给一个语句问是否使用索引，哪些走索引</li><li>主从复制读写分离原理</li><li>分库分表</li><li>怎么设计一个数据库，类似mysql,考虑哪些方面</li><li>数据库特性(ACID)</li><li>数据库事务种类</li><li>间隙锁，MVCC,next-key锁</li><li>数据库封锁协议</li><li>limit优化问题（例如，select * from table1 limit 10000,100;</li><li>给定学生成绩表，找出前三名成绩</li></ol><h2 id="Redis数据库"><a href="#Redis数据库" class="headerlink" title="Redis数据库"></a>Redis数据库</h2><ol><li>redis单线程原因</li><li>redis数据结构</li><li>zset实现原理</li><li>缓存击穿，缓存穿透，缓存雪崩</li><li>主从复制读写分离</li><li>哨兵模式</li><li>redis和mysql之间缓存一致性</li></ol><hr><p>作者：选牌<br>链接：<a href="https://leetcode-cn.com/circle/article/OZEuMd/">https://leetcode-cn.com/circle/article/OZEuMd/</a><br>来源：力扣（LeetCode）<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问答 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树的遍历算法</title>
      <link href="2020/01/30/%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86%E7%AE%97%E6%B3%95/"/>
      <url>2020/01/30/%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><pre><code>对于二叉树中的任何一个节点而言，它都有两个角色需要扮演，一个是作为值存储的角色（角色1），另一个角色是作为它所带领的子树的一个代表（角色2）。而我们设置的bool变量，就是为了说明我当前拿到的这个节点，应该是以一个值存储的这种角色对待它(True)，还是应该以一个子树的代表这种角色对待它（False），如果是前者，那么就简单的将其所存储的值打印出来，如果是后者，我们需要继续探索由它带领的子树。作者：liu-yong-4链接：https://leetcode-cn.com/problems/two-sum/solution/xian-xu-zhong-xu-hou-xu-de-fei-di-gui-ban-ben-by-l/来源：力扣（LeetCode）著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</code></pre><h2 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h2><h3 id="前序"><a href="#前序" class="headerlink" title="前序"></a>前序</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Definition for a binary tree node.</span><br><span class="line"># class TreeNode:</span><br><span class="line">#     def __init__(self, x):</span><br><span class="line">#         self.val = x</span><br><span class="line">#         self.left = None</span><br><span class="line">#         self.right = None</span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    <span class="function">def <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[<span class="keyword">int</span>]:</span></span><br><span class="line"><span class="function">        res </span>=[]</span><br><span class="line">        stack = [] #must have</span><br><span class="line">        <span class="keyword">if</span> root:</span><br><span class="line">            stack = [(root,False)]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node,visited= stack.pop()</span><br><span class="line">            <span class="keyword">if</span>  visited:</span><br><span class="line">                res.append(node.val)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    stack.append([node.right,False])</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    stack.append([node.left,False])</span><br><span class="line">                stack.append([node,True]) #前序</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h3 id="中序"><a href="#中序" class="headerlink" title="中序"></a>中序</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Definition for a binary tree node.</span><br><span class="line"># class TreeNode:</span><br><span class="line">#     def __init__(self, x):</span><br><span class="line">#         self.val = x</span><br><span class="line">#         self.left = None</span><br><span class="line">#         self.right = None</span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    <span class="function">def <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[<span class="keyword">int</span>]:</span></span><br><span class="line"><span class="function">        res </span>=[]</span><br><span class="line">        stack = [] #must have</span><br><span class="line">        <span class="keyword">if</span> root:</span><br><span class="line">            stack = [(root,False)]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node,visited= stack.pop()</span><br><span class="line">            <span class="keyword">if</span>  visited:</span><br><span class="line">                res.append(node.val)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    stack.append([node.right,False])</span><br><span class="line">                stack.append([node,True])            #中序</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    stack.append([node.left,False])</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h3 id="后序"><a href="#后序" class="headerlink" title="后序"></a>后序</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Definition for a binary tree node.</span><br><span class="line"># class TreeNode:</span><br><span class="line">#     def __init__(self, x):</span><br><span class="line">#         self.val = x</span><br><span class="line">#         self.left = None</span><br><span class="line">#         self.right = None</span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    <span class="function">def <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[<span class="keyword">int</span>]:</span></span><br><span class="line"><span class="function">        res </span>=[]</span><br><span class="line">        stack = [] #must have</span><br><span class="line">        <span class="keyword">if</span> root:</span><br><span class="line">            stack = [(root,False)]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node,visited= stack.pop()</span><br><span class="line">            <span class="keyword">if</span>  visited:</span><br><span class="line">                res.append(node.val)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                stack.append([node,True])     #后序</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    stack.append([node.right,False])</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    stack.append([node.left,False])</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="N叉树"><a href="#N叉树" class="headerlink" title="N叉树"></a>N叉树</h2><h3 id="前序-1"><a href="#前序-1" class="headerlink" title="前序"></a>前序</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, val, children):</span></span><br><span class="line"><span class="string">        self.val = val</span></span><br><span class="line"><span class="string">        self.children = children</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">class Solution:</span><br><span class="line">    <span class="function">def <span class="title">preorder</span><span class="params">(self, root: <span class="string">&#x27;Node&#x27;</span>)</span> -&gt; List[<span class="keyword">int</span>]:</span></span><br><span class="line"><span class="function">        res </span>=[]</span><br><span class="line">        stack = [] #must have</span><br><span class="line">        <span class="keyword">if</span> root:</span><br><span class="line">            stack = [(root,False)]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node,visited= stack.pop()</span><br><span class="line">            <span class="keyword">if</span>  visited:</span><br><span class="line">                res.append(node.val)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                for child in node.children[::-1]: #逆向进孩子。</span><br><span class="line">                    stack.append([child,False])</span><br><span class="line">                stack.append([node,True])          #前序</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h3 id="后序-1"><a href="#后序-1" class="headerlink" title="后序"></a>后序</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, val, children):</span></span><br><span class="line"><span class="string">        self.val = val</span></span><br><span class="line"><span class="string">        self.children = children</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">class Solution:</span><br><span class="line">    <span class="function">def <span class="title">preorder</span><span class="params">(self, root: <span class="string">&#x27;Node&#x27;</span>)</span> -&gt; List[<span class="keyword">int</span>]:</span></span><br><span class="line"><span class="function">        res </span>=[]</span><br><span class="line">        stack = [] #must have</span><br><span class="line">        <span class="keyword">if</span> root:</span><br><span class="line">            stack = [(root,False)]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node,visited= stack.pop()</span><br><span class="line">            <span class="keyword">if</span>  visited:</span><br><span class="line">                res.append(node.val)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                stack.append([node,True])          #后序</span><br><span class="line">                for child in node.children[::-1]: #逆向进孩子。</span><br><span class="line">                    stack.append([child,False])</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><hr><p>作者：keyianpai<br>链接：<a href="https://leetcode-cn.com/circle/article/JLcnF0/">https://leetcode-cn.com/circle/article/JLcnF0/</a><br>来源：力扣（LeetCode）<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 算法题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问答 </tag>
            
            <tag> programing </tag>
            
            <tag> 算法 </tag>
            
            <tag> 树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编辑距离</title>
      <link href="2020/01/30/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/"/>
      <url>2020/01/30/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="详见"><a href="#详见" class="headerlink" title="详见"></a>详见</h2><p><a href="https://leetcode-cn.com/circle/article/rY3PIQ/">https://leetcode-cn.com/circle/article/rY3PIQ/</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 算法题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问答 </tag>
            
            <tag> programing </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>滑动窗口算法</title>
      <link href="2020/01/30/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%AE%97%E6%B3%95/"/>
      <url>2020/01/30/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="详见"><a href="#详见" class="headerlink" title="详见"></a>详见</h2><p><a href="https://www.zhihu.com/topic/20746237/intro">https://www.zhihu.com/topic/20746237/intro</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 算法题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问答 </tag>
            
            <tag> programing </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>哑节点的妙用</title>
      <link href="2020/01/30/%E5%93%91%E8%8A%82%E7%82%B9%E7%9A%84%E5%A6%99%E7%94%A8/"/>
      <url>2020/01/30/%E5%93%91%E8%8A%82%E7%82%B9%E7%9A%84%E5%A6%99%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>哑节点是在处理与链表相关的操作时，设置在链表头之前的指向链表头的节点，用于简化与链表头相关的操作。</p><h2 id="问题引入"><a href="#问题引入" class="headerlink" title="问题引入"></a>问题引入</h2><p>在刷leetcode时，遇到了删除链表的倒数第N个节点的问题。这个问题并不复杂，对于有一定编程经验的人来说，答题者很快就能想到使用双指针法来解决这一问题：<br>两个指针都指向链表头部，然后一个指针先向后跳n个节点，然后两个指针同时沿链表向后跳，当第一个指针指向最后一个节点时，另外一个指针指向的就是需要被删除的节点。</p><p>初始代码</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    ListNode next;</span><br><span class="line">    ListNode(<span class="keyword">int</span> x) &#123; val = x; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">removeNthFromEnd</span><span class="params">(ListNode head, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        ListNode n1=head;</span><br><span class="line">        ListNode n2=head;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">            n1=n1.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(n1.next!=<span class="keyword">null</span>) &#123;</span><br><span class="line">            n1=n1.next;</span><br><span class="line">            n2=n2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        n2.next=n2.next.next;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>对于普通的测试样例（即不涉及头尾操作的样例），这种写法都可以通过。</p><p>但是当我面对操作头节点的问题时，代码就无法通过测试了。<br>例如：我们一共有四个节点，需要删除倒数第四个节点。<br>因为当我们删除了头节点的时候，我们用什么来返回链表呢？</p><h2 id="哑节点妙用"><a href="#哑节点妙用" class="headerlink" title="哑节点妙用"></a>哑节点妙用</h2><p>在经过各种复杂的尝试之后，我还是解决了这个问题，一种方法是我需要定义更多的节点来指向各种各样的特殊位置，另一种方法就是不使用原链表，对原链表进行复制，逐个添加进新链表。这两种方法具体写起来都比较复杂。<br>在看答案之后，我发现答案引入了哑节点，其实也就是在我最初的代码上进行很小的修改，就完美解决了问题：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">removeNthFromEnd</span><span class="params">(ListNode head, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    ListNode dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    dummy.next = head;</span><br><span class="line">    ListNode first = dummy;</span><br><span class="line">    ListNode second = dummy;</span><br><span class="line">    <span class="comment">// Advances first pointer so that the gap between first and second is n nodes apart</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        first = first.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Move first to the end, maintaining the gap</span></span><br><span class="line">    <span class="keyword">while</span> (first != <span class="keyword">null</span>) &#123;</span><br><span class="line">        first = first.next;</span><br><span class="line">        second = second.next;</span><br><span class="line">    &#125;</span><br><span class="line">    second.next = second.next.next;</span><br><span class="line">    <span class="keyword">return</span> dummy.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>上述代码作者：LeetCode<br>链接：<a href="https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/solution/shan-chu-lian-biao-de-dao-shu-di-nge-jie-dian-by-l/">https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/solution/shan-chu-lian-biao-de-dao-shu-di-nge-jie-dian-by-l/</a><br>来源：力扣（LeetCode）<br>以上代码就是在我的代码的基础上添加了dummy节点，用于指向head节点，完美解决了头节点的操作问题。</p><p>版权声明：本文为CSDN博主「Terminator ld」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/weixin_44388094/article/details/100929840">https://blog.csdn.net/weixin_44388094/article/details/100929840</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 算法题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> programing </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis使用</title>
      <link href="2020/01/29/Mybatis%E4%BD%BF%E7%94%A8/"/>
      <url>2020/01/29/Mybatis%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="foreach-使用"><a href="#foreach-使用" class="headerlink" title="foreach 使用"></a>foreach 使用</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>foreach简单介绍：foreach的主要用在构建in条件中，它可以在SQL语句中进行迭代一个集合。<br>foreach元素的属性主要有item，index，collection，open，separator，close。</p><ul><li>item表示集合中每一个元素进行迭代时的别名，</li><li>index指定一个名字，用于表示在迭代过程中，每次迭代到的位置，</li><li>open表示该语句以什么开始，</li><li>separator表示在每次进行迭代之间以什么符号作为分隔符，</li><li>close表示以什么结束，</li><li>collection属性是在使用foreach的时候最关键的也是最容易出错的，该属性是必须指定的，但是在不同情况下，该属性的值是不一样的，主要有一下3种情况：<ul><li>如果传入的是单参数且参数类型是一个List的时候，collection属性值为list .</li><li>如果传入的是单参数且参数类型是一个array数组的时候，collection的属性值为array .</li><li>如果传入的参数是多个的时候，我们就需要把它们封装成一个Map了，当然单参数也可以封装成map，实际上如果你在传入参数的时候，在MyBatis里面也是会把它封装成一个Map的，map的key就是参数名，所以这个时候collection属性值就是传入的List或array对象在自己封装的map里面的key.</li></ul></li></ul><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>Entity</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employees</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> Integer employeeId;  </span><br><span class="line">    <span class="keyword">private</span> String firstName;  </span><br><span class="line">    <span class="keyword">private</span> String lastName;  </span><br><span class="line">    <span class="keyword">private</span> String email;  </span><br><span class="line">    <span class="keyword">private</span> String phoneNumber;  </span><br><span class="line">    <span class="keyword">private</span> Date hireDate;  </span><br><span class="line">    <span class="keyword">private</span> String jobId;  </span><br><span class="line">    <span class="keyword">private</span> BigDecimal salary;  </span><br><span class="line">    <span class="keyword">private</span> BigDecimal commissionPct;  </span><br><span class="line">    <span class="keyword">private</span> Integer managerId;  </span><br><span class="line">    <span class="keyword">private</span> Short departmentId;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>Mapper</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeesMapper</span> </span>&#123; </span><br><span class="line">    <span class="function">List&lt;Employees&gt; <span class="title">getEmployeesListParams</span><span class="params">(List&lt;String&gt; employeeIds)</span></span>;</span><br><span class="line">    <span class="function">List&lt;Employees&gt; <span class="title">getEmployeesArrayParams</span><span class="params">(String[] employeeIds)</span></span>;</span><br><span class="line">    <span class="function">List&lt;Employees&gt; <span class="title">getEmployeesMapParams</span><span class="params">(Map&lt;String,Object&gt; params)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>XML</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--List:forech中的collection属性类型是List,collection的值必须是:list,item的值可以随意,Dao接口中参数名字随意 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmployeesListParams&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Employees&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from EMPLOYEES e</span><br><span class="line">    where e.EMPLOYEE_ID in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;employeeId&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        #&#123;employeeId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;!--Array:forech中的collection属性类型是array,collection的值必须是:list,item的值可以随意,Dao接口中参数名字随意 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmployeesArrayParams&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Employees&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from EMPLOYEES e</span><br><span class="line">    where e.EMPLOYEE_ID in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;array&quot;</span> <span class="attr">item</span>=<span class="string">&quot;employeeId&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        #&#123;employeeId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;!--Map:不单单forech中的collection属性是map.key,其它所有属性都是map.key,比如下面的departmentId --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmployeesMapParams&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Employees&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from EMPLOYEES e</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;departmentId!=null and departmentId!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            e.DEPARTMENT_ID=#&#123;departmentId&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;employeeIdsArray!=null and employeeIdsArray.length!=0&quot;</span>&gt;</span></span><br><span class="line">            AND e.EMPLOYEE_ID in</span><br><span class="line">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;employeeIdsArray&quot;</span> <span class="attr">item</span>=<span class="string">&quot;employeeId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">                #&#123;employeeId&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 编程随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring and Spring MVC 总结</title>
      <link href="2020/01/29/Spring&amp;SpringMVC%E6%80%BB%E7%BB%93/"/>
      <url>2020/01/29/Spring&amp;SpringMVC%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="为什么使用Spring"><a href="#为什么使用Spring" class="headerlink" title="为什么使用Spring"></a>为什么使用Spring</h2><ol><li>方便解耦，简化开发<br> 通过Spring提供的IoC容器，可以将对象之间的依赖关系交由Spring进行控制，避免硬编码所造成的过度程序耦合。</li><li>AOP编程的支持<br> 通过Spring提供的AOP功能，方便进行面向切面的编程，如性能监测、事务管理、日志记录等。</li><li>声明式事务的支持</li><li>方便集成各种优秀框架</li><li>降低Java EE API的使用难度<br> 如对JDBC，JavaMail，远程调用等提供了简便封装</li></ol><h2 id="什么是IoC，为什使用IoC"><a href="#什么是IoC，为什使用IoC" class="headerlink" title="什么是IoC，为什使用IoC"></a>什么是IoC，为什使用IoC</h2><p>IoC全称Iversion of Controller，控制反转。<br>这概念是说你不用创建对象，而只需要描述它如何被创建。你不在代码里直接组装你的组件和服务，但是要在配置文件里描述哪些组件需要哪些服务，之后一个容器（IOC容器）负责把他们组装起来。<br>它能指导我们如何设计出松耦合、更优良的程序。</p><h2 id="什么是AOP，为什么使用AOP"><a href="#什么是AOP，为什么使用AOP" class="headerlink" title="什么是AOP，为什么使用AOP"></a>什么是AOP，为什么使用AOP</h2><p>AOP全称：Aspect-Oriented Programming，面向切面编程。<br>AOP，面向切面编程，就是把可重用的功能提取出来，然后将这些通用功能在合适的时候织入到应用程序中，比如事务管理、权限控制、日志记录、性能统计等。<br>AOP并没有帮助我们解决任何新的问题，它只是提供了一种更好的办法，能够用更少的工作量来解决现有的一些问题，使得系统更加健壮，可维护性更好。</p><h2 id="什么是Spring的事务管理"><a href="#什么是Spring的事务管理" class="headerlink" title="什么是Spring的事务管理"></a>什么是Spring的事务管理</h2><p>事务就是对一系列的数据库操作（比如插入多条数据）进行统一的提交或回滚操作，如果插入成功，那么一起成功，如果中间有一条出现异常，那么回滚之前的所有操作。这样可以防止出现脏数据，防止数据库数据出现问题。<br>开发中为了避免这种情况一般都会进行事务管理。<br>Spring的声明式事务通常是指在配置文件中对事务进行配置声明，其中包括了很多声明属性，它是通过Spring Proxy帮你做代理，自己不用额外的写代码，只要在Spring配置文件中声明即可；通常用在数据库的操作里面；<br>编程式事务就是指通过硬编码的方式做事务处理，这种处理方式需要写代码，事务中的逻辑可以自己定制；可以是数据库的东东，也可以是其他的操作。<br>Spring中也有自己的事务管理机制，一般是使用TransactionMananger进行管理，可以通过Spring的注入来完成此功能。</p><h2 id="Spring框架支持以下五种bean的作用域"><a href="#Spring框架支持以下五种bean的作用域" class="headerlink" title="Spring框架支持以下五种bean的作用域"></a>Spring框架支持以下五种bean的作用域</h2><ul><li>singleton<br>  默认值，bean在每个Spring ioc 容器中只有一个实例。</li><li>prototype<br>  一个bean的定义可以有多个实例。</li><li>request<br>  每次http请求都会创建一个bean，该作用域仅在基于web的Spring ApplicationContext情形下有效。 </li><li>session<br>  在一个HTTP Session中，一个bean定义对应一个实例。该作用域仅在基于web的Spring ApplicationContext情形下有效。</li><li>global-session<br>  在一个全局的HTTP Session中，一个bean定义对应一个实例。该作用域仅在基于web的Spring ApplicationContext情形下有效。</li><li><h2 id="什么是Spring的MVC框架"><a href="#什么是Spring的MVC框架" class="headerlink" title="什么是Spring的MVC框架"></a>什么是Spring的MVC框架</h2></li></ul><p>Spring 配备构建Web 应用的全功能MVC框架。Spring可以很便捷地和其他MVC框架集成，如Struts，Spring 的MVC框架用控制反转把业务对象和控制逻辑清晰地隔离。它也允许以声明的方式把请求参数和业务对象绑定。<br>spring mvc是一个基于mvc的web框架。spring mvc是spring框架的一个模块，springmvc和spring无需通过中间整合层进行整合。</p><h2 id="如何启用注解"><a href="#如何启用注解" class="headerlink" title="如何启用注解"></a>如何启用注解</h2><p><code>&lt;context:annotation-config/&gt;</code><br>如果使用<code>&lt;context:component-scan base-package=&quot;com.tgb.web.controller.annotation&quot;&gt; &lt;/context:component-scan&gt;</code> 则上面内容可以省略 </p><h2 id="Spring-MVC的请求流程"><a href="#Spring-MVC的请求流程" class="headerlink" title="Spring MVC的请求流程"></a>Spring MVC的请求流程</h2><ul><li>第一步：发起请求到前端控制器(DispatcherServlet)</li><li>第二步：前端控制器请求HandlerMapping查找Handler可以根据xml配置、注解进行查找</li><li>第三步：处理器映射器HandlerMapping向前端控制器返回Handler</li><li>第四步：前端控制器调用处理器适配器去执行Handler</li><li>第五步：处理器适配器去执行Handler</li><li>第六步：Handler执行完成给适配器返回ModelAndView</li><li>第七步：处理器适配器向前端控制器返回ModelAndView。ModelAndView是springmvc框架的一个底层对象，包括 Model和view</li><li>第八步：前端控制器请求视图解析器去进行视图解析，根据逻辑视图名解析成真正的视图(jsp)</li><li>第九步：视图解析器向前端控制器返回View</li><li>第十步：前端控制器进行视图渲染。视图渲染将模型数据(在ModelAndView对象中)填充到request域</li><li>第十一步：前端控制器向用户响应结果</li></ul><h2 id="web-xml的配置"><a href="#web-xml的配置" class="headerlink" title="web.xml的配置"></a>web.xml的配置</h2><h2 id="注解的处理器映射器和适配器"><a href="#注解的处理器映射器和适配器" class="headerlink" title="注解的处理器映射器和适配器"></a>注解的处理器映射器和适配器</h2><p>spring3.1之后使用<code>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping</code>注解映射器。<br>在spring3.1之后使用<code>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter</code>注解适配器。<br>使用<code>mvc:annotation-driven</code>代替上边注解映射器和注解适配器配置</p><h2 id="spring-与-mybatis整合过程"><a href="#spring-与-mybatis整合过程" class="headerlink" title="spring 与 mybatis整合过程"></a>spring 与 mybatis整合过程</h2><ul><li>第一步：整合dao层<br>  mybatis和spring整合，通过spring管理mapper接口。<br>  使用mapper的扫描器自动扫描mapper接口在spring中进行注册。</li><li>第二步：整合service层<br>  通过spring管理 service接口。<br>  使用配置方式将service接口配置在spring配置文件中。<br>  实现事务控制。</li><li>第三步：整合springmvc<br>  由于springmvc是spring的模块，不需要整合。<br>  主要配置有：<ul><li>mybatis配置文件sqlMapConfig.xml配置别名自动扫描(实体类)</li><li>mapper扫描器(接口，数据库访问接口)</li><li>数据库连接池配置</li><li>声明式事务配置</li><li>启用注解扫描：<code>&lt;context:component-scan base-package=&quot;cn.itcast.ssm.controller&quot;&gt;&lt;/context:component-scan&gt;</code></li><li>配置注解映射器和适配器： <code>&lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt;</code></li><li>视图解析器：<code>&lt;bean  class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</code></li><li>配置控制类： DispatcherServlet前端控制器</li><li>配置spring配置文件加载类：ClassLoadListener</li></ul></li></ul><h2 id="sqlMapConfig-xml"><a href="#sqlMapConfig-xml" class="headerlink" title="sqlMapConfig.xml"></a>sqlMapConfig.xml</h2><h2 id="配置数据源"><a href="#配置数据源" class="headerlink" title="配置数据源"></a>配置数据源</h2><h2 id="事务控制"><a href="#事务控制" class="headerlink" title="事务控制"></a>事务控制</h2><p>(applicationContext-transaction.xml)，在applicationContext-transaction.xml中使用spring声明式事务控制方法。</p><h2 id="加载spring配置"><a href="#加载spring配置" class="headerlink" title="加载spring配置"></a>加载spring配置</h2><h2 id="静态资源访问不被拦截："><a href="#静态资源访问不被拦截：" class="headerlink" title="静态资源访问不被拦截："></a>静态资源访问不被拦截：</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/resources/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/resources/&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/images/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/images/&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/js/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/js/&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id="RequestMapping的作用"><a href="#RequestMapping的作用" class="headerlink" title="@RequestMapping的作用"></a>@RequestMapping的作用</h2><ul><li>url映射</li><li>窄化请求映射</li><li>限制http请求方法</li></ul><h2 id="controller方法的返回值"><a href="#controller方法的返回值" class="headerlink" title="controller方法的返回值"></a>controller方法的返回值</h2><ul><li>返回ModelAndView<br>  需要方法结束时，定义ModelAndView，将model和view分别进行设置。 </li><li>返回string<br>  表示返回逻辑视图名。真正视图(jsp路径)=前缀+逻辑视图名+后缀<br>  redirect重定向：返回字符串格式为：”redirect:queryItem.action”<br>  forward页面转发：返回字符串格式为：“forward:queryItem.action”</li><li>返回void<br>  在controller方法形参上可以定义request和response，使用request或response指定响应结果：<ul><li>使用request转向页面，如下：request.getRequestDispatcher(“页面路径”).forward(request, response);</li><li>也可以通过response页面重定向：response.sendRedirect(“url”)</li><li>也可以通过response指定响应结果，例如响应json数据如下：  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">response.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">response.getWriter().write(<span class="string">&quot;json串&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="参数绑定："><a href="#参数绑定：" class="headerlink" title="参数绑定："></a>参数绑定：</h2></li></ul></li></ul><ol><li>默认支持的类型<br> 直接在controller方法形参上定义下边类型的对象，就可以使用这些对象。在参数绑定过程中，如果遇到下边类型直接进行绑定。<ul><li>HttpServletRequest：通过request对象获取请求信息</li><li>HttpServletResponse：通过response处理响应信息</li><li>HttpSession：通过session对象得到session中存放的对象</li><li>Model/ModelMap：model是一个接口，modelMap是一个接口实现 。作用：将model数据填充到request域。</li></ul></li><li>简单类型<br> 通过@RequestParam对简单类型的参数进行绑定。<br> 如果不使用@RequestParam，要求request传入参数名称和controller方法的形参名称一致，方可绑定成功。<br> 如果使用@RequestParam，不用限制request传入参数名称和controller方法的形参名称一致。<br> 通过required属性指定参数是否必须要传入，如果设置为true，没有传入参数，会报错。</li><li>pojo绑定<br> 页面中input的name和controller的pojo形参中的属性名称一致，将页面中数据绑定到pojo。(usename,age；不需要user.username,user.age)</li><li>自定义参数绑定实现日期类型绑定<br> 对于controller形参中pojo对象，如果属性中有日期类型，需要自定义参数绑定。将请求日期数据串转成 日期类型，要转换的日期类型和pojo中日期属性的类型保持一致。</li></ol><h2 id="Spring-MVC-和-Struts2-对比"><a href="#Spring-MVC-和-Struts2-对比" class="headerlink" title="Spring MVC 和 Struts2 对比"></a>Spring MVC 和 Struts2 对比</h2><ol><li>Struts2是类级别的拦截， 一个类对应一个request上下文，SpringMVC是方法级别的拦截，一个方法对应一个request上下文，而方法同时又跟一个url对应，所以说从架构本身上SpringMVC 就容易实现restful url</li><li>由上边原因，SpringMVC的方法之间基本上独立的，独享request response数据，请求数据通过参数获取，处理结果通过ModelMap交回给框架，方法之间不共享变量，而Struts2搞的就比较乱，虽然方法之间也是独立的，但其所有Action变量是共享的，这不会影响程序运行，却给我们编码 读程序时带来麻烦，每次来了请求就创建一个Action，一个Action对象对应一个request上下文。</li><li>由于Struts2需要针对每个request进行封装，把request，session等servlet生命周期的变量封装成一个一个Map，供给每个Action使用，并保证线程安全，所以在原则上，是比较耗费内存的。</li><li>SpringMVC集成了Ajax，使用非常方便，只需一个注解@ResponseBody就可以实现，然后直接返回响应文本即可，而Struts2拦截器集成了Ajax，在Action中处理时一般必须安装插件或者自己写代码集成进去，使用起来也相对不方便。</li><li>springmvc面向方法开发的（更接近service接口的开发方式），struts2面向类开发。</li><li>springmvc可以单例开发，struts2只能是多例开发。</li></ol><h2 id="乱码处理"><a href="#乱码处理" class="headerlink" title="乱码处理"></a>乱码处理</h2><ol><li>post乱码<br> 在web.xml添加post乱码filter：CharacterEncodingFilter</li><li>对于get请求中文参数出现乱码解决方法有两个：<ul><li>修改tomcat配置文件添加编码与工程编码一致，如下：<br>  <code>&lt;Connector URIEncoding=&quot;utf-8&quot; connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot;/&gt;</code></li><li>对参数进行重新编码：<br>  String userName = new  String(request.getParamter(“userName”).getBytes(“ISO8859-1”),”utf-8”)<br>  ISO8859-1是tomcat默认编码，需要将tomcat编码后的内容按utf-8编码</li></ul></li></ol><h2 id="集合类型绑定"><a href="#集合类型绑定" class="headerlink" title="集合类型绑定"></a>集合类型绑定</h2><ol><li>数组绑定：<br> controller方法参数使用：(Integer[] itemId)<br> 页面统一使用:itemId 作为name</li><li>list绑定：<br> pojo属性名为：itemsList<br> 页面：<code>itemsList[index].属性名</code></li><li>map 绑定：<br> pojo属性名为：<code>Map&lt;String, Object&gt; itemInfo = new HashMap&lt;String, Object&gt;(); </code><br> 页面： <code>&lt;td&gt;</code>姓名：<code>&lt;inputtype=&quot;text&quot;name=&quot;itemInfo[&#39;name&#39;]&quot;/&gt;</code></li></ol><h2 id="spring-校验"><a href="#spring-校验" class="headerlink" title="spring 校验"></a>spring 校验</h2><ol><li>项目中，通常使用较多是前端的校验，比如页面中js校验。对于安全要求较高点建议在服务端进行校验。</li><li>springmvc使用hibernate的校验框架validation(和hibernate没有任何关系)。<br> 校验思路：页面提交请求的参数，请求到controller方法中，使用validation进行校验。如果校验出错，将错误信息展示到页面。</li></ol><h2 id="数据回显"><a href="#数据回显" class="headerlink" title="数据回显"></a>数据回显</h2><ul><li><code>@ModelAttribute</code>还可以将方法的返回值传到页面：在方法上加注解<code>@ModelAttribute</code></li><li>使用最简单方法使用model，可以不用<code>@ModelAttribute：model.addAttribute(&quot;id&quot;, id);</code></li><li>springmvc默认对pojo数据进行回显。pojo数据传入controller方法后，springmvc自动将pojo数据放到request域，key等于pojo类型（首字母小写）</li><li><code>public String testParam(PrintWriter out, @RequestParam(&quot;username&quot;) String username) &#123; //out直接输出&#125;</code></li></ul><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>springmvc提供全局异常处理器（一个系统只有一个异常处理器）进行统一异常处理。<br>系统遇到异常，在程序中手动抛出，dao抛给service、service给controller、controller抛给前端控制器，前端控制器调用全局异常处理器。</p><h2 id="上传图片"><a href="#上传图片" class="headerlink" title="上传图片"></a>上传图片</h2><ol><li>在页面form中提交<code>enctype=&quot;multipart/form-data&quot;</code>的数据时，需要springmvc对multipart类型的数据进行解析。</li><li>在springmvc.xml中配置multipart类型解析器。</li><li>方法中使用：MultipartFile attach (单个文件上传) 或者  MultipartFile[] attachs (多个文件上传)</li></ol><h2 id="Json处理"><a href="#Json处理" class="headerlink" title="Json处理"></a>Json处理</h2><ol><li>加载json转换的jar包：springmvc中使用jackson的包进行json转换（<code>@requestBody</code>和<code>@responseBody</code>使用下边的包进行json转）</li><li>配置json转换器。在注解适配器RequestMappingHandlerAdapter中加入messageConverters。如果使用<code>&lt;mvc:annotation-driven /&gt;</code> 则会自动加入。</li><li>ajax</li><li>Controller (ResponseBody、RequestBody)</li><li>注意ajax中contentType如果不设置为json类型，则传的参数为key/value类型。上面设置后，传的是json类型。<br> 详见：<a href="http://www.cnblogs.com/Jtianlin/p/5224885.html">http://www.cnblogs.com/Jtianlin/p/5224885.html</a></li></ol><h2 id="拦截器："><a href="#拦截器：" class="headerlink" title="拦截器："></a>拦截器：</h2><ol><li>定义拦截器，实现HandlerInterceptor接口。接口中提供三个方法。<br> a. preHandle ：进入 Handler方法之前执行，用于身份认证、身份授权，比如身份认证，如果认证通过表示当前用户没有登陆，需要此方法拦截不再向下执行<br> b. postHandle：进入Handler方法之后，返回modelAndView之前执行，应用场景从modelAndView出发：将公用的模型数据(比如菜单导航)在这里传到视图，也可以在这里统一指定视图<br> c. afterCompletion：执行Handler完成执行此方法，应用场景：统一异常处理，统一日志处理</li><li>拦截器配置：<br> a. 针对HandlerMapping配置(不推荐)：springmvc拦截器针对HandlerMapping进行拦截设置，如果在某个HandlerMapping中配置拦截，经过该 HandlerMapping映射成功的handler最终使用该 拦截器。(一般不推荐使用)<br> b. 类似全局的拦截器：springmvc配置类似全局的拦截器，springmvc框架将配置的类似全局的拦截器注入到每个HandlerMapping中<h2 id="如何启用注解："><a href="#如何启用注解：" class="headerlink" title="如何启用注解："></a>如何启用注解：</h2></li></ol><p><code>&lt;context:annotation-config/&gt;</code><br>如果使用<code>&lt;context:component-scan base-package=&quot;com.tgb.web.controller.annotation&quot;&gt; &lt;/context:component-scan&gt;</code> 则上面内容可以省略<br>使用<code>mvc:annotation-driven</code>代替注解映射器和注解适配器配置</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 框架学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring </tag>
            
            <tag> 问答 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>书签整理</title>
      <link href="2020/01/29/000_%E4%B9%A6%E7%AD%BE%E6%95%B4%E7%90%86/"/>
      <url>2020/01/29/000_%E4%B9%A6%E7%AD%BE%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="工具集"><a href="#工具集" class="headerlink" title="工具集"></a>工具集</h2><h3 id="对照表"><a href="#对照表" class="headerlink" title="对照表"></a>对照表</h3><ul><li><a href="http://tool.oschina.net/commons">HTTP Content-type</a></li><li><a href="http://tool.oschina.net/commons?type=5">HTTP状态码详解</a></li><li><a href="http://tool.oschina.net/commons?type=4">ASCII码</a></li><li><a href="http://tool.oschina.net/commons?type=3">RGB颜色</a></li><li><a href="http://tool.oschina.net/commons?type=2">HTML转义字符</a></li><li><a href="http://tool.oschina.net/commons?type=7">TCP/UDP常见端口</a></li><li><a href="http://tool.oschina.net/commons?type=8">网页常用字体参考</a></li></ul><h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><ul><li><a href="https://www.staticfile.org/">Staticfile CDN</a></li><li><a href="http://www.bootcdn.cn/">Bootstrap中文网开源项目</a></li><li><a href="https://cdnjs.com/">The best FOSS CDN</a></li></ul><h3 id="数据分析平台"><a href="#数据分析平台" class="headerlink" title="数据分析平台"></a>数据分析平台</h3><ul><li><a href="https://tongji.baidu.com/web/welcome/login">百度统计</a></li><li><a href="https://zhugeio.com/">诸葛iO</a></li><li><a href="http://www.umeng.com/">友盟</a></li><li><a href="https://www.talkingdata.com/">TalkingData</a></li><li><a href="http://mta.qq.com/">腾讯移动分析</a></li></ul><h3 id="文字识别"><a href="#文字识别" class="headerlink" title="文字识别"></a>文字识别</h3><ul><li><a href="https://cloud.tencent.com/act/event/ocrdemo">腾讯</a></li><li><a href="http://ai.baidu.com/tech/ocr/general">百度</a></li></ul><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul><li><a href="http://www.network-science.de/ascii/">文字转ASCII</a></li><li><a href="https://www.baidufe.com/fehelper">百度前端助手</a></li><li><a href="https://carbon.now.sh/">代码图片值作Carbon</a></li><li><a href="http://www.styb.cn/cms/ieee_754.php">单精度浮点数转换 IEEE 754</a></li><li><a href="http://tool.chinaz.com/tools/unicode.aspx">站长工具-编码解码</a></li><li><a href="https://www.reg007.com/">注册过的网站 REG007</a></li><li><a href="https://login.teamviewer.com/">TeamViewer Management Console</a></li><li><a href="https://www.processon.com/">ProcessOn</a></li><li><a href="https://mail.protonmail.com/">ProtonMail</a></li><li><a href="http://sourcegear.com/diffmerge/downloaded.php">DiffMerge</a></li><li><a href="http://www.c-lodop.com/index.html">Lodop</a></li><li><a href="http://www.stats.gov.cn/tjsj/tjbz/tjypflml/">国家统计局&gt;&gt;统计用产品分类目录</a></li></ul><h2 id="教程集"><a href="#教程集" class="headerlink" title="教程集"></a>教程集</h2><h3 id="c"><a href="#c" class="headerlink" title="c"></a>c</h3><h3 id="css-less-scss"><a href="#css-less-scss" class="headerlink" title="css/less/scss"></a>css/less/scss</h3><h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><ul><li><a href="https://docs.docker.com/">官网</a></li><li><a href="https://yeasy.gitbooks.io/docker_practice/content/">Docker 从入门到实践</a></li></ul><h3 id="java基础"><a href="#java基础" class="headerlink" title="java基础"></a>java基础</h3><h3 id="kubernetes-k8s"><a href="#kubernetes-k8s" class="headerlink" title="kubernetes/k8s"></a>kubernetes/k8s</h3><ul><li><a href="https://kubernetes.io/">官网</a></li><li><a href="https://www.kubernetes.org.cn/">中文社区</a></li></ul><h3 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h3><ul><li><a href="https://wangchujiang.com/linux-command/">Linux 命令搜索引擎</a></li></ul><h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><ul><li><p><a href="https://mermaid-js.github.io/mermaid/#/">mermaid</a></p></li><li><p><a href="https://www.dazhuanlan.com/2019/10/16/5da67e8a17798/">Hexo 的 markdown-it 渲染引擎和其相关插件</a></p><h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3></li><li><p><a href="https://mvnrepository.com/">maven 仓库</a></p></li></ul><h3 id="mybatis"><a href="#mybatis" class="headerlink" title="mybatis"></a>mybatis</h3><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><ul><li><a href="http://tengine.taobao.org/book/index.html">Nginx开发从入门到精通</a></li><li><a href="https://www.nginx.com/blog/introducing-the-nginx-microservices-reference-architecture/">Introducing the Microservices Reference Architecture from NGINX</a></li></ul><h3 id="oracle"><a href="#oracle" class="headerlink" title="oracle"></a>oracle</h3><ul><li><a href="https://blog.csdn.net/xiaoyu19910321/article/details/89856514">安装教程</a></li></ul><h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><ul><li><a href="https://www.liaoxuefeng.com/wiki/1016959663602400">廖雪峰</a></li><li><a href="https://docs.python.org/3/library/functions.html">python3 内建函数</a></li></ul><h3 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h3><h3 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h3><ul><li><a href="http://jkorpela.fi/http.html">Quick reference to HTTP headers</a></li><li><a href="http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html">互联网协议入门（一）阮一峰</a></li><li><a href="http://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html">互联网协议入门（二）阮一峰</a></li></ul><h3 id="Tensorflow"><a href="#Tensorflow" class="headerlink" title="Tensorflow"></a>Tensorflow</h3><ul><li><a href="http://www.tensorfly.cn/">中文社区</a></li></ul><h3 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h3><ul><li><a href="https://blog.csdn.net/YaoDeBiAn/article/details/80001406">Tomcat数据源</a></li><li><a href="https://www.w3cschool.cn/tomcat/5y2t1k9g.html">Tomcat 8 权威指南</a></li></ul><h3 id="TypeScript-ES6"><a href="#TypeScript-ES6" class="headerlink" title="TypeScript/ES6"></a>TypeScript/ES6</h3><ul><li><a href="https://ts.xcatliu.com/">TypeScript 入门教程</a></li><li><a href="https://zhongsp.gitbooks.io/typescript-handbook/content/">TypeScript Handbook（中文版）</a></li><li><a href="https://jkchao.github.io/typescript-book-chinese/">《TypeScript Deep Dive》 深入理解TypeScript</a></li></ul><h3 id="工作流"><a href="#工作流" class="headerlink" title="工作流"></a>工作流</h3><ul><li><a href="https://www.activiti.org/userguide/">Activiti User Guide</a></li><li><a href="http://www.mossle.com/docs/activiti/index.html">Activiti 5.16 用户手册</a></li><li><a href="https://waylau.gitbooks.io/activiti-5-x-user-guide/">Activiti 5.x User Guide 《Activiti 5.x 用户指南》中文翻译</a></li></ul><h3 id="规则引擎"><a href="#规则引擎" class="headerlink" title="规则引擎"></a>规则引擎</h3><ul><li><a href="https://www.drools.org/">Drools官网</a></li><li><a href="http://www.drools.org.cn/">Drools中文网</a></li></ul><h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><ul><li>Redis<ul><li><a href="https://www.redis.net.cn/">官网</a></li><li><a href="http://redisdoc.com/">命令参考</a></li></ul></li><li>MemoryCache</li></ul><h3 id="全文搜索引擎"><a href="#全文搜索引擎" class="headerlink" title="全文搜索引擎"></a>全文搜索引擎</h3><ul><li><a href="https://blog.csdn.net/csdnYF/article/details/79286792">使用 ElasticSearch6.0 快速实现全文搜索功能</a></li><li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html">ElasticSearch权威指南</a></li></ul><h3 id="前端框架"><a href="#前端框架" class="headerlink" title="前端框架"></a>前端框架</h3><ul><li>VUE<ul><li><a href="https://cn.vuejs.org/v2/guide/">VUE DOC</a></li><li><a href="https://uniapp.dcloud.io/frame">UNI-APP</a></li></ul></li><li>移动端框架<ul><li><a href="https://youzan.github.io/vant/#/zh-CN/quickstart#rem-gua-pei">VANT</a></li></ul></li><li>小程序<ul><li><a href="https://youzan.github.io/vant-weapp/#/intro">Vant Weapp UI 组件库</a></li><li><a href="https://github.com/wechat-miniprogram/miniprogram-cli">miniprogram-cli</a></li><li><a href="https://www.jianshu.com/p/5fdcdf478ec8">微信小程序版本自动更新</a></li></ul></li></ul><h3 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h3><h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><ul><li>练习<ul><li><a href="https://leetcode-cn.com/">LeetCode</a></li></ul></li><li>题解/学习<ul><li><a href="https://www.cs.usfca.edu/~galles/visualization/RedBlack.html">红黑树动画</a></li></ul></li></ul><h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><ul><li><a href="https://junit.org/junit5/docs/current/user-guide/">JUnit 5</a></li><li><a href="http://jmock.org/index.html">jMock</a></li></ul><h3 id="压测"><a href="#压测" class="headerlink" title="压测"></a>压测</h3><ul><li><a href="https://www.cnblogs.com/imyalost/p/7062784.html">JMeter</a></li></ul><h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><ul><li>前端框架<ul><li><a href="https://github.com/PanJiaChen/vue-element-admin">Vue Element Admin</a></li></ul></li><li>后端框架<ul><li><a href="https://docs.jumpserver.org/zh/docs/introduce.html">Jumpserver开源堡垒机</a></li><li><a href="http://dubbo.apache.org/zh-cn/">Apache Dubbo</a></li></ul></li><li>微服务架构<ul><li><a href="https://www.nginx.com/blog/introducing-the-nginx-microservices-reference-architecture/">Introducing the Microservices Reference Architecture from NGINX</a> </li><li><a href="https://docshome.gitbooks.io/microservices/">微服务：从设计到部署</a></li></ul></li><li>日志框架</li><li>数据分析</li></ul><h3 id="管理"><a href="#管理" class="headerlink" title="管理"></a>管理</h3><ul><li>软件架构模式<ul><li><a href="http://ifeve.com/software-architecture-patterns/">第一章分层架构（上）</a></li><li><a href="http://ifeve.com/%e8%bd%af%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f-%e7%ac%ac%e4%b8%80%e7%ab%a0%e5%88%86%e5%b1%82%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f2/">第一章分层架构（下）</a></li><li><a href="http://ifeve.com/%e8%bd%af%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f-%e7%ac%ac%e4%ba%8c%e7%ab%a0%e4%ba%8b%e4%bb%b6%e9%a9%b1%e5%8a%a8%e6%9e%b6%e6%9e%84%e4%b8%8a/">第二章事件驱动架构(上)</a></li><li><a href="http://ifeve.com/%e8%bd%af%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f-%e7%ac%ac%e4%ba%8c%e7%ab%a0%e4%ba%8b%e4%bb%b6%e9%a9%b1%e5%8a%a8%e6%9e%b6%e6%9e%84%e4%b8%8b/">第二章事件驱动架构(下)</a></li><li><a href="http://ifeve.com/%e3%80%8a%e8%bd%af%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f%e3%80%8b-%e7%ac%ac%e4%b8%89%e7%ab%a0-%e5%be%ae%e5%86%85%e6%a0%b8%e7%b3%bb%e7%bb%9f%e7%bb%93%e6%9e%84/">第三章 微内核系统结构</a></li><li><a href="http://ifeve.com/%e3%80%8a%e8%bd%af%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f%e3%80%8b-%e7%ac%ac%e5%9b%9b%e7%ab%a0-%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%a1%86%e6%9e%b6%e6%a8%a1%e5%bc%8f%ef%bc%88%e4%b8%8a%ef%bc%89/">第四章 微服务框架模式（上）</a></li><li><a href="http://ifeve.com/%e3%80%8a%e8%bd%af%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%a8%a1%e5%bc%8f%e3%80%8b-%e7%ac%ac%e5%9b%9b%e7%ab%a0-%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%a1%86%e6%9e%b6%e6%a8%a1%e5%bc%8f%ef%bc%88%e4%b8%8b%ef%bc%89/">第四章 微服务框架模式（下）</a></li></ul></li></ul><h3 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h3><ul><li><a href="https://cyc2018.github.io/CS-Notes/">技术面必备的基础知识</a></li></ul><h3 id="资源下载"><a href="#资源下载" class="headerlink" title="资源下载"></a>资源下载</h3><h2 id="学习站点"><a href="#学习站点" class="headerlink" title="学习站点"></a>学习站点</h2><ul><li><a href="http://academictorrents.com/">Academic Torrents</a></li><li><a href="http://www.programcreek.com/">ProgramCreek</a></li><li><a href="https://pintia.cn/problem-sets">PTA</a></li><li><a href="https://classroom.udacity.com/me">Udacity</a></li><li><a href="https://www.icourse163.org/">中国大学MOOC</a></li><li><a href="https://www.oschina.net/">开源中国</a></li><li><a href="http://www.icourses.cn/home/">爱课程</a></li><li><a href="https://www.nowcoder.com/">牛客网</a></li><li><a href="https://www.coursera.org/">Coursera 课程</a></li><li><a href="https://stackoverflow.com/">Stack Overflow</a></li><li><a href="https://coolshell.cn/">酷壳</a></li></ul><h2 id="文献论文"><a href="#文献论文" class="headerlink" title="文献论文"></a>文献论文</h2><ul><li><a href="https://www.engineeringvillage.com/search/quick.url">Engineering Village</a></li><li><a href="https://link.springer.com/">Springer</a></li><li><a href="http://search.sciencemag.org/">Search Science</a></li><li><a href="http://www.wanfangdata.com.cn/index.html">万方数据知识服务平台</a></li><li><a href="https://www.nstl.gov.cn/">国家科技图书文献中心</a></li><li><a href="https://www.cnki.net/">中国知网</a></li><li><a href="http://aelab.net/">aedraw</a></li><li><a href="http://www.bzfxw.com/">学兔兔</a></li></ul><h2 id="UML-收集"><a href="#UML-收集" class="headerlink" title="UML 收集"></a>UML 收集</h2><ul><li><a href="https://www.processon.com/view/595daf26e4b068b0a241f7c2">财务组织</a></li><li><a href="https://www.processon.com/view/59e981a4e4b00842bddfbf65">电商购物支付流程中的支付结果回调处理流程</a></li><li><a href="https://www.processon.com/view/57357c30e4b0c102ad31b565">高性能MySQL总结</a></li><li><a href="https://www.processon.com/view/598e8a1ee4b0b83fa25e0445">工作常用辅助IT工具</a></li><li><a href="https://www.processon.com/view/5b03d1c6e4b01f32972b8b1e">管理员状态图</a></li><li><a href="https://www.processon.com/view/5b8f2a70e4b0d4d65bf6411c">互联网+政务服务技术体系建设指南</a></li><li><a href="https://www.processon.com/view/5a0d3b61e4b06c8e1091e2a7">互联网产品迭代反馈团队协作流程</a></li><li><a href="https://www.processon.com/view/54abbb84e4b0f90534fd0e49">计算机网络</a></li><li><a href="https://www.processon.com/view/5aa8b855e4b0a84684038ef7">技术架构</a></li><li><a href="https://www.processon.com/view/54bf441de4b0c7bde4e59403">架构图</a></li><li><a href="https://www.processon.com/view/590993c8e4b056fe6425a3a1">平台高可用小集</a></li><li><a href="https://www.processon.com/view/5a9cff92e4b04b1b69015a00">平台架构图</a></li><li><a href="https://www.processon.com/view/57ecb680e4b0300f4fbccadf#map">前端</a></li><li><a href="https://www.processon.com/view/5b691580e4b053a09c2823ee">身份认证方案</a></li><li><a href="https://www.processon.com/view/5a2654c6e4b0f3a79866ac4b">数据驱动</a></li><li><a href="https://www.processon.com/view/5afcdff3e4b02ec429d29d65">推送系统结构</a></li><li><a href="https://www.processon.com/view/58ba81bce4b0bb529f2428db">微服务</a></li><li><a href="https://www.processon.com/view/5b431563e4b00b08ad1306ba">微服务部署与监控运维架构图 </a></li><li><a href="https://www.processon.com/view/5bf51ecfe4b0f012f22bf240">微服务架构+DevOps</a></li><li><a href="https://www.processon.com/view/5a4c3d51e4b078cf1edacfe9">微机原理</a></li><li><a href="https://www.processon.com/view/5719ec36e4b005d06ff488de">微商城SAAS数据库表结构-公共功能业务</a></li><li><a href="https://www.processon.com/view/598d14a4e4b01618aacfe247">微信聊天原型图</a></li><li><a href="https://www.processon.com/view/5be10c0fe4b05aadb7d04072">物联网云平台架构设计</a></li><li><a href="https://www.processon.com/view/57862934e4b0a94dc24bbfe7">系统架构图</a></li><li><a href="https://www.processon.com/view/5a91170ce4b0615ac05e89f4">系统架构图1</a></li><li><a href="https://www.processon.com/view/59a681fde4b063c756f94ca0">系统框架图2</a></li><li><a href="https://www.processon.com/view/5aa63460e4b0d77c8a850fbb">业务流程</a></li><li><a href="https://www.processon.com/view/5a1be580e4b0b3ee0574811e">用户登录时序图</a></li><li><a href="https://www.processon.com/view/5a4ae442e4b0be852db6c490">用户画像系统架构设计</a></li><li><a href="https://www.processon.com/view/583e280de4b0e742e4524505">云架构图</a></li><li><a href="https://www.processon.com/view/5a77f599e4b059c41ab54de4">云平台系统架构图</a></li><li><a href="https://www.processon.com/view/5a8f6beae4b0874437cbee46">政务系统拓扑图</a></li><li><a href="https://www.processon.com/view/58e4541be4b0a2c5b1218349">Dubbo</a></li><li><a href="https://www.processon.com/view/587c6bf9e4b087b115ed5538">ERP结构图 总</a></li><li><a href="https://www.processon.com/view/5bc73d4ce4b0bd4db968ae41">ERP系统登录流程</a></li><li><a href="https://www.processon.com/view/59d9aa93e4b017b4197a15fe">IM 客户端架构 |</a></li><li><a href="https://www.processon.com/view/5ab09e3ae4b0e93533935bcc">Java架构师技术栈</a></li><li><a href="https://www.processon.com/view/59e874a6e4b0b640aeeca4ac">Linux命令</a></li><li><a href="https://www.processon.com/view/5993b471e4b06df7265b49c6">Mybatis架构源码分析流程</a></li><li><a href="https://www.processon.com/view/57b856d9e4b03e7bd5b0d74e">MySQL</a></li><li><a href="https://www.processon.com/view/5b16331be4b03f9d250f3183">spring cloud 微服务</a></li><li><a href="https://www.processon.com/view/5797120ae4b0683474301869">TCP正常状态变迁图 </a></li><li><a href="https://www.processon.com/view/534cc3ee0cf236ef7e6265cd">WebChat Routing Logic</a></li><li><a href="https://www.processon.com/view/59f43b0de4b0d53d97919482">webview架构图</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 文档记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 书签 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>书单</title>
      <link href="2020/01/29/000_%E4%B9%A6%E5%8D%95/"/>
      <url>2020/01/29/000_%E4%B9%A6%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<h2 id="计算机"><a href="#计算机" class="headerlink" title="计算机"></a>计算机</h2><table><thead><tr><th>科目</th><th>最佳书籍</th><th>最佳视频</th></tr></thead><tbody><tr><td>分布式系统</td><td>《分布式系统原理与范型》（中文第二版，英文第三版）</td><td></td></tr><tr><td>操作系统</td><td>《操作系统导论》</td><td>Berkeley CS 162</td></tr><tr><td>数学知识</td><td>《计算机科学中的数学》</td><td>Tom Leighton’s MIT 6.042J</td></tr><tr><td>数据库</td><td>《Readings in Database Systems》 （暂无中译本）</td><td>Joe Hellerstein’s Berkeley CS 186</td></tr><tr><td>算法与数据结构</td><td>《算法设计手册》</td><td>Steven Skiena’s lectures</td></tr><tr><td>编程</td><td>《计算机程序的构造和解释》</td><td>Brian Harvey’s Berkeley CS 61A</td></tr><tr><td>编程语言与编译器</td><td>《编译原理》</td><td>Alex Aiken’s course on Lagunita</td></tr><tr><td>计算机架构</td><td>《计算机组成与设计》</td><td>Berkeley CS 61C</td></tr><tr><td>计算机网络</td><td>《计算机网络：自顶向下方法》</td><td>Stanford CS 144</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 文档记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 书单 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日志文件分割定期删除处理</title>
      <link href="2020/01/29/%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%88%86%E5%89%B2%E5%AE%9A%E6%9C%9F%E5%88%A0%E9%99%A4%E5%A4%84%E7%90%86/"/>
      <url>2020/01/29/%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%88%86%E5%89%B2%E5%AE%9A%E6%9C%9F%E5%88%A0%E9%99%A4%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="分割、删除-N-天前日志"><a href="#分割、删除-N-天前日志" class="headerlink" title="分割、删除 N 天前日志"></a>分割、删除 N 天前日志</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">DIR=日志地址</span><br><span class="line">d=`date +%Y%m%d`</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$DIR</span></span><br><span class="line">cp catalina.out catalina.out.bak<span class="variable">$&#123;d&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; catalina.out</span><br><span class="line"></span><br><span class="line">find ./ -mtime +7 -name <span class="string">&quot;catalina.out.bak*&quot;</span> -<span class="built_in">exec</span> rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure><h2 id="添加定时任务"><a href="#添加定时任务" class="headerlink" title="添加定时任务"></a>添加定时任务</h2><p>将auto_clean.sh执行脚本加入到系统计划任务，到点自动执行</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p>输入：</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">59 23 * * * /opt/soft/log/auto_clean.sh &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>这里的设置是每天23点59分执行auto_clean.sh文件进行数据清理任务了。</p>]]></content>
      
      
      <categories>
          
          <category> 文档记录 </category>
          
          <category> 运维脚本 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bash </tag>
            
            <tag> 运维 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>增广贤文</title>
      <link href="2020/01/29/%E5%A2%9E%E5%B9%BF%E8%B4%A4%E6%96%87/"/>
      <url>2020/01/29/%E5%A2%9E%E5%B9%BF%E8%B4%A4%E6%96%87/</url>
      
        <content type="html"><![CDATA[<p>昔时贤文，诲汝谆谆，集韵增文，多见多闻。<br>观今宜鉴古，无古不成今。<br>知己知彼，将心比心。<br>酒逢知己饮，诗向会人吟。<br>相识满天下，知心能几人。<br>相逢好似初相识，到老终无怨恨心。<br>近水知鱼性，近山识鸟音。<br>易涨易退山溪水，易反易覆小人心。<br>运去金成铁，时来铁似金，读书须用意，一字值千金。<br>逢人且说三分话，未可全抛一片心。<br>有意栽花花不发，无心插柳柳成阴。<br>画虎画皮难画骨，知人知面不知心。<br>钱财如粪土，仁义值千金。<br>流水下滩非有意，白云出岫本无心。<br>当时若不登高望，谁信东流海洋深。<br>路遥知马力，事久见人心。<br>两人一般心，无钱堪买金，一人一般心，有钱难买针。<br>相见易得好，久住难为人。<br>马行无力皆因瘦，人不风流只为贫。<br>饶人不是痴汉，痴汉不会饶人。<br>是亲不是亲，非亲却是亲。<br>美不美，乡中水，亲不亲，故乡人。<br>莺花犹怕春光老，岂可教人枉度春。<br>相逢不饮空归去，洞口桃花也笑人。<br>红粉佳人休使老，风流浪子莫教贫。<br>在家不会迎宾客，出外方知少主人。<br>黄金无假，阿魏无真。<br>客来主不顾，应恐是痴人。<br>贫居闹市无人问，富在深山有远亲。<br>谁人背后无人说，哪个人前不说人。<br>有钱道真语，无钱语不真。<br>不信但看筵中酒，杯杯先劝有钱人。<br>闹里有钱，静处安身。<br>来如风雨，去似微尘。<br>长江后浪推前浪，世上新人赶旧人。<br>近水楼台先得月，向阳花木早逢春。<br>莫道君行早，更有早行人。<br>莫信直中直，须防仁不仁。<br>山中有直树，世上无直人。<br>自恨枝无叶，莫怨太阳偏。<br>大家都是命，半点不由人。<br>一年之计在于春，一日之计在于寅，一家之计在于和，一生之计在于勤。<br>责人之心责己，恕己之心恕人。<br>守口如瓶，防意如城。<br>宁可人负我，切莫我负人。<br>再三须慎意，第一莫欺心。<br>虎生犹可近，人熟不堪亲。<br>来说是非者，便是是非人。<br>远水难救近火，远亲不如近邻。<br>有茶有酒多兄弟，急难何曾见一人。<br>人情似纸张张薄，世事如棋局局新。<br>山中也有千年树，世上难逢百岁人。<br>力微休负重，言轻莫劝人。<br>无钱休入众，遭难莫寻亲。<br>平生莫作皱眉事，世上应无切齿人。<br>士者国之宝，儒为席上珍。<br>若要断酒法，醒眼看醉人。<br>求人须求大丈夫，济人须济急时无。<br>渴时一滴如甘露，醉后添杯不如无。<br>久住令人贱，频来亲也疏。<br>酒中不语真君子，财上分明大丈夫。<br>出家如初，成佛有余。<br>积金千两，不如明解经书。<br>养子不教如养驴，养女不教如养猪。<br>有田不耕仓廪虚，有书不读子孙愚。<br>仓廪虚兮岁月乏，子孙愚兮礼义疏。<br>同君一席话，胜读十年书。<br>人不通今古，马牛如襟裾。<br>茫茫四海人无数，哪个男儿是丈夫。<br>白酒酿成缘好客，黄金散尽为收书。<br>救人一命，胜造七级浮屠。<br>城门失火，殃及池鱼。<br>庭前生瑞草，好事不如无。<br>欲求生富贵，须下死工夫。<br>百年成之不足，一旦败之有余。<br>人心似铁，官法如炉。<br>善化不足，恶化有余。<br>水太清则无鱼，人至察则无徒。<br>知者减半，省者全无。<br>在家由父，出家从夫。<br>痴人畏妇，贤女敬夫。<br>是非终日有，不听自然无。<br>宁可正而不足，不可邪而有余。<br>宁可信其有，不可信其无。<br>竹篱茅舍风光好，道院僧堂终不如。<br>命里有时终须有，命里无时莫强求。<br>道院迎仙客，书堂隐相儒。<br>庭栽栖凤竹，池养化龙鱼。<br>结交须胜己，似我不如无。<br>但看三五日，相见不如初。<br>人情似水分高下，世事如云任卷舒。<br>会说说都是，不会说无礼。<br>磨刀恨不利，刀利伤人指。<br>求财恨不得，财多害自己。<br>知足常足，终身不辱。<br>知止常止，终身不耻。<br>有福伤财，无福伤己。<br>差之毫厘，失之千里。<br>若登高必自卑，若涉远必自迩。<br>三思而行，再思可矣。<br>使口不如自走，求人不如求己。<br>小时是兄弟，长大各乡里。<br>妒财莫妒食，怨生莫怨死。<br>人见白头嗔，我见白头喜。<br>多少少年亡，不到白头死。<br>墙有逢，壁有耳。<br>好事不出门，恶事传千里。<br>贼是小人，知过君子。<br>君子固穷，小人穷斯滥也。<br>贫穷自在，富贵多忧。<br>不以我为德，反以我为仇。<br>宁向直中取，不可曲中求。<br>人无远虑，必有近忧。<br>知我者为我心忧，不知我者谓我何求。<br>晴天不肯去，只待雨淋头。<br>成事莫说，覆水难收。<br>是非只为多开口，烦恼皆因强出头。<br>忍得一时之气，免得百日之忧。<br>近来学得乌龟法，得缩头时且缩头。<br>惧法朝朝乐，欺公日日忧。<br>人生一世，草生一春。<br>黑发不知勤学早，看看又是白头翁。<br>月到十五光明少，人到中年万事休。<br>儿孙自有儿孙福，莫为儿孙作马牛。<br>人生不满百，常怀千岁忧。<br>今朝有酒今朝醉，明日愁来明日忧。<br>路逢险处难回避，事到头来不自由。<br>药能医假病，酒不解真愁。<br>人贫不语，水平不流。<br>一家有女百家求，一马不行百马忧。<br>有花方酌酒，无月不登楼。<br>三杯通大道，一醉解千愁。<br>深山毕竟藏猛虎，大海终须纳细流。<br>惜花须检点，爱月不梳头。<br>大抵选他肌骨好，不擦红粉也风流。<br>受恩深处宜先退，得意浓时便可休。<br>莫待是非来入耳，从前恩爱反为仇。<br>留得五湖明月在，不愁无处下金钩。<br>休别有鱼处，莫恋浅滩头。<br>去时终须去，再三留不住。<br>忍一句，息一怒，饶一着，退一步。<br>三十不豪，四十不富，五十将来寻死路。<br>生不论魂，死不认尸。<br>父母恩深终有别，夫妻义重也分离。<br>人生似鸟同林宿，大限来时各自飞。<br>人善被人欺，马善被人骑。<br>人无横财不富，马无野草不肥。<br>人恶人怕天不怕，人善人欺天不欺。<br>善恶到头终有报，只争来早与来迟。<br>黄河尚有澄清日，岂可人无得运时。<br>得宠思辱，安居虑危。<br>念念有如临敌日，心心常似过桥时。<br>英雄行险道，富贵似花枝。<br>人情莫道春光好，只怕秋来有冷时。<br>送君千里，终须一别。<br>但将冷眼看螃蟹，看你横行到几时。<br>见事莫说，问事不知。<br>闲事休管，无事早归。<br>假缎染就真红色，也被旁人说是非。<br>善事可作，恶事莫为。<br>许人一物，千金不移。<br>龙生龙子，虎生豹儿。<br>龙游浅水遭虾戏，虎落平阳被犬欺。<br>一举首登龙虎榜，十年身到风凰池。<br>十年窗下无人问，一举成名天下知。<br>酒债寻常行处有，人生七十古来稀。<br>养儿待老，积谷防饥。<br>鸡豚狗彘之畜，无失其时。<br>数家之口，可以无饥矣。<br>常将有日思无日，莫把无时当有时。<br>时来风送腾王阁，运去雷轰荐福碑。<br>入门休问荣枯事，观看容颜便得知。<br>官清书吏瘦，神灵庙祝肥。<br>息却雷霆之怒，罢却虎狼之威。<br>饶人算人之本，输人算人之机。<br>好言难得，恶语易施。<br>一言既出，驷马难追。<br>道吾好者是吾贼，道吾恶者是吾师。<br>路逢侠客须呈剑，不是才人莫献诗。<br>三人同行，必有我师，择其善者而从之，其不善者而改之。<br>少壮不努力，老大徒悲伤。<br>人有善愿，天必佑之。<br>莫饮卯时酒，昏昏醉到酉。<br>莫骂酉时妻，一夜受孤凄。<br>种麻得麻，种豆得豆。<br>天眼恢恢，疏而不漏。<br>见官莫向前，做客莫在后。<br>宁添一斗，莫添一口。<br>螳螂捕蝉，岂知黄雀在后。<br>不求金玉重重贵，但愿儿孙个个贤。<br>一日夫妻，百世姻缘。<br>百世修来同船渡，千世修来共枕眠。<br>杀人一万，自损三千。<br>伤人一语，利如刀割。<br>枯木逢春犹再发，人无两度再少年。<br>未晚先投宿，鸡鸣早看天。<br>将相胸前堪走马，公候肚里好撑船。<br>富人思来年，穷人思眼前。<br>世上若要人情好，赊去物件莫取钱。<br>死生有命，富贵在天。<br>击石原有火，不击乃无烟。<br>为学始知道，不学亦徒然。<br>莫笑他人老，终须还到老。<br>但能依本分，终须无烦恼。<br>君子爱财，取之有道。<br>贞妇爱色，纳之以礼。<br>善有善报，恶有恶报。<br>不是不报，日子不到。<br>人而无信，不知其可也。<br>一人道好，千人传实。<br>凡事要好，须问三老。<br>若争小可，便失大道。<br>年年防饥，夜夜防盗。<br>学者如禾如稻，不学者如蒿如草。<br>遇饮酒时须饮酒，得高歌处且高歌。<br>因风吹火，用力不多。<br>不因渔父引，怎得见波涛。<br>无求到处人情好，不饮从他酒价高。<br>知事少时烦恼少，识人多处是非多。<br>入山不怕伤人虎，只怕人情两面刀。<br>强中更有强中手，恶人须用恶人磨。<br>会使不在家豪富，风流不用着衣多。<br>光阴似箭，日月如梭。<br>天时不如地利，地利不如人和。<br>黄金未为贵，安乐值钱多。<br>世上万般皆下品，思量唯有读书高。<br>世间好语书说尽，天下名山僧占多。<br>为善最乐，为恶难逃。<br>羊有跪乳之恩，鸦有反哺之义。<br>你急他未急，人闲心不闲。<br>隐恶扬善，执其两端。<br>妻贤夫祸少，子孝父心宽。<br>既坠釜甑，反顾无益。<br>翻覆之水，收之实难。<br>人生知足何时足，人老偷闲且是闲。<br>但有绿杨堪系马，处处有路透长安。<br>见者易，学者难。<br>莫将容易得，便作等闲看。<br>用心计较般般错，退步思量事事难。<br>道路各别，养家一般。<br>从俭入奢易，从奢入俭难。<br>知音说与知音听，不是知音莫与弹。<br>点石化为金，人心犹未足。<br>信了肚，卖了屋。<br>他人观花，不涉你目。<br>他人碌碌，不涉你足。<br>谁人不爱子孙贤，谁人不爱千钟粟。<br>莫把真心空计较，五行不是这题目。<br>与人不和，劝人养鹅。<br>与人不睦，劝人架屋。<br>但行好事，莫问前程。<br>河狭水急，人急计生。<br>明知山有虎，莫向虎山行。<br>路不行不到，事不为不成。<br>人不劝不善，钟不打不鸣。<br>无钱方断酒，临老始看经。<br>点塔七层，不如暗处一灯。<br>万事劝人休瞒昧，举头三尺有神明。<br>但存方寸土，留与子孙耕。<br>灭却心头火，剔起佛前灯。<br>惺惺常不足，懵懵作公卿。<br>众星朗朗，不如孤月独明。<br>兄弟相害，不如自生。<br>合理可作，小利莫争。<br>牡丹花好空入目，枣花虽小结实成。<br>欺老莫欺小，欺人心不明。<br>随分耕锄收地利，他时饱满谢苍天。<br>得忍且忍，得耐且耐。<br>不忍不耐，小事成大。<br>相论逞英雄，家计渐渐退。<br>贤妇令夫贵，恶妇令夫败。<br>一人有庆，兆民咸赖。<br>人老心未老，人穷志莫穷。<br>人无千日好，花无百日红。<br>杀人可恕，情理难容。<br>乍富不知新受用，乍贫难改旧家风。<br>座上客常满，樽中酒不空。<br>屋漏更遭连年雨，行船又遇打头风。<br>笋因落箨方成竹，鱼为奔波始化龙。<br>记得少年骑竹马，看看又是白头翁。<br>礼义生于富足，盗贼出于贫穷。<br>天上众星皆拱北，世间无水不朝东。<br>君子安平，达人知命。<br>忠言逆耳利于行，良药苦口利于病。<br>顺天者存，逆天者亡。<br>人为财死，鸟为食亡。<br>夫妻相合好，琴瑟与笙簧。<br>有儿贫不久，无子富不长。<br>善必寿老，恶必早亡。<br>爽口食多偏作药，快心事过恐生殃。<br>富贵定要安本分，贫穷不必枉思量。<br>画水无风空作浪，绣花虽好不闻香。<br>贪他一斗米，失却半年粮。<br>争他一脚豚，反失一肘羊。<br>龙归晚洞云犹湿，麝过春山草木香。<br>平生只会量人短，何不回头把自量。<br>见善如不及，见恶如探汤。<br>人贫志短，马瘦毛长。<br>自家心里急，他人未知忙。<br>贫无达士将金赠，病有高人说药方。<br>触来莫与说，事过心清凉。<br>秋至满山多秀色，春来无处不花香。<br>凡人不可貌相，海水不可斗量。<br>清清之水，为土所防。<br>济济之士，为酒所伤。<br>蒿草之下，或有兰香。<br>茅茨之屋，或有侯王。<br>无限朱门生饿殍，几多白屋出卿。<br>醉后乾坤大，壶中日月长。<br>万事皆已定，浮生空白茫。<br>千里送毫毛，礼轻仁义重。<br>一人传虚，百人传实。<br>世事明如镜，前程暗似漆。<br>光阴黄金难买，一世如驹过隙。<br>良田万倾，日食一升。<br>大厦千间，夜眠八尺。<br>千经万典，孝义为先。<br>一字入公门，九牛拖不出。<br>衙门八字开，有理无钱莫进来。<br>富从升合起，贫因不算来。<br>家中无才子，官从何处来。<br>万事不由人计较，一生都是命安排。<br>急行慢行，前程只有多少路。<br>人间私语，天闻若雷。<br>暗室亏心，神目如电。<br>一毫之恶，劝人莫作。<br>一毫之善，与人方便。<br>欺人是祸，饶人是福。<br>天眼恢恢，报应甚速。<br>圣贤言语，神钦鬼伏。<br>人各有心，心各有见。<br>口说不如身逢，耳闻不如目见。<br>养军千日，用在一朝。<br>国清才子贵，家富小儿骄。<br>利刀割体痕易合，恶语伤人恨不消。<br>公道世间唯白发，贵人头上不曾饶。<br>有钱堪出众，无衣懒出门。<br>为官须作相，及第必争先。<br>苗从地发，树向枝分。<br>父子和而家不退，兄弟和而家不分。<br>官有正条，民有和约。<br>闲时不烧香，急时抱佛脚。<br>幸生太平无事日，恐逢年老不多时。<br>国乱思良将，家贫思贤妻。<br>池塘积水须防旱，田地勤耕足养家。<br>根深不怕风摇动，树正无愁月影斜。<br>奉劝君子，各宜守己。<br>只此程式，万无一失。</p>]]></content>
      
      
      <categories>
          
          <category> 文学摘录 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MySQL安装设置及常用命令</title>
      <link href="2020/01/29/MySQL%E5%AE%89%E8%A3%85%E8%AE%BE%E7%BD%AE%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>2020/01/29/MySQL%E5%AE%89%E8%A3%85%E8%AE%BE%E7%BD%AE%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="MySQL安装"><a href="#MySQL安装" class="headerlink" title="MySQL安装"></a>MySQL安装</h2><h3 id="linux下使用yum安装mysql"><a href="#linux下使用yum安装mysql" class="headerlink" title="linux下使用yum安装mysql"></a>linux下使用yum安装mysql</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>查看有没有安装过：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum list installed mysql*</span><br><span class="line">rpm -qa | grep mysql*</span><br></pre></td></tr></table></figure><p>查看有没有安装包：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum list mysql*</span><br></pre></td></tr></table></figure><p>安装mysql客户端：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install mysql</span><br></pre></td></tr></table></figure><p>安装mysql 服务器端：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install mysql-server</span><br><span class="line">yum install mysql-devel</span><br></pre></td></tr></table></figure><h4 id="启动-停止"><a href="#启动-停止" class="headerlink" title="启动\停止"></a>启动\停止</h4><p>数据库字符集设置</p>  <figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment">#mysql配置文件/etc/my.cnf中加入</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br></pre></td></tr></table></figure><p>启动mysql服务：</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service mysqld start</span><br><span class="line">/etc/init.d/mysqld start</span><br></pre></td></tr></table></figure><p>开机启动：</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chkconfig -add mysqld</span><br></pre></td></tr></table></figure><p>查看开机启动设置是否成功</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chkconfig --list | grep mysql*</span><br></pre></td></tr></table></figure><p>停止：</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service mysqld stop</span><br></pre></td></tr></table></figure><h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><p>创建root管理员：</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysqladmin -u root password 123456</span><br></pre></td></tr></table></figure><p>登录：</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p>忘记密码：</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service mysqld stop</span><br><span class="line">mysqld_safe --user=root --skip-grant-tables</span><br><span class="line">mysql -u root</span><br><span class="line">use mysql</span><br><span class="line">update user <span class="built_in">set</span> password=password(<span class="string">&quot;new_pass&quot;</span>) <span class="built_in">where</span> user=<span class="string">&quot;root&quot;</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h4 id="配置账户权限"><a href="#配置账户权限" class="headerlink" title="配置账户权限"></a>配置账户权限</h4><p>创建账户</p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;test&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br></pre></td></tr></table></figure><p>授权</p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> datebase_name.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;your_mysql_name&#x27;</span>@<span class="string">&#x27;your_client_host&#x27;</span>;</span><br></pre></td></tr></table></figure><p>刷新授权</p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h4 id="远程访问"><a href="#远程访问" class="headerlink" title="远程访问"></a>远程访问</h4><p>  开放防火墙的端口号<br>  mysql增加权限：mysql库中的user表新增一条记录host为“%”，user为“root”</p><h4 id="Linux-MySQL的几个重要目录"><a href="#Linux-MySQL的几个重要目录" class="headerlink" title="Linux MySQL的几个重要目录"></a>Linux MySQL的几个重要目录</h4><p>数据库目录</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/var/lib/mysql/</span><br></pre></td></tr></table></figure><p>配置文件</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/share /mysql</span><br></pre></td></tr></table></figure><p>相关命令</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/bin</span><br></pre></td></tr></table></figure><p>启动脚本</p>  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/etc/rc.d/init.d/</span><br></pre></td></tr></table></figure><h2 id="MySQL操作"><a href="#MySQL操作" class="headerlink" title="MySQL操作"></a>MySQL操作</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h3 id="启动、停止、重启"><a href="#启动、停止、重启" class="headerlink" title="启动、停止、重启"></a>启动、停止、重启</h3><h3 id="导入导出"><a href="#导入导出" class="headerlink" title="导入导出"></a>导入导出</h3><h3 id="修改root密码"><a href="#修改root密码" class="headerlink" title="修改root密码"></a>修改root密码</h3><ul><li><p><strong>方法1： 用SET PASSWORD命令</strong><br>首先登录MySQL。<br>格式：mysql&gt; set password for 用户名@localhost = password(‘新密码’);<br>例子：mysql&gt; set password for root@localhost = password(‘123’);</p></li><li><p><strong>方法2：用mysqladmin</strong><br>格式：mysqladmin -u用户名 -p旧密码 password 新密码<br>例子：mysqladmin -uroot -p123456 password 123</p></li><li><p><strong>方法3：用UPDATE直接编辑user表</strong><br>首先登录MySQL。<br>mysql&gt; use mysql;<br>mysql&gt; update user set password=password(‘123’) where user=’root’ and host=’localhost’;<br>mysql&gt; flush privileges;</p></li></ul><h2 id="Navicat"><a href="#Navicat" class="headerlink" title="Navicat"></a>Navicat</h2><h3 id="MySQL的表"><a href="#MySQL的表" class="headerlink" title="MySQL的表"></a>MySQL的表</h3><h3 id="MySQL的视图"><a href="#MySQL的视图" class="headerlink" title="MySQL的视图"></a>MySQL的视图</h3><h3 id="MySQL的函数"><a href="#MySQL的函数" class="headerlink" title="MySQL的函数"></a>MySQL的函数</h3><p>存储过程待学习</p><h3 id="MySQL的事件"><a href="#MySQL的事件" class="headerlink" title="MySQL的事件"></a>MySQL的事件</h3><h3 id="MySQL的报表"><a href="#MySQL的报表" class="headerlink" title="MySQL的报表"></a>MySQL的报表</h3><h3 id="MySQL的计划"><a href="#MySQL的计划" class="headerlink" title="MySQL的计划"></a>MySQL的计划</h3><h3 id="MySQL的备份"><a href="#MySQL的备份" class="headerlink" title="MySQL的备份"></a>MySQL的备份</h3><h3 id="MySQL的模型"><a href="#MySQL的模型" class="headerlink" title="MySQL的模型"></a>MySQL的模型</h3><h2 id="常见问题及处理办法"><a href="#常见问题及处理办法" class="headerlink" title="常见问题及处理办法"></a>常见问题及处理办法</h2><h3 id="Caused-by-java-sql-SQLException-Value-‘0000-00-00-00-00-00’-can-not-be-represented-as-java-sql-Timestamp"><a href="#Caused-by-java-sql-SQLException-Value-‘0000-00-00-00-00-00’-can-not-be-represented-as-java-sql-Timestamp" class="headerlink" title="Caused by: java.sql.SQLException: Value ‘0000-00-00 00:00:00’ can not be represented as java.sql.Timestamp"></a>Caused by: java.sql.SQLException: Value ‘0000-00-00 00:00:00’ can not be represented as java.sql.Timestamp</h3><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">#原因：因为数据库里面存储了这样子的值，所以查询的时候报错了</span></span><br><span class="line"><span class="comment">#解决方案：在url路径哪里加上一句话</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://ip地址:端口号/数据库?characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull</span></span><br></pre></td></tr></table></figure><h3 id="sql-mode-问题"><a href="#sql-mode-问题" class="headerlink" title="sql_mode 问题"></a>sql_mode 问题</h3><p>在 /etc/my.cnf中设置</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">sql_mode=</span><br></pre></td></tr></table></figure><h4 id="sql-mode常用值"><a href="#sql-mode常用值" class="headerlink" title="sql_mode常用值"></a>sql_mode常用值</h4><figure class="highlight"><table><tr><td class="code"><pre><span class="line">    ONLY_FULL_GROUP_BY</span><br><span class="line">对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的，因为列不在GROUP BY从句中。</span><br><span class="line"></span><br><span class="line">    NO_AUTO_VALUE_ON_ZERO</span><br><span class="line">该值影响自增长列的插入。默认设置下，插入0或NULL代表生成下一个自增长值。如果用户希望插入的值为0，该列又是自增长的，那么这个选项就有用了。</span><br><span class="line"></span><br><span class="line">    STRICT_TRANS_TABLES</span><br><span class="line">在该模式下，如果一个值不能插入到一个事务表中，则中断当前的操作，对非事务表不做限制</span><br><span class="line"></span><br><span class="line">    NO_ZERO_IN_DATE</span><br><span class="line">在严格模式下，不允许日期和月份为零</span><br><span class="line"></span><br><span class="line">    NO_ZERO_DATE</span><br><span class="line">设置该值，mysql数据库不允许插入零日期，插入零日期会抛出错误而不是警告。</span><br><span class="line"></span><br><span class="line">    ERROR_FOR_DIVISION_BY_ZERO</span><br><span class="line">在INSERT或UPDATE过程中，如果数据被零除，则产生错误而非警告。如 果未给出该模式，那么数据被零除时MySQL返回NULL</span><br><span class="line"></span><br><span class="line">    NO_AUTO_CREATE_USER</span><br><span class="line">禁止GRANT创建密码为空的用户</span><br><span class="line"></span><br><span class="line">    NO_ENGINE_SUBSTITUTION</span><br><span class="line">如果需要的存储引擎被禁用或未编译，那么抛出错误。不设置此值时，用默认的存储引擎替代，并抛出一个异常</span><br><span class="line"></span><br><span class="line">    PIPES_AS_CONCAT</span><br><span class="line">将&quot;||&quot;视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似</span><br><span class="line"></span><br><span class="line">    ANSI_QUOTES</span><br><span class="line">启用ANSI_QUOTES后，不能用双引号来引用字符串，因为它被解释为识别符</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 软件教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>同源策略和跨域访问的解决方案</title>
      <link href="2020/01/29/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%E5%92%8C%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>2020/01/29/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%E5%92%8C%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<pre><code>跨域是一个经常会遇到的问题，特别是有两个域名的时候，如你的页面在a.test.com，然后需要向b.test.com请求数据，这个时候就跨域了。如果直接请求，你会发现浏览器就报错了，这个时候，你就需要了解什么是同源策略。</code></pre><h2 id="什么是同源策略"><a href="#什么是同源策略" class="headerlink" title="什么是同源策略"></a>什么是同源策略</h2><p>理解跨域首先必须要了解同源策略。同源策略是浏览器上为安全性考虑实施的非常重要的安全策略。</p><h3 id="何谓同源？"><a href="#何谓同源？" class="headerlink" title="何谓同源？"></a>何谓同源？</h3><p>URL由协议、域名、端口和路径组成，如果两个URL的协议、域名和端口相同，则表示他们同源。</p><h3 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h3><p>浏览器的同源策略，限制了来自不同源的”document”或脚本，对当前”document”读取或设置某些属性。 （白帽子讲web安全[1]）： 从一个域上加载的脚本不允许访问另外一个域的文档属性。</p><p>举个例子：</p><pre><code>比如，一个恶意网站的页面通过iframe嵌入了银行的登录页面（二者不同源），如果没有同源限制，恶意网页上的javascript脚本就可以在用户登录银行的时候获取用户名和密码。</code></pre><p>在浏览器中，<code>&lt;script&gt;</code>、<code>&lt;img&gt;</code>、<code>&lt;iframe&gt;</code>、<code>&lt;link&gt;</code>等标签都可以加载跨域资源，而不受同源限制，但浏览器限制了JavaScript的权限使其不能读、写加载的内容。另外同源策略只对网页的HTML文档做了限制，对加载的其他静态资源如javascript、css、图片等仍然认为属于同源。</p><p>代码示例：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- http://localhost:8080/test.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>test same origin policy<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:8081/test2.html&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span>  </span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">&quot;test&quot;</span>).contentDocument.body.innerHTML = <span class="string">&quot;write somthing&quot;</span>;  </span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>  </span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- http://localhost:8081/test2.html   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>test same origin policy<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">        Testing.  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>  </span><br></pre></td></tr></table></figure><p>在Firefox中会得到如下错误：</p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line">Error: Permission denied to access property &#x27;body&#x27;</span><br></pre></td></tr></table></figure><p>Document对象的domain属性存放着装载文档的服务器的主机名，可以设置它。<br>例如来自”blog.csdn.net”和来自”bbs.csdn.net”的页面，都将document.domain设置为”csdn.net”，则来自两个子域名的脚本即可相互访问。<br>出于安全的考虑，不能设置为其他主domain，比如<code>http://www.csdn.net/不能设置为sina.com</code>。</p><h2 id="Ajax跨域跨域"><a href="#Ajax跨域跨域" class="headerlink" title="Ajax跨域跨域"></a>Ajax跨域跨域</h2><p>Ajax (XMLHttpRequest)请求受到同源策略的限制。<br>Ajax通过XMLHttpRequest能够与远程的服务器进行信息交互，另外XMLHttpRequest是一个纯粹的Javascript对象，这样的交互过程，是在后台进行的，用户不易察觉。<br>因此，XMLHTTP实际上已经突破了原有的Javascript的安全限制。</p><p>举个例子：</p><pre><code>假设某网站引用了其它站点的javascript，这个站点被compromise并在javascript中加入获取用户输入并通过ajax提交给其他站点，这样就可以源源不断收集信息。或者某网站因为存在漏洞导致XSS注入了javascript脚本，这个脚本就可以通过ajax获取用户信息并通过ajax提交给其他站点，这样就可以源源不断收集信息。</code></pre><p>如果我们又想利用XMLHTTP的无刷新异步交互能力，又不愿意公然突破Javascript的安全策略，可以选择的方案就是给XMLHTTP加上严格的同源限制。<br>这样的安全策略，很类似于Applet的安全策略。IFrame的限制还仅仅是不能访问跨域HTMLDOM中的数据，而XMLHTTP则根本上限制了跨域请求的提交。（实际上下面提到了CORS已经放宽了限制）</p><h2 id="Ajax的跨域技术"><a href="#Ajax的跨域技术" class="headerlink" title="Ajax的跨域技术"></a>Ajax的跨域技术</h2><h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><pre><code>JSONP（JSON with Padding：填充式JSON)，应用JSON的一种新方法，JSON、JSONP的区别：1. JSON返回的是一串数据、JSONP返回的是脚本代码(包含一个函数调用)2. JSONP 只支持get请求、不支持post请求(类似往页面添加一个script标签，通过src属性去触发对指定地址的请求,故只能是Get请求)</code></pre><p>JSONP技术实际和Ajax没有关系。我们知道<code>&lt;script&gt;</code>标签可以加载跨域的javascript脚本，并且被加载的脚本和当前文档属于同一个域。<br>因此在文档中可以调用/访问脚本中的数据和函数。如果javascript脚本中的数据是动态生成的，那么只要在文档中动态创建<code>&lt;script&gt;</code>标签就可以实现和服务端的数据交互。<br>JSONP就是利用<code>&lt;script&gt;</code>标签的跨域能力实现跨域数据的访问，请求动态生成的JavaScript脚本同时带一个callback函数名作为参数。<br>其中callback函数本地文档的JavaScript函数，服务器端动态生成的脚本会产生数据，并在代码中以产生的数据为参数调用callback函数。<br>当这段脚本加载到本地文档时，callback函数就被调用。<br>第一个站点的测试页面（<code>http://localhost:8080/test.html</code>）：  </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;http://localhost:8081/test_data.js&quot;</span>&gt;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test_handler</span>(<span class="params">data</span>) </span>&#123;  </span><br><span class="line">        <span class="built_in">console</span>.log(data);  </span><br><span class="line">    &#125;  </span><br><span class="line">&lt;/script&gt;  </span><br></pre></td></tr></table></figure><p>服务器端的Javascript脚本（<code>http://localhost:8081/test_data.js</code>）：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">test_handler(<span class="string">&#x27;&#123;&quot;data&quot;: &quot;something&quot;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>为了动态实现JSONP请求，可以使用Javascript动态插入<code>&lt;script&gt;</code>标签：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;  </span><br><span class="line">    <span class="comment">// this shows dynamic script insertion  </span></span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);  </span><br><span class="line">    script.setAttribute(<span class="string">&#x27;src&#x27;</span>, url);  </span><br><span class="line">    <span class="comment">// load the script  </span></span><br><span class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>].appendChild(script);   </span><br><span class="line">&lt;/script&gt;  </span><br></pre></td></tr></table></figure><p>JSONP协议封装了上述步骤，jQuery中统一是现在AJAX中(其中data type为JSONP)：<code>http://localhost:8080/test?callback=test_handler</code><br>为了支持JSONP协议，服务器端必须提供特别的支持，另外JSONP只支持GET请求。</p><h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><pre><code>使用代理方式跨域更加直接，因为SOP的限制是浏览器实现的。如果请求不是从浏览器发起的，就不存在跨域问题了。使用本方法跨域步骤如下：1. 把访问其它域的请求替换为本域的请求2. 本域的请求是服务器端的动态脚本负责转发实际的请求</code></pre><h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><p>Cross-Origin Resource Sharing(CORS) 是W3C为浏览器制定的可以跨域通信的规范。通过使用 XMLHttpRequest 对象, CORS可以让开发者方便的进行跨域通信, 就像在使用同域通信一样。</p><p>通过在HTTP Header中加入扩展字段，服务器在相应网页头部加入字段表示允许访问的domain和HTTP method，客户端检查自己的域是否在允许列表中，决定是否处理响应。<br>实现的基础是JavaScript不能够操作HTTP Header。某些浏览器插件实际上是具有这个能力的。</p><p>服务器端在HTTP的响应头中加入（页面层次的控制模式）：</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">Access-Control-Allow-Origin: example.com</span><br><span class="line">Access-Control-Request-Method: GET, POST</span><br><span class="line">Access-Control-Allow-Headers: Content-Type, Authorization, Accept, Range, Origin</span><br><span class="line"></span><br><span class="line">Access-Control-Expose-Headers: Content-Range</span><br><span class="line">Access-Control-Max-Age: 3600</span><br></pre></td></tr></table></figure><p>多个域名之间用逗号分隔，表示对所示域名提供跨域访问权限。”*”表示允许所有域名的跨域访问。</p><p>客户端可以有两种行为：</p><pre><code>1. 发送OPTIONS请求，请求Access-Control信息。如果自己的域名在允许的访问列表中，则发送真正的请求，否则放弃请求发送。2. 直接发送请求，然后检查response的Access-Control信息，如果自己的域名在允许的访问列表中，则读取response body，否则放弃。</code></pre><p>本质上服务端的response内容已经到达本地，JavaScript决定是否要去读取。</p><p> Support: [Javascript Web Applications]</p><ul><li>IE &gt;= 8 (需要安装caveat)</li><li>Firefox &gt;= 3</li><li>Safari 完全支持</li><li>Chrome 完全支持</li><li>Opera 不支持</li></ul><ol><li>测试</li></ol><p>测试页面<code>http://localhost:8080/test3.html</code>使用jquery发送Ajax请求。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;  </span><br><span class="line">    &lt;head&gt;<span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>testing cross sop<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span>&lt;/head&gt;  </span><br><span class="line">    &lt;body&gt;  </span><br><span class="line">        Testing.  </span><br><span class="line">        &lt;script src=<span class="string">&quot;jquery-2.0.0.min.js&quot;</span>&gt;&lt;/script&gt;  </span><br><span class="line">        &lt;script type=<span class="string">&#x27;text/javascript&#x27;</span>&gt;  </span><br><span class="line">            $.ajax(&#123;  </span><br><span class="line">                url: <span class="string">&#x27;http://localhost:8000/hello&#x27;</span>,  </span><br><span class="line">                success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;  </span><br><span class="line">                    alert(data);  </span><br><span class="line">                &#125;,  </span><br><span class="line">                error: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">                    alert(<span class="string">&#x27;error&#x27;</span>);  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;);  </span><br><span class="line">        &lt;/script&gt;  </span><br><span class="line">    &lt;/body&gt;  </span><br><span class="line">&lt;/html&gt;  </span><br></pre></td></tr></table></figure><p>测试Restful API(<code>http://localhost:8000/hello/&#123;name&#125;</code>)使用bottle.py来host。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> route, run, response</span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/hello&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World.&#x27;</span></span><br><span class="line">    run(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>测试结果：</p><pre><code>  1. 跨域GET请求已经发出，请求header中带有   <figure class="highlight"><table><tr><td class="code"><pre><span class="line">Origin    http://localhost:8080</span><br></pre></td></tr></table></figure>  2. 服务器端正确给出response  3. Javascript拒绝读取数据，在firebug中发现reponse为空，并且触发error回调。</code></pre><ol start="2"><li><p>测试：</p><p> 测试支持CORS的服务器的跨域请求行为。</p></li></ol><p>对Restful API做如下改动，在response中加入header：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="comment">#Add CORS header#</span></span><br><span class="line">    response.set_header(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://localhost:8080&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;Hello World.&#x27;</span></span><br></pre></td></tr></table></figure><p>测试结果：</p><pre><code>  1. 跨域GET请求已经发出，请求header中带有   <figure class="highlight"><table><tr><td class="code"><pre><span class="line">Origin    http://localhost:8080</span><br></pre></td></tr></table></figure>  2. 服务器端正确给出response  3. 客户端正常获取数据</code></pre><ol start="3"><li><p>测试：</p><p> 测试OPTIONS请求获取CORS信息。</p></li></ol><p>对客户端的Ajax请求增加header：        </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;  </span><br><span class="line">    url: <span class="string">&#x27;http://localhost:8000/hello&#x27;</span>,  </span><br><span class="line">    headers: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span>&#125;,  </span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;  </span><br><span class="line">        alert(data);  </span><br><span class="line">    &#125;,  </span><br><span class="line">    error: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">        alert(<span class="string">&#x27;error&#x27;</span>);  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>对Restful API做如下改动：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/hello&#x27;</span>, method = [<span class="string">&#x27;OPTIONS&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;OPTIONS&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World.&#x27;</span></span><br></pre></td></tr></table></figure><p>测试结果：</p><pre><code>  1. Ajax函数会首先发送OPTIONS请求  2. 针对OPTIONS请求服务器  3. 客户端发现没有CORS header后不会发送GET请求</code></pre><ol start="4"><li><p>测试：</p><p> 增加服务器端对OPTIONS方法的处理。</p></li></ol><p>对Restful API做如下改动：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/hello&#x27;</span>, method = [<span class="string">&#x27;OPTIONS&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>] = <span class="string">&#x27;http://localhost:8080&#x27;</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>] = <span class="string">&#x27;GET, OPTIONS&#x27;</span></span><br><span class="line">    response.headers[<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>] = <span class="string">&#x27;Origin, Accept, Content-Type&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;OPTIONS&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World.&#x27;</span></span><br></pre></td></tr></table></figure><p>测试结果：</p><pre><code>   1. Ajax函数会首先发送OPTIONS请求   2. 针对OPTIONS请求服务器   3. 客户端匹配CORS header中的allow headers and orgin后会正确发送GET请求并获取结果</code></pre><p>测试发现，Access-Control-Allow-Headers是必须的。</p><p>CORS协议提升了Ajax的跨域能力，但也增加了风险。一旦网站被注入脚本或XSS攻击，将非常方便的获取用户信息并悄悄传递出去。</p><h3 id="Cookie-同源策略"><a href="#Cookie-同源策略" class="headerlink" title="Cookie 同源策略"></a>Cookie 同源策略</h3><p>Cookie中的同源只关注域名，忽略协议和端口。所以<code>https://localhost:8080/</code>和<code>http://localhost:8081/</code>的Cookie是共享的。</p><h3 id="Filter文件"><a href="#Filter文件" class="headerlink" title="Filter文件"></a>Filter文件</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 支持 CORS 跨域</span></span><br><span class="line"><span class="comment"> * web先OPTIONS请求，若 Access-Control-Allow-Origin：*，则发送真正的请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String allowOrigin;</span><br><span class="line">    <span class="keyword">private</span> String allowMethods;</span><br><span class="line">    <span class="keyword">private</span> String allowCredentials;</span><br><span class="line">    <span class="keyword">private</span> String allowHeaders;</span><br><span class="line">    <span class="keyword">private</span> String exposeHeaders;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        allowOrigin = filterConfig.getInitParameter(<span class="string">&quot;allowOrigin&quot;</span>);</span><br><span class="line">        allowMethods = filterConfig.getInitParameter(<span class="string">&quot;allowMethods&quot;</span>);</span><br><span class="line">        allowCredentials = filterConfig.getInitParameter(<span class="string">&quot;allowCredentials&quot;</span>);</span><br><span class="line">        allowHeaders = filterConfig.getInitParameter(<span class="string">&quot;allowHeaders&quot;</span>);</span><br><span class="line">        exposeHeaders = filterConfig.getInitParameter(<span class="string">&quot;exposeHeaders&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span></span></span><br><span class="line"><span class="function">     <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">        <span class="keyword">if</span> (!CStringUtils.isEmpty(allowOrigin)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;*&quot;</span>.equals(allowOrigin))&#123;</span><br><span class="line">                response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                List&lt;String&gt; allowOriginList = Arrays.asList(allowOrigin.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">                <span class="keyword">if</span> (!CollectionUtils.isEmpty(allowOriginList)) &#123;</span><br><span class="line">                    String currentOrigin = request.getHeader(<span class="string">&quot;Origin&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (allowOriginList.contains(currentOrigin)) &#123;</span><br><span class="line">                        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, currentOrigin);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowMethods)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, allowMethods);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowCredentials)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, allowCredentials);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(allowHeaders)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, allowHeaders);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(exposeHeaders)) &#123;</span><br><span class="line">            response.setHeader(<span class="string">&quot;Access-Control-Expose-Headers&quot;</span>, exposeHeaders);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;OPTIONS&quot;</span>.equals(request.getMethod()))&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="web-xml配置"><a href="#web-xml配置" class="headerlink" title="web.xml配置"></a>web.xml配置</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CorsFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.sgai.sadp.core.cors.CorsFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>allowOrigin<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>allowMethods<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>GET,PUT,DELETE,POST<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>allowHeaders<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>Origin,X-Requested-With,Content-Type,Accept<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CorsFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 编程随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> utils </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库中IP地址的存储</title>
      <link href="2020/01/29/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%ADIP%E5%9C%B0%E5%9D%80%E7%9A%84%E5%AD%98%E5%82%A8/"/>
      <url>2020/01/29/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%ADIP%E5%9C%B0%E5%9D%80%E7%9A%84%E5%AD%98%E5%82%A8/</url>
      
        <content type="html"><![CDATA[<p>大多数公司的表结构都需要经过DBA进行审核，有时候你会看到存储IP地址采用varchar(15)，这种方式都是传统的做法，这种方法需要占用15个字节，那么有更省空间的做法么？肯定是有的，那就是用int存储。如果采用int存储这里又有2种处理方式。</p><ol><li>利用MySQL函数进行处理。可以采用INET_ATON，INET_NTOA函数进行转换。</li><li>利用开发语言的函数进行处理，以php进行举例。可以采用ip2long，long2ip函数进行转换；java语言处理工具类如下：</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created with IntelliJ IDEA.</span></span><br><span class="line"><span class="comment"> * Desc:  IP地址使用无符号整型存储</span></span><br><span class="line"><span class="comment"> * User:  Xiaomo Song</span></span><br><span class="line"><span class="comment"> * Date: 2018-11-26</span></span><br><span class="line"><span class="comment"> * Time: 17:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IPConvetor</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ip地址转成long型数字</span></span><br><span class="line"><span class="comment">     * 将IP地址转化成整数的方法如下：</span></span><br><span class="line"><span class="comment">     * 1、通过String的split方法按.分隔得到4个长度的数组</span></span><br><span class="line"><span class="comment">     * 2、通过左移位操作（&lt;&lt;）给每一段的数字加权，</span></span><br><span class="line"><span class="comment">     * 第一段的权为2的24次方，</span></span><br><span class="line"><span class="comment">     * 第二段的权为2的16次方，</span></span><br><span class="line"><span class="comment">     * 第三段的权为2的8次方，最后一段的权为1</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> strIp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">ipToLong</span><span class="params">(String strIp)</span> </span>&#123;</span><br><span class="line">        String[] ip = strIp.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> (Long.parseLong(ip[<span class="number">0</span>]) &lt;&lt; <span class="number">24</span>) +</span><br><span class="line">            (Long.parseLong(ip[<span class="number">1</span>]) &lt;&lt; <span class="number">16</span>) +</span><br><span class="line">            (Long.parseLong(ip[<span class="number">2</span>]) &lt;&lt; <span class="number">8</span>) +</span><br><span class="line">            Long.parseLong(ip[<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将十进制整数形式转换成127.0.0.1形式的ip地址</span></span><br><span class="line"><span class="comment">     * 将整数形式的IP地址转化成字符串的方法如下：</span></span><br><span class="line"><span class="comment">     * 1、将整数值进行右移位操作（&gt;&gt;&gt;），右移24位，右移时高位补0，得到的数字即为第一段IP。</span></span><br><span class="line"><span class="comment">     * 2、通过与操作符（&amp;）将整数值的高8位设为0，再右移16位，得到的数字即为第二段IP。</span></span><br><span class="line"><span class="comment">     * 3、通过与操作符吧整数值的高16位设为0，再右移8位，得到的数字即为第三段IP。</span></span><br><span class="line"><span class="comment">     * 4、通过与操作符吧整数值的高24位设为0，得到的数字即为第四段IP。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> longIp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">longToIP</span><span class="params">(<span class="keyword">long</span> longIp)</span> </span>&#123;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="comment">// 直接右移24位</span></span><br><span class="line">        sb.append(String.valueOf((longIp &gt;&gt;&gt; <span class="number">24</span>)));</span><br><span class="line">        sb.append(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        <span class="comment">// 将高8位置0，然后右移16位</span></span><br><span class="line">        sb.append(String.valueOf((longIp &amp; <span class="number">0x00FFFFFF</span>) &gt;&gt;&gt; <span class="number">16</span>));</span><br><span class="line">        sb.append(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        <span class="comment">// 将高16位置0，然后右移8位</span></span><br><span class="line">        sb.append(String.valueOf((longIp &amp; <span class="number">0x0000FFFF</span>) &gt;&gt;&gt; <span class="number">8</span>));</span><br><span class="line">        sb.append(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        <span class="comment">// 将高24位置0</span></span><br><span class="line">        sb.append(String.valueOf((longIp &amp; <span class="number">0x000000FF</span>)));</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(ipToLong(<span class="string">&quot;255.255.0.255&quot;</span>));</span><br><span class="line">        System.out.println(longToIP(<span class="number">4294967295L</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 编程随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 工具类 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>地图坐标系转换算法</title>
      <link href="2020/01/29/%E5%9C%B0%E5%9B%BE%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E6%8D%A2%E7%AE%97%E6%B3%95/"/>
      <url>2020/01/29/%E5%9C%B0%E5%9B%BE%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E6%8D%A2%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="当前互联网地图的坐标系现状"><a href="#当前互联网地图的坐标系现状" class="headerlink" title="当前互联网地图的坐标系现状"></a>当前互联网地图的坐标系现状</h2><ul><li>地球坐标 (WGS84)<ul><li>国际标准，从专业 GPS 设备中取出的数据的坐标系。国际地图提供商使用的坐标系。</li></ul></li><li>火星坐标 (GCJ-02)也叫国测局坐标系<ul><li>中国标准，从国行移动设备中定位获取的坐标数据使用这个坐标系。</li><li>国家规定： 国内出版的各种地图系统（包括电子形式），必须至少采用GCJ-02对地理位置进行首次加密。</li></ul></li><li>百度坐标 (BD-09)<ul><li>百度标准，百度 SDK，百度地图，Geocoding 使用(百度在火星坐标上的二次加密)。</li></ul></li></ul><h2 id="互联网在线地图使用的坐标系"><a href="#互联网在线地图使用的坐标系" class="headerlink" title="互联网在线地图使用的坐标系"></a>互联网在线地图使用的坐标系</h2><ul><li>火星坐标系：<ul><li>iOS 地图（其实是高德）、Gogole地图、搜搜、阿里云、高德地图</li></ul></li><li>百度坐标系：<ul><li>当然只有百度地图</li></ul></li><li>WGS84坐标系：<ul><li>国际标准，谷歌国外地图、osm地图等国外的地图一般都是这个。</li></ul></li></ul><h2 id="从设备获取经纬度（GPS）坐标"><a href="#从设备获取经纬度（GPS）坐标" class="headerlink" title="从设备获取经纬度（GPS）坐标"></a>从设备获取经纬度（GPS）坐标</h2><ul><li>如果使用的是百度sdk那么可以获得百度坐标（bd09）或者火星坐标（GCJ02),默认是bd09。</li><li>如果使用的是ios的原生定位库，那么获得的坐标是WGS84。</li><li>如果使用的是高德sdk,那么获取的坐标是GCJ02。</li></ul><h2 id="详细代码"><a href="#详细代码" class="headerlink" title="详细代码"></a>详细代码</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//定义一些常量</span></span><br><span class="line">    <span class="keyword">var</span> x_PI = <span class="number">3.14159265358979324</span> * <span class="number">3000.0</span> / <span class="number">180.0</span>;</span><br><span class="line">    <span class="keyword">var</span> PI = <span class="number">3.1415926535897932384626</span>;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">6378245.0</span>;</span><br><span class="line">    <span class="keyword">var</span> ee = <span class="number">0.00669342162296594323</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     　　* 百度坐标系 (BD-09) 与 火星坐标系 (GCJ-02)的转换</span></span><br><span class="line"><span class="comment">     　　* 即 百度 转 谷歌、高德</span></span><br><span class="line"><span class="comment">     　　* <span class="doctag">@param <span class="variable">bd_lon</span></span></span></span><br><span class="line"><span class="comment">     　　* <span class="doctag">@param <span class="variable">bd_lat</span></span></span></span><br><span class="line"><span class="comment">     　　* <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment">     　　*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bd09togcj02</span>(<span class="params">bd_lon, bd_lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> x_pi = <span class="number">3.14159265358979324</span> * <span class="number">3000.0</span> / <span class="number">180.0</span>;</span><br><span class="line">        <span class="keyword">var</span> x = bd_lon - <span class="number">0.0065</span>;</span><br><span class="line">        <span class="keyword">var</span> y = bd_lat - <span class="number">0.006</span>;</span><br><span class="line">        <span class="keyword">var</span> z = <span class="built_in">Math</span>.sqrt(x * x + y * y) - <span class="number">0.00002</span> * <span class="built_in">Math</span>.sin(y * x_pi);</span><br><span class="line">        <span class="keyword">var</span> theta = <span class="built_in">Math</span>.atan2(y, x) - <span class="number">0.000003</span> * <span class="built_in">Math</span>.cos(x * x_pi);</span><br><span class="line">        <span class="keyword">var</span> gg_lng = z * <span class="built_in">Math</span>.cos(theta);</span><br><span class="line">        <span class="keyword">var</span> gg_lat = z * <span class="built_in">Math</span>.sin(theta);</span><br><span class="line">        <span class="keyword">return</span> [gg_lng, gg_lat]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 火星坐标系 (GCJ-02) 与百度坐标系 (BD-09) 的转换</span></span><br><span class="line"><span class="comment">     * 即谷歌、高德 转 百度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gcj02tobd09</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> z = <span class="built_in">Math</span>.sqrt(lng * lng + lat * lat) + <span class="number">0.00002</span> * <span class="built_in">Math</span>.sin(lat * x_PI);</span><br><span class="line">        <span class="keyword">var</span> theta = <span class="built_in">Math</span>.atan2(lat, lng) + <span class="number">0.000003</span> * <span class="built_in">Math</span>.cos(lng * x_PI);</span><br><span class="line">        <span class="keyword">var</span> bd_lng = z * <span class="built_in">Math</span>.cos(theta) + <span class="number">0.0065</span>;</span><br><span class="line">        <span class="keyword">var</span> bd_lat = z * <span class="built_in">Math</span>.sin(theta) + <span class="number">0.006</span>;</span><br><span class="line">        <span class="keyword">return</span> [bd_lng, bd_lat]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * WGS84转GCj02</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">wgs84togcj02</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (out_of_china(lng, lat)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [lng, lat]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> dlat = transformlat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">            <span class="keyword">var</span> dlng = transformlng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">            <span class="keyword">var</span> radlat = lat / <span class="number">180.0</span> * PI;</span><br><span class="line">            <span class="keyword">var</span> magic = <span class="built_in">Math</span>.sin(radlat);</span><br><span class="line">            magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line">            <span class="keyword">var</span> sqrtmagic = <span class="built_in">Math</span>.sqrt(magic);</span><br><span class="line">            dlat = (dlat * <span class="number">180.0</span>) / ((a * (<span class="number">1</span> - ee)) / (magic * sqrtmagic) * PI);</span><br><span class="line">            dlng = (dlng * <span class="number">180.0</span>) / (a / sqrtmagic * <span class="built_in">Math</span>.cos(radlat) * PI);</span><br><span class="line">            <span class="keyword">var</span> mglat = lat + dlat;</span><br><span class="line">            <span class="keyword">var</span> mglng = lng + dlng;</span><br><span class="line">            <span class="keyword">return</span> [mglng, mglat]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * GCJ02 转换为 WGS84</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gcj02towgs84</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (out_of_china(lng, lat)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [lng, lat]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> dlat = transformlat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">            <span class="keyword">var</span> dlng = transformlng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">            <span class="keyword">var</span> radlat = lat / <span class="number">180.0</span> * PI;</span><br><span class="line">            <span class="keyword">var</span> magic = <span class="built_in">Math</span>.sin(radlat);</span><br><span class="line">            magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line">            <span class="keyword">var</span> sqrtmagic = <span class="built_in">Math</span>.sqrt(magic);</span><br><span class="line">            dlat = (dlat * <span class="number">180.0</span>) / ((a * (<span class="number">1</span> - ee)) / (magic * sqrtmagic) * PI);</span><br><span class="line">            dlng = (dlng * <span class="number">180.0</span>) / (a / sqrtmagic * <span class="built_in">Math</span>.cos(radlat) * PI);</span><br><span class="line">            mglat = lat + dlat;</span><br><span class="line">            mglng = lng + dlng;</span><br><span class="line">            <span class="keyword">return</span> [lng * <span class="number">2</span> - mglng, lat * <span class="number">2</span> - mglat]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">transformlat</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = -<span class="number">100.0</span> + <span class="number">2.0</span> * lng + <span class="number">3.0</span> * lat + <span class="number">0.2</span> * lat * lat + <span class="number">0.1</span> * lng * lat + <span class="number">0.2</span> * <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.abs(lng));</span><br><span class="line">        ret += (<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">6.0</span> * lng * PI) + <span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">2.0</span> * lng * PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line">        ret += (<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(lat * PI) + <span class="number">40.0</span> * <span class="built_in">Math</span>.sin(lat / <span class="number">3.0</span> * PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line">        ret += (<span class="number">160.0</span> * <span class="built_in">Math</span>.sin(lat / <span class="number">12.0</span> * PI) + <span class="number">320</span> * <span class="built_in">Math</span>.sin(lat * PI / <span class="number">30.0</span>)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">transformlng</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="number">300.0</span> + lng + <span class="number">2.0</span> * lat + <span class="number">0.1</span> * lng * lng + <span class="number">0.1</span> * lng * lat + <span class="number">0.1</span> * <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.abs(lng));</span><br><span class="line">        ret += (<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">6.0</span> * lng * PI) + <span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">2.0</span> * lng * PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line">        ret += (<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(lng * PI) + <span class="number">40.0</span> * <span class="built_in">Math</span>.sin(lng / <span class="number">3.0</span> * PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line">        ret += (<span class="number">150.0</span> * <span class="built_in">Math</span>.sin(lng / <span class="number">12.0</span> * PI) + <span class="number">300.0</span> * <span class="built_in">Math</span>.sin(lng / <span class="number">30.0</span> * PI)) * <span class="number">2.0</span> / <span class="number">3.0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断是否在国内，不在国内则不做偏移</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@returns <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">out_of_china</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (lng &lt; <span class="number">72.004</span> || lng &gt; <span class="number">137.8347</span>) || ((lat &lt; <span class="number">0.8293</span> || lat &gt; <span class="number">55.8271</span>) || <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        wgs84ToGcj:wgs84togcj02,</span><br><span class="line">        wgs84ToBd:<span class="function"><span class="keyword">function</span>(<span class="params">lng,lat</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> p=wgs84togcj02(lng,lat);</span><br><span class="line">            <span class="keyword">return</span> gcj02tobd09(p[<span class="number">0</span>],p[<span class="number">1</span>]);</span><br><span class="line">        &#125;,</span><br><span class="line">        gcjToBd:gcj02tobd09,</span><br><span class="line">        gcjToWgs84:gcj02towgs84,</span><br><span class="line">        bdToGcj:bd09togcj02,</span><br><span class="line">        bdToWgs84:<span class="function"><span class="keyword">function</span>(<span class="params">lng,lat</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> p=bd09togcj02(lng,lat);</span><br><span class="line">            <span class="keyword">return</span> gcj02towgs84(p[<span class="number">0</span>],p[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 编程随笔 </category>
          
          <category> 代码片段 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> 工具类 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>四位共阳数码管显示驱动</title>
      <link href="2020/01/29/%E5%9B%9B%E4%BD%8D%E5%85%B1%E9%98%B3%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8/"/>
      <url>2020/01/29/%E5%9B%9B%E4%BD%8D%E5%85%B1%E9%98%B3%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<p>四位共阳数码管显示驱动，使用 python3 编写。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tm1637 class</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> RPi.GPIO <span class="keyword">as</span> GPIO</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0, 1, 2, 3, 4, 5, 6, 7, 8 ,9</span></span><br><span class="line"><span class="comment">#HexDigits = [0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71];</span></span><br><span class="line">HexDigits = [<span class="number">0x3f</span>,<span class="number">0x06</span>,<span class="number">0x5b</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,<span class="number">0x6d</span>,<span class="number">0x7d</span>,<span class="number">0x07</span>,<span class="number">0x7f</span>,<span class="number">0x6f</span>];</span><br><span class="line"></span><br><span class="line">ADDR_AUTO = <span class="number">0x40</span>;</span><br><span class="line">ADDR_FIXED = <span class="number">0x44</span>;</span><br><span class="line">START_ADDR = <span class="number">0xC0</span>;</span><br><span class="line">BRIGHT_DARKEST = <span class="number">0</span>;</span><br><span class="line">BRIGHT_TYPICAL = <span class="number">2</span>;</span><br><span class="line">BRIGHT_HIGHEST = <span class="number">7</span>;</span><br><span class="line">OUTPUT = GPIO.OUT;</span><br><span class="line">INPUT = GPIO.IN;</span><br><span class="line">LOW = GPIO.LOW;</span><br><span class="line">HIGH = GPIO.HIGH;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TM1637</span>:</span></span><br><span class="line">    doublePoint = <span class="literal">False</span>;</span><br><span class="line">    clkPin = <span class="number">0</span>;</span><br><span class="line">    dataPin = <span class="number">0</span>;</span><br><span class="line">    brightnes = BRIGHT_TYPICAL;</span><br><span class="line">    curData = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, clkPin, dataPin, brightnes = BRIGHT_TYPICAL</span>):</span></span><br><span class="line">        self.clkPin = clkPin;</span><br><span class="line">        self.dataPin = dataPin;</span><br><span class="line">        self.brightnes = brightnes;</span><br><span class="line">        GPIO.setup(self.clkPin, OUTPUT);</span><br><span class="line">        GPIO.setup(self.dataPin, OUTPUT);</span><br><span class="line">    <span class="comment"># end __init__</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clear</span>(<span class="params">self</span>):</span></span><br><span class="line">        point = self.doublePoint;</span><br><span class="line">        self.doublePoint = <span class="literal">False</span>;</span><br><span class="line">        data = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line">        self.showData(data);</span><br><span class="line">        self.doublePoint = point;</span><br><span class="line">    <span class="comment"># end clear</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showData</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="comment">#print &#x27;show data&#x27;;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">            self.curData[i] = data[i];</span><br><span class="line">            <span class="comment">#print &#x27;data[&#x27;, i, &#x27;]&#x27;, data[i];</span></span><br><span class="line">        <span class="comment">#end for</span></span><br><span class="line"></span><br><span class="line">        self.start();</span><br><span class="line">        self.writeByte(ADDR_AUTO);</span><br><span class="line">        self.stop();</span><br><span class="line">        self.start();</span><br><span class="line">        self.writeByte(START_ADDR);</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">            self.writeByte(self.encode(data[i]));</span><br><span class="line">        self.stop()</span><br><span class="line">        self.start();</span><br><span class="line">        self.writeByte(<span class="number">0x88</span> + self.brightnes);</span><br><span class="line">        self.stop();</span><br><span class="line">    <span class="comment"># end showData</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showDoublePoint</span>(<span class="params">self, on</span>):</span></span><br><span class="line">        <span class="keyword">if</span>(self.doublePoint != on):</span><br><span class="line">            self.doublePoint = on;</span><br><span class="line">            self.showData(self.curData);</span><br><span class="line">        <span class="comment"># end if</span></span><br><span class="line">    <span class="comment">#end showDoublePoint</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writeByte</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">8</span>):</span><br><span class="line">            GPIO.output(self.clkPin, LOW);</span><br><span class="line">            <span class="keyword">if</span>(data &amp; <span class="number">0x01</span>):</span><br><span class="line">                GPIO.output(self.dataPin, HIGH);</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                GPIO.output(self.dataPin, LOW);</span><br><span class="line"></span><br><span class="line">            data = data &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            GPIO.output(self.clkPin, HIGH);</span><br><span class="line">        <span class="comment"># end for</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># wait for ACK</span></span><br><span class="line">        GPIO.output(self.clkPin, LOW);</span><br><span class="line">        GPIO.output(self.dataPin, HIGH); <span class="comment"># set data gpio high, util slave ack,set low</span></span><br><span class="line">        GPIO.output(self.clkPin, HIGH);</span><br><span class="line">        GPIO.setup(self.dataPin, INPUT); <span class="comment"># set data gpio to input for slave</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#print &#x27;self.dataPint = &#x27;, self.dataPin;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(GPIO.<span class="built_in">input</span>(self.dataPin)):</span><br><span class="line">            time.sleep(<span class="number">0.001</span>);</span><br><span class="line">            <span class="keyword">if</span>(GPIO.<span class="built_in">input</span>(self.dataPin)):</span><br><span class="line">                GPIO.setup(self.dataPin, OUTPUT);</span><br><span class="line">                GPIO.output(self.dataPin, LOW);</span><br><span class="line">                GPIO.setup(self.dataPin, INPUT);</span><br><span class="line">            <span class="comment"># end if</span></span><br><span class="line">        <span class="comment"># end while</span></span><br><span class="line">        <span class="comment">#print &#x27;ack is get&#x27;</span></span><br><span class="line">        GPIO.setup(self.dataPin, OUTPUT);</span><br><span class="line"></span><br><span class="line">    <span class="comment"># end writeByte</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span>(<span class="params">self</span>):</span></span><br><span class="line">        GPIO.output(self.clkPin, HIGH);</span><br><span class="line">        GPIO.output(self.dataPin, HIGH);</span><br><span class="line">        GPIO.output(self.dataPin, LOW);</span><br><span class="line">        GPIO.output(self.clkPin, LOW)</span><br><span class="line">    <span class="comment"># end start</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stop</span>(<span class="params">self</span>):</span></span><br><span class="line">        GPIO.output(self.clkPin, LOW);</span><br><span class="line">        GPIO.output(self.dataPin, LOW);</span><br><span class="line">        GPIO.output(self.clkPin, HIGH);</span><br><span class="line">        GPIO.output(self.dataPin, HIGH);</span><br><span class="line">    <span class="comment"># end stop</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        <span class="keyword">if</span>(self.doublePoint):</span><br><span class="line">            pointData = <span class="number">0x80</span>;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pointData = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(data == <span class="number">0x7F</span>):</span><br><span class="line">            data = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data = HexDigits[data] + pointData;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    <span class="comment"># end encode</span></span><br><span class="line"><span class="comment"># end class TM1637</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># start show cur timer</span></span><br><span class="line"><span class="keyword">import</span> tm1637</span><br><span class="line"><span class="keyword">import</span> RPi.GPIO <span class="keyword">as</span> GPIO</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">CLK = <span class="number">24</span>;</span><br><span class="line">DATA  = <span class="number">23</span>;</span><br><span class="line">GPIO.setmode(GPIO.BCM)</span><br><span class="line">GPIO.setwarnings(<span class="literal">False</span>);</span><br><span class="line"></span><br><span class="line">HHMMFORMAT = <span class="string">&#x27;%H:%M&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    digital1637 = tm1637.TM1637(CLK, DATA)</span><br><span class="line">    digital1637.showDoublePoint(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    lastTime = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        curTime = time.strftime(HHMMFORMAT, time.localtime(time.time()));</span><br><span class="line">        <span class="keyword">if</span>(curTime != lastTime):</span><br><span class="line">            number = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">            digital1637.showData(number);</span><br><span class="line">        <span class="comment"># end if</span></span><br><span class="line"></span><br><span class="line">        time.sleep(<span class="number">0.05</span>);</span><br><span class="line">    <span class="comment"># end while</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">GPIO.cleanup();</span><br><span class="line"><span class="comment"># end show cur timer</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 编程随笔 </category>
          
          <category> 代码片段 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树莓派 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字符串转Double</title>
      <link href="2020/01/29/%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%ACDouble/"/>
      <url>2020/01/29/%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%ACDouble/</url>
      
        <content type="html"><![CDATA[<p>Q：给你一个字符串，比如「123.456」，转换成 Double 类型</p><p>A：easy 啊</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Double d1 = Double.valueOf(<span class="string">&quot;123.456&quot;</span>);</span><br></pre></td></tr></table></figure><p>Q：这样就没意思了，不能用JDK里面的方法</p><p>A：我想想（内心：木有IDE == ，木有手册；此种情况我只知道某鹅厂大神可以徒手撸代码，直接编译不报错）</p><p>A：这样，我讲下我的思路吧，blablabla……</p><p>Q：嗯好，你写吧</p><p>A：……</p><p>好吧，保存一下。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created with IntelliJ IDEA.</span></span><br><span class="line"><span class="comment"> * Desc: 给定字符串，转换成 Double；</span></span><br><span class="line"><span class="comment"> *       如果是 null 或者空串，直接返回0</span></span><br><span class="line"><span class="comment"> *       如果不是标准的数字格式“asdf”、“.12345”、“1234.”也返回0</span></span><br><span class="line"><span class="comment"> *       char-&gt;int，得到的是ASCII码，并不是真正的数值，</span></span><br><span class="line"><span class="comment"> *       但是鉴于0-9是连续编码的，我们可以这样获得 &#x27;1&#x27;-&#x27;0&#x27;=1</span></span><br><span class="line"><span class="comment"> *       To be continued...</span></span><br><span class="line"><span class="comment"> * User:  Xiaomo Song</span></span><br><span class="line"><span class="comment"> * Date: 2018-12-09</span></span><br><span class="line"><span class="comment"> * Time: 18:25</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">String2Double</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        Metho1:</span></span><br><span class="line">        Double d1 = Double.valueOf(<span class="string">&quot;123.233&quot;</span>);</span><br><span class="line">        System.out.println(d1);</span><br><span class="line"><span class="comment">//        Method2:</span></span><br><span class="line">        Double d2 = String2Double.string2Double(<span class="string">&quot;123.456&quot;</span>);</span><br><span class="line">        System.out.println(d2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Double <span class="title">string2Double</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="keyword">null</span> || str.trim().equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未输入字符串&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (str.matches(<span class="string">&quot;^\\d+(\\.\\d+)?&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">char</span>[] chars = str.toCharArray();</span><br><span class="line">            <span class="keyword">int</span> index = str.indexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> (index == -<span class="number">1</span>) &#123;</span><br><span class="line">                index = chars.length;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=index-<span class="number">1</span> ;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">                result+=Math.pow(<span class="number">10</span>,index-<span class="number">1</span>-i)*char2Int(chars[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=index+<span class="number">1</span>;i&lt;chars.length;i++)&#123;</span><br><span class="line">                result+=Math.pow(<span class="number">0.1</span>,i-index)*char2Int(chars[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;字符串中有其他字符&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">char2Int</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 计算机 </category>
          
          <category> 算法题解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>接口文档示例</title>
      <link href="2020/01/29/%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3%E7%A4%BA%E4%BE%8B/"/>
      <url>2020/01/29/%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="文档信息"><a href="#文档信息" class="headerlink" title="文档信息"></a>文档信息</h2><h3 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h3><table><thead><tr><th>版本号</th><th>创建时间</th><th>作者</th><th>受控状态</th><th>审核</th><th>校对</th></tr></thead><tbody><tr><td>0.1</td><td>2018.05.04</td><td>小莫</td><td>受控</td><td></td><td></td></tr></tbody></table><h3 id="修改信息"><a href="#修改信息" class="headerlink" title="修改信息"></a>修改信息</h3><table><thead><tr><th>序号</th><th>修改后版本号</th><th>修改日期</th><th>修改人</th><th>修改原因</th><th>修改内容</th></tr></thead><tbody><tr><td>1</td><td>0.5</td><td>2018.05.06</td><td>小莫</td><td>填充数据</td><td>用户-新增接口</td></tr></tbody></table><h2 id="接口信息"><a href="#接口信息" class="headerlink" title="接口信息"></a>接口信息</h2><h3 id="用户设置"><a href="#用户设置" class="headerlink" title="用户设置"></a>用户设置</h3><h4 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h4><ol><li>请求地址：<a href="http://www.baidu.com/">http://www.baidu.com</a></li><li>请求方法：POST</li><li>请求参数示例：</li></ol><figure class="highlight"><table><tr><td class="code"><pre><span class="line">id=6&amp;nameLike=张三</span><br></pre></td></tr></table></figure><ol><li>请求头：</li></ol><figure class="highlight"><table><tr><td class="code"><pre><span class="line">Content-Type: application/json;charset=UTF-8</span><br></pre></td></tr></table></figure><ol><li>请求体示例：</li></ol><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;rearNo&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;feeName&quot;</span>: <span class="string">&quot;报销测试&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;feeCode&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;unit&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;amount&quot;</span>: <span class="string">&quot;6&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;price&quot;</span>: <span class="string">&quot;10&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;totalPrice&quot;</span>: <span class="string">&quot;60&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;rearBy&quot;</span>: <span class="string">&quot;莫&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;orgId&quot;</span>: <span class="string">&quot;depart2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;convoyId&quot;</span>: <span class="string">&quot;CD-SCCD&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;rearDate&quot;</span>: <span class="string">&quot;2018-05-04 00:00:00&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;remark&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>请求参数说明：</li></ol><table><thead><tr><th>参数名</th><th>类型</th><th>必填</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>rearNo</td><td>Integer</td><td>Y</td><td></td><td>编号</td></tr></tbody></table><ol><li>返回结果示例：</li></ol><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;stateCode&quot;</span>: <span class="number">200</span>,</span><br><span class="line">  <span class="attr">&quot;state&quot;</span>: <span class="string">&quot;请求成功&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>返回结果参数说明：</li></ol><table><thead><tr><th>参数名</th><th>类型</th><th>必填</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>rearNo</td><td>Integer</td><td>Y</td><td></td><td>编号</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 文档记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 标准 </tag>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>中文文案排版指北</title>
      <link href="2020/01/28/%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%88%E6%8E%92%E7%89%88%E6%8C%87%E5%8C%97/"/>
      <url>2020/01/28/%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%88%E6%8E%92%E7%89%88%E6%8C%87%E5%8C%97/</url>
      
        <content type="html"><![CDATA[<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><!-- TOC --><ul><li><a href="#%E7%9B%AE%E5%BD%95">目录</a></li><li><a href="#%E7%A9%BA%E6%A0%BC">空格</a><ul><li><a href="#%E4%B8%AD%E8%8B%B1%E6%96%87%E4%B9%8B%E9%97%B4%E9%9C%80%E8%A6%81%E5%A2%9E%E5%8A%A0%E7%A9%BA%E6%A0%BC">中英文之间需要增加空格</a></li><li><a href="#%E4%B8%AD%E6%96%87%E4%B8%8E%E6%95%B0%E5%AD%97%E4%B9%8B%E9%97%B4%E9%9C%80%E8%A6%81%E5%A2%9E%E5%8A%A0%E7%A9%BA%E6%A0%BC">中文与数字之间需要增加空格</a></li><li><a href="#%E6%95%B0%E5%AD%97%E4%B8%8E%E5%8D%95%E4%BD%8D%E4%B9%8B%E9%97%B4%E6%97%A0%E9%9C%80%E5%A2%9E%E5%8A%A0%E7%A9%BA%E6%A0%BC">数字与单位之间无需增加空格</a></li><li><a href="#%E5%85%A8%E8%A7%92%E6%A0%87%E7%82%B9%E4%B8%8E%E5%85%B6%E4%BB%96%E5%AD%97%E7%AC%A6%E4%B9%8B%E9%97%B4%E4%B8%8D%E5%8A%A0%E7%A9%BA%E6%A0%BC">全角标点与其他字符之间不加空格</a></li><li><a href="#-ms-text-autospace-to-the-rescue"><code>-ms-text-autospace</code> to the rescue?</a></li></ul></li><li><a href="#%E6%A0%87%E7%82%B9%E7%AC%A6%E5%8F%B7">标点符号</a><ul><li><a href="#%E4%B8%8D%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8%E6%A0%87%E7%82%B9%E7%AC%A6%E5%8F%B7">不重复使用标点符号</a></li></ul></li><li><a href="#%E5%85%A8%E8%A7%92%E5%92%8C%E5%8D%8A%E8%A7%92">全角和半角</a><ul><li><a href="#%E4%BD%BF%E7%94%A8%E5%85%A8%E8%A7%92%E4%B8%AD%E6%96%87%E6%A0%87%E7%82%B9">使用全角中文标点</a></li><li><a href="#%E6%95%B0%E5%AD%97%E4%BD%BF%E7%94%A8%E5%8D%8A%E8%A7%92%E5%AD%97%E7%AC%A6">数字使用半角字符</a></li><li><a href="#%E9%81%87%E5%88%B0%E5%AE%8C%E6%95%B4%E7%9A%84%E8%8B%B1%E6%96%87%E6%95%B4%E5%8F%A5%E7%89%B9%E6%AE%8A%E5%90%8D%E8%AF%8D%E5%85%B6%E5%85%A7%E5%AE%B9%E4%BD%BF%E7%94%A8%E5%8D%8A%E8%A7%92%E6%A0%87%E7%82%B9">遇到完整的英文整句、特殊名词，其內容使用半角标点</a></li></ul></li><li><a href="#%E5%90%8D%E8%AF%8D">名词</a><ul><li><a href="#%E4%B8%93%E6%9C%89%E5%90%8D%E8%AF%8D%E4%BD%BF%E7%94%A8%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%A4%A7%E5%B0%8F%E5%86%99">专有名词使用正确的大小写</a></li><li><a href="#%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%9C%B0%E9%81%93%E7%9A%84%E7%BC%A9%E5%86%99">不要使用不地道的缩写</a></li></ul></li><li><a href="#%E4%BA%89%E8%AE%AE">争议</a><ul><li><a href="#%E9%93%BE%E6%8E%A5%E4%B9%8B%E9%97%B4%E5%A2%9E%E5%8A%A0%E7%A9%BA%E6%A0%BC">链接之间增加空格</a></li><li><a href="#%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%E4%BD%BF%E7%94%A8%E7%9B%B4%E8%A7%92%E5%BC%95%E5%8F%B7">简体中文使用直角引号</a></li></ul></li><li><a href="#%E5%B7%A5%E5%85%B7">工具</a></li><li><a href="#%E8%B0%81%E5%9C%A8%E8%BF%99%E6%A0%B7%E5%81%9A">谁在这样做？</a></li><li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li></ul><!-- /TOC --><h2 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h2><p>「有研究显示，打字的时候不喜欢在中文和英文之间加空格的人，感情路都走得很辛苦，有七成的比例会在 34 岁的时候跟自己不爱的人结婚，而其余三成的人最后只能把遗产留给自己的猫。毕竟爱情跟书写都需要适时地留白。</p><p>与大家共勉之。」——<a href="https://github.com/vinta/pangu.js">vinta/paranoid-auto-spacing</a></p><h3 id="中英文之间需要增加空格"><a href="#中英文之间需要增加空格" class="headerlink" title="中英文之间需要增加空格"></a>中英文之间需要增加空格</h3><p>正确：</p><blockquote><p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。</p></blockquote><p>错误：</p><blockquote><p>在LeanCloud上，数据存储是围绕<code>AVObject</code>进行的。</p></blockquote><blockquote><p>在 LeanCloud上，数据存储是围绕<code>AVObject</code> 进行的。</p></blockquote><p>完整的正确用法：</p><blockquote><p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。每个 <code>AVObject</code> 都包含了与 JSON 兼容的 key-value 对应的数据。数据是 schema-free 的，你不需要在每个 <code>AVObject</code> 上提前指定存在哪些键，只要直接设定对应的 key-value 即可。</p></blockquote><p>例外：「豆瓣FM」等产品名词，按照官方所定义的格式书写。</p><h3 id="中文与数字之间需要增加空格"><a href="#中文与数字之间需要增加空格" class="headerlink" title="中文与数字之间需要增加空格"></a>中文与数字之间需要增加空格</h3><p>正确：</p><blockquote><p>今天出去买菜花了 5000 元。</p></blockquote><p>错误：</p><blockquote><p>今天出去买菜花了 5000元。</p></blockquote><blockquote><p>今天出去买菜花了5000元。</p></blockquote><h3 id="数字与单位之间无需增加空格"><a href="#数字与单位之间无需增加空格" class="headerlink" title="数字与单位之间无需增加空格"></a>数字与单位之间无需增加空格</h3><p>正确：</p><blockquote><p>我家的光纤入户宽带有 10Gbps，SSD 一共有 10TB。</p></blockquote><p>错误：</p><blockquote><p>我家的光纤入户宽带有 10 Gbps，SSD 一共有 20 TB。</p></blockquote><p>另外，度／百分比与数字之间不需要增加空格：</p><p>正确：</p><blockquote><p>今天是 233° 的高温。</p></blockquote><blockquote><p>新 MacBook Pro 有 15% 的 CPU 性能提升。</p></blockquote><p>错误：</p><blockquote><p>今天是 233 ° 的高温。</p></blockquote><blockquote><p>新 MacBook Pro 有 15 % 的 CPU 性能提升。</p></blockquote><h3 id="全角标点与其他字符之间不加空格"><a href="#全角标点与其他字符之间不加空格" class="headerlink" title="全角标点与其他字符之间不加空格"></a>全角标点与其他字符之间不加空格</h3><p>正确：</p><blockquote><p>刚刚买了一部 iPhone，好开心！</p></blockquote><p>错误：</p><blockquote><p>刚刚买了一部 iPhone ，好开心！</p></blockquote><h3 id="ms-text-autospace-to-the-rescue"><a href="#ms-text-autospace-to-the-rescue" class="headerlink" title="-ms-text-autospace to the rescue?"></a><code>-ms-text-autospace</code> to the rescue?</h3><p>Microsoft 有个 <a href="http://msdn.microsoft.com/en-us/library/ie/ms531164(v=vs.85).aspx"><code>-ms-text-autospace</code></a> 的 CSS 属性可以实现自动为中英文之间增加空白。不过目前并未普及，另外在其他应用场景，例如 OS X、iOS 的用户界面目前并不存在这个特性，所以请继续保持随手加空格的习惯。</p><h2 id="标点符号"><a href="#标点符号" class="headerlink" title="标点符号"></a>标点符号</h2><h3 id="不重复使用标点符号"><a href="#不重复使用标点符号" class="headerlink" title="不重复使用标点符号"></a>不重复使用标点符号</h3><p>正确：</p><blockquote><p>德国队竟然战胜了巴西队！</p></blockquote><blockquote><p>她竟然对你说「喵」？！</p></blockquote><p>错误：</p><blockquote><p>德国队竟然战胜了巴西队！！</p></blockquote><blockquote><p>德国队竟然战胜了巴西队！！！！！！！！</p></blockquote><blockquote><p>她竟然对你说「喵」？？！！</p></blockquote><blockquote><p>她竟然对你说「喵」？！？！？？！！</p></blockquote><h2 id="全角和半角"><a href="#全角和半角" class="headerlink" title="全角和半角"></a>全角和半角</h2><p>不明白什么是全角（全形）与半角（半形）符号？请查看维基百科词条『<a href="http://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2">全角和半角</a>』。</p><h3 id="使用全角中文标点"><a href="#使用全角中文标点" class="headerlink" title="使用全角中文标点"></a>使用全角中文标点</h3><p>正确：</p><blockquote><p>嗨！你知道嘛？今天前台的小妹跟我说「喵」了哎！</p></blockquote><blockquote><p>核磁共振成像（NMRI）是什么原理都不知道？JFGI！</p></blockquote><p>错误：</p><blockquote><p>嗨! 你知道嘛? 今天前台的小妹跟我说 “喵” 了哎!</p></blockquote><blockquote><p>嗨!你知道嘛?今天前台的小妹跟我说”喵”了哎!</p></blockquote><blockquote><p>核磁共振成像 (NMRI) 是什么原理都不知道? JFGI!</p></blockquote><blockquote><p>核磁共振成像(NMRI)是什么原理都不知道?JFGI!</p></blockquote><h3 id="数字使用半角字符"><a href="#数字使用半角字符" class="headerlink" title="数字使用半角字符"></a>数字使用半角字符</h3><p>正确：</p><blockquote><p>这件蛋糕只卖 1000 元。</p></blockquote><p>错误：</p><blockquote><p>这件蛋糕只卖 １０００ 元。</p></blockquote><p>例外：在设计稿、宣传海报中如出现极少量数字的情形时，为方便文字对齐，是可以使用全角数字的。</p><h3 id="遇到完整的英文整句、特殊名词，其內容使用半角标点"><a href="#遇到完整的英文整句、特殊名词，其內容使用半角标点" class="headerlink" title="遇到完整的英文整句、特殊名词，其內容使用半角标点"></a>遇到完整的英文整句、特殊名词，其內容使用半角标点</h3><p>正确：</p><blockquote><p>乔布斯那句话是怎么说的？「Stay hungry, stay foolish.」</p></blockquote><blockquote><p>推荐你阅读《Hackers &amp; Painters: Big Ideas from the Computer Age》，非常的有趣。</p></blockquote><p>错误：</p><blockquote><p>乔布斯那句话是怎么说的？「Stay hungry，stay foolish。」</p></blockquote><blockquote><p>推荐你阅读《Hackers＆Painters：Big Ideas from the Computer Age》，非常的有趣。</p></blockquote><h2 id="名词"><a href="#名词" class="headerlink" title="名词"></a>名词</h2><h3 id="专有名词使用正确的大小写"><a href="#专有名词使用正确的大小写" class="headerlink" title="专有名词使用正确的大小写"></a>专有名词使用正确的大小写</h3><p>大小写相关用法原属于英文书写范畴，不属于本 wiki 讨论內容，在这里只对部分易错用法进行简述。</p><p>正确：</p><blockquote><p>使用 GitHub 登录</p></blockquote><blockquote><p>我们的客户有 GitHub、Foursquare、Microsoft Corporation、Google、Facebook, Inc.。</p></blockquote><p>错误：</p><blockquote><p>使用 github 登录</p></blockquote><blockquote><p>使用 GITHUB 登录</p></blockquote><blockquote><p>使用 Github 登录</p></blockquote><blockquote><p>使用 gitHub 登录</p></blockquote><blockquote><p>使用 gｲんĤЦ8 登录</p></blockquote><blockquote><p>我们的客户有 github、foursquare、microsoft corporation、google、facebook, inc.。</p></blockquote><blockquote><p>我们的客户有 GITHUB、FOURSQUARE、MICROSOFT CORPORATION、GOOGLE、FACEBOOK, INC.。</p></blockquote><blockquote><p>我们的客户有 Github、FourSquare、MicroSoft Corporation、Google、FaceBook, Inc.。</p></blockquote><blockquote><p>我们的客户有 gitHub、fourSquare、microSoft Corporation、google、faceBook, Inc.。</p></blockquote><blockquote><p>我们的客户有 gｲんĤЦ8、ｷouЯƧquﾑгє、๓เςг๏ร๏Ŧt ς๏гק๏гคtเ๏ภn、900913、ƒ4ᄃëв๏๏к, IПᄃ.。</p></blockquote><p>注意：当网页中需要配合整体视觉风格而出现全部大写／小写的情形，HTML 中请使用标准的大小写规范进行书写；并通过 <code>text-transform: uppercase;</code>／<code>text-transform: lowercase;</code> 对表现形式进行定义。</p><h3 id="不要使用不地道的缩写"><a href="#不要使用不地道的缩写" class="headerlink" title="不要使用不地道的缩写"></a>不要使用不地道的缩写</h3><p>正确：</p><blockquote><p>我们需要一位熟悉 JavaScript、HTML5，至少理解一种框架（如 Backbone.js、AngularJS、React 等）的前端开发者。</p></blockquote><p>错误：</p><blockquote><p>我们需要一位熟悉 Js、h5，至少理解一种框架（如 backbone、angular、RJS 等）的 FED。</p></blockquote><h2 id="争议"><a href="#争议" class="headerlink" title="争议"></a>争议</h2><p>以下用法略带有个人色彩，即：无论是否遵循下述规则，从语法的角度来讲都是<strong>正确</strong>的。</p><h3 id="链接之间增加空格"><a href="#链接之间增加空格" class="headerlink" title="链接之间增加空格"></a>链接之间增加空格</h3><p>用法：</p><blockquote><p>请 <a href="#">提交一个 issue</a> 并分配给相关同事。</p></blockquote><blockquote><p>访问我们网站的最新动态，请 <a href="#">点击这里</a> 进行订阅！</p></blockquote><p>对比用法：</p><blockquote><p>请<a href="#">提交一个 issue</a> 并分配给相关同事。</p></blockquote><blockquote><p>访问我们网站的最新动态，请<a href="#">点击这里</a>进行订阅！</p></blockquote><h3 id="简体中文使用直角引号"><a href="#简体中文使用直角引号" class="headerlink" title="简体中文使用直角引号"></a>简体中文使用直角引号</h3><p>用法：</p><blockquote><p>「老师，『有条不紊』的『紊』是什么意思？」</p></blockquote><p>对比用法：</p><blockquote><p>“老师，‘有条不紊’的‘紊’是什么意思？”</p></blockquote><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><table><thead><tr><th>仓库</th><th>语言</th></tr></thead><tbody><tr><td><a href="https://github.com/vinta/paranoid-auto-spacing">vinta/paranoid-auto-spacing</a></td><td>JavaScript</td></tr><tr><td><a href="https://github.com/huei90/pangu.node">huei90/pangu.node</a></td><td>Node.js</td></tr><tr><td><a href="https://github.com/huacnlee/auto-correct">huacnlee/auto-correct</a></td><td>Ruby</td></tr><tr><td><a href="https://github.com/sparanoid/space-lover">sparanoid/space-lover</a></td><td>PHP (WordPress)</td></tr><tr><td><a href="https://github.com/NauxLiu/auto-correct">nauxliu/auto-correct</a></td><td>PHP</td></tr><tr><td><a href="https://github.com/ricoa/copywriting-correct">ricoa/copywriting-correct</a></td><td>PHP</td></tr><tr><td><a href="https://github.com/hotoo/pangu.vim">hotoo/pangu.vim</a></td><td>Vim</td></tr><tr><td><a href="https://github.com/sparanoid/grunt-auto-spacing">sparanoid/grunt-auto-spacing</a></td><td>Node.js (Grunt)</td></tr><tr><td><a href="https://github.com/hjiang/scripts/blob/master/add-space-between-latin-and-cjk">hjiang/scripts/add-space-between-latin-and-cjk</a></td><td>Python</td></tr></tbody></table><h2 id="谁在这样做？"><a href="#谁在这样做？" class="headerlink" title="谁在这样做？"></a>谁在这样做？</h2><table><thead><tr><th>网站</th><th>文案</th><th>UGC</th></tr></thead><tbody><tr><td><a href="http://www.apple.com/cn/">Apple 中国</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="http://www.apple.com/hk/">Apple 香港</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="http://www.apple.com/tw/">Apple 台湾</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="http://www.microsoft.com/zh-cn/">Microsoft 中国</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="http://www.microsoft.com/zh-hk/">Microsoft 香港</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="http://www.microsoft.com/zh-tw/">Microsoft 台湾</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="https://leancloud.cn/">LeanCloud</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="https://www.zhihu.com/">知乎</a></td><td>Yes</td><td>部分用户达成</td></tr><tr><td><a href="https://www.v2ex.com/">V2EX</a></td><td>Yes</td><td>Yes</td></tr><tr><td><a href="https://segmentfault.com/">SegmentFault</a></td><td>Yes</td><td>部分用户达成</td></tr><tr><td><a href="http://apple4us.com/">Apple4us</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="https://www.wandoujia.com/">豌豆荚</a></td><td>Yes</td><td>N/A</td></tr><tr><td><a href="https://ruby-china.org/">Ruby China</a></td><td>Yes</td><td>标题达成</td></tr><tr><td><a href="https://phphub.org/">PHPHub</a></td><td>Yes</td><td>标题达成</td></tr><tr><td><a href="http://sspai.com/">少数派</a></td><td>Yes</td><td>N/A</td></tr></tbody></table><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul><li><a href="http://grammar.about.com/od/punctuationandmechanics/a/Guidelines-For-Using-Capital-Letters.htm">Guidelines for Using Capital Letters</a></li><li><a href="http://en.wikipedia.org/wiki/Letter_case">Letter case - Wikipedia</a></li><li><a href="http://www.oxforddictionaries.com/words/punctuation">Punctuation - Oxford Dictionaries</a></li><li><a href="https://owl.english.purdue.edu/owl/section/1/6/">Punctuation - The Purdue OWL</a></li><li><a href="http://www.wikihow.com/Use-English-Punctuation-Correctly">How to Use English Punctuation Corrently - wikiHow</a></li><li><a href="https://zh.opensuse.org/index.php?title=Help:%E6%A0%BC%E5%BC%8F">格式 - openSUSE</a></li><li><a href="http://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2">全角和半角 - 维基百科</a></li><li><a href="http://zh.wikipedia.org/wiki/%E5%BC%95%E8%99%9F">引号 - 维基百科</a></li><li><a href="http://zh.wikipedia.org/wiki/%E7%96%91%E5%95%8F%E9%A9%9A%E5%98%86%E8%99%9F">疑问惊叹号 - 维基百科</a></li></ul><hr><p>摘自 GitHub repository: mzlogin/chinese-copywriting-guidelines</p>]]></content>
      
      
      <categories>
          
          <category> 文档记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 标准 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
