<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Richardson Maturity Model | 小莫札记</title><meta name="keywords" content="架构,rest"><meta name="author" content="Xiaomo"><meta name="copyright" content="Xiaomo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="A model (developed by Leonard Richardson) that breaks down the principal elements of a REST approach into three steps. These introduce resources, http verbs, and hypermedia controls.  Recently I’ve be">
<meta property="og:type" content="article">
<meta property="og:title" content="Richardson Maturity Model">
<meta property="og:url" content="http://blog.xmsong.cn/2020/01/31/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/">
<meta property="og:site_name" content="小莫札记">
<meta property="og:description" content="A model (developed by Leonard Richardson) that breaks down the principal elements of a REST approach into three steps. These introduce resources, http verbs, and hypermedia controls.  Recently I’ve be">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://blog.xmsong.cn/img/4.jpg">
<meta property="article:published_time" content="2020-01-31T14:36:05.000Z">
<meta property="article:modified_time" content="2021-09-10T06:49:16.738Z">
<meta property="article:author" content="Xiaomo">
<meta property="article:tag" content="架构">
<meta property="article:tag" content="rest">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.xmsong.cn/img/4.jpg"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://blog.xmsong.cn/2020/01/31/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-09-10 06:49:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">48</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/4.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小莫札记</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Richardson Maturity Model</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-01-31T14:36:05.000Z" title="发表于 2020-01-31 14:36:05">2020-01-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-10T06:49:16.738Z" title="更新于 2021-09-10 06:49:16">2021-09-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E6%9E%B6%E6%9E%84%E7%90%86%E8%AE%BA/">架构理论</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><pre><code>A model (developed by Leonard Richardson) that breaks down the principal elements of a REST approach into three steps. These introduce resources, http verbs, and hypermedia controls.
</code></pre>
<p>Recently I’ve been reading drafts of Rest In Practice: a book that a couple of my colleagues have been working on. Their aim is to explain how to use Restful web services to handle many of the integration problems that enterprises face. At the heart of the book is the notion that the web is an existence proof of a massively scalable distributed system that works really well, and we can take ideas from that to build integrated systems more easily.</p>
<p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure1.png" alt="Steps toward REST"><br>Figure 1.Steps toward REST</p>
<p>To help explain the specific properties of a web-style system, the authors use a model of restful maturity that was developed by Leonard Richardson and <a target="_blank" rel="noopener" href="https://www.crummy.com/writing/speaking/2008-QCon/act3.html">explained</a> at a QCon talk. The model is nice way to think about using these techniques, so I thought I’d take a stab of my own explanation of it. (The protocol examples here are only illustrative, I didn’t feel it was worthwhile to code and test them up, so there may be problems in the detail.)</p>
<h2 id="Level-0"><a href="#Level-0" class="headerlink" title="Level 0"></a>Level 0</h2><p>The starting point for the model is using HTTP as a transport system for remote interactions, but without using any of the mechanisms of the web. Essentially what you are doing here is using HTTP as a tunneling mechanism for your own remote interaction mechanism, usually based on <a target="_blank" rel="noopener" href="https://www.enterpriseintegrationpatterns.com/patterns/messaging/EncapsulatedSynchronousIntegration.html">Remote Procedure Invocation</a>.</p>
<p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure2.png" alt="An example interaction at Level 0"><br>Figure 2.An example interaction at Level 0</p>
<p>Let’s assume I want to book an appointment with my doctor. My appointment software first needs to know what open slots my doctor has on a given date, so it makes a request of the hospital appointment system to obtain that information. In a level 0 scenario, the hospital will expose a service endpoint at some URI. I then post to that endpoint a document containing the details of my request.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/appointmentService</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;openSlotRequest <span class="attr">date</span> = <span class="string">&quot;2010-01-04&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>The server then will return a document giving me this information</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">openSlotList</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">doctor</span> <span class="attr">id</span> = <span class="string">&quot;mjones&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">start</span> = <span class="string">&quot;1600&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1650&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">doctor</span> <span class="attr">id</span> = <span class="string">&quot;mjones&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">openSlotList</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>I’m using XML here for the example, but the content can actually be anything: JSON, YAML, key-value pairs, or any custom format.</p>
<p>My next step is to book an appointment, which I can again do by posting a document to the endpoint.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/appointmentService</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">appointmentRequest</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">patient</span> <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">appointmentRequest</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>If all is well I get a response saying my appointment is booked.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">appointment</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">patient</span> <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">appointment</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>If there is a problem, say someone else got in before me, then I’ll get some kind of error message in the reply body.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">appointmentRequestFailure</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">patient</span> <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">reason</span>&gt;</span>Slot not available<span class="tag">&lt;/<span class="name">reason</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">appointmentRequestFailure</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>So far this is a straightforward RPC style system. It’s simple as it’s just slinging plain old XML (POX) back and forth. If you use SOAP or XML-RPC it’s basically the same mechanism, the only difference is that you wrap the XML messages in some kind of envelope.</p>
<h2 id="Level-1-Resources"><a href="#Level-1-Resources" class="headerlink" title="Level 1 - Resources"></a>Level 1 - Resources</h2><p>The first step towards the Glory of Rest in the RMM is to introduce resources. So now rather than making all our requests to a singular service endpoint, we now start talking to individual resources.</p>
<p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure3.png" alt="Level 1 adds resources"><br>Figure 3.Level 1 adds resources</p>
<p>So with our initial query, we might have a resource for given doctor.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/doctors/mjones</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line"><span class="applescript">&lt;openSlotRequest <span class="built_in">date</span> = <span class="string">&quot;2010-01-04&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>The reply carries the same basic information, but each slot is now a resource that can be addressed individually.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;openSlotList&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;1234&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;5678&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1600&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1650&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">&lt;/openSlotList&gt;</span></span><br></pre></td></tr></table></figure>

<p>With specific resources booking an appointment means posting to a particular slot.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/slots/1234</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">appointmentRequest</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">patient</span> <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">appointmentRequest</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>If all goes well I get a similar reply to before.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;appointment&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;1234&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;patient <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">&lt;/appointment&gt;</span></span><br></pre></td></tr></table></figure>

<p>The difference now is that if anyone needs to do anything about the appointment, like book some tests, they first get hold of the appointment resource, which might have a URI like <code>http://royalhope.nhs.uk/slots/1234/appointment</code>, and post to that resource.</p>
<p>To an object guy like me this is like the notion of object identity. Rather than calling some function in the ether and passing arguments, we call a method on one particular object providing arguments for the other information.</p>
<h2 id="Level-2-HTTP-Verbs"><a href="#Level-2-HTTP-Verbs" class="headerlink" title="Level 2 - HTTP Verbs"></a>Level 2 - HTTP Verbs</h2><p>I’ve used HTTP POST verbs for all my interactions here in level 0 and 1, but some people use GETs instead or in addition. At these levels it doesn’t make much difference, they are both being used as tunneling mechanisms allowing you to tunnel your interactions through HTTP. Level 2 moves away from this, using the HTTP verbs as closely as possible to how they are used in HTTP itself.</p>
<p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure4.png" alt="Level 2 addes HTTP verbs"><br>Figure 4.Level 2 addes HTTP verbs</p>
<p>For our the list of slots, this means we want to use GET.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/doctors/mjones/slots?date=20100104&amp;status=open</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>royalhope.nhs.uk</span><br></pre></td></tr></table></figure>

<p>The reply is the same as it would have been with the POST</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;openSlotList&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;1234&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;5678&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1600&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1650&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">&lt;/openSlotList&gt;</span></span><br></pre></td></tr></table></figure>

<p>At Level 2, the use of GET for a request like this is crucial. HTTP defines GET as a safe operation, that is it doesn’t make any significant changes to the state of anything. This allows us to invoke GETs safely any number of times in any order and get the same results each time. An important consequence of this is that it allows any participant in the routing of requests to use caching, which is a key element in making the web perform as well as it does. HTTP includes various measures to support caching, which can be used by all participants in the communication. By following the rules of HTTP we’re able to take advantage of that capability.</p>
<p>To book an appointment we need an HTTP verb that does change state, a POST or a PUT. I’ll use the same POST that I did earlier.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/slots/1234</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">appointmentRequest</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">patient</span> <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">appointmentRequest</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>The trade-offs between using POST and PUT here are more than I want to go into here, maybe I’ll do a separate article on them some day. But I do want to point out that some people incorrectly make a correspondence between POST/PUT and create/update. The choice between them is rather different to that.</p>
<p>Even if I use the same post as level 1, there’s another significant difference in how the remote service responds. If all goes well, the service replies with a response code of 201 to indicate that there’s a new resource in the world.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>slots/1234/appointment</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;appointment&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;1234&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;patient <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">&lt;/appointment&gt;</span></span><br></pre></td></tr></table></figure>

<p>The 201 response includes a location attribute with a URI that the client can use to GET the current state of that resource in the future. The response here also includes a representation of that resource to save the client an extra call right now.</p>
<p>There is another difference if something goes wrong, such as someone else booking the session.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">409</span> Conflict</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;openSlotList&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;5678&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1600&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1650&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">&lt;/openSlotList&gt;</span></span><br></pre></td></tr></table></figure>

<p>The important part of this response is the use of an HTTP response code to indicate something has gone wrong. In this case a 409 seems a good choice to indicate that someone else has already updated the resource in an incompatible way. Rather than using a return code of 200 but including an error response, at level 2 we explicitly use some kind of error response like this. It’s up to the protocol designer to decide what codes to use, but there should be a non-2xx response if an error crops up. Level 2 introduces using HTTP verbs and HTTP response codes.</p>
<p>There is an inconsistency creeping in here. REST advocates talk about using all the HTTP verbs. They also justify their approach by saying that REST is attempting to learn from the practical success of the web. But the world-wide web doesn’t use PUT or DELETE much in practice. There are sensible reasons for using PUT and DELETE more, but the existence proof of the web isn’t one of them.</p>
<p>The key elements that are supported by the existence of the web are the strong separation between safe (eg GET) and non-safe operations, together with using status codes to help communicate the kinds of errors you run into.</p>
<h2 id="Level-3-Hypermedia-Controls"><a href="#Level-3-Hypermedia-Controls" class="headerlink" title="Level 3 - Hypermedia Controls"></a>Level 3 - Hypermedia Controls</h2><p>The final level introduces something that you often hear referred to under the ugly acronym of HATEOAS (Hypertext As The Engine Of Application State). It addresses the question of how to get from a list open slots to knowing what to do to book an appointment.</p>
<p><img src="/img/blog/Richardson%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B/Figure5.png" alt="Level 3 adds hypermedia controls"><br>Figure 5.Level 3 adds hypermedia controls</p>
<p>We begin with the same initial GET that we sent in level 2</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/doctors/mjones/slots?date=20100104&amp;status=open</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>royalhope.nhs.uk</span><br></pre></td></tr></table></figure>

<p>But the response has a new element</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;openSlotList&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;1234&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>&gt;</span></span><br><span class="line"><span class="nix">     &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/slot/book&quot;</span> </span></span><br><span class="line"><span class="nix">           <span class="attr">uri</span> = <span class="string">&quot;/slots/1234&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;/slot&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;5678&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1600&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1650&quot;</span>&gt;</span></span><br><span class="line"><span class="nix">     &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/slot/book&quot;</span> </span></span><br><span class="line"><span class="nix">           <span class="attr">uri</span> = <span class="string">&quot;/slots/5678&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;/slot&gt;</span></span><br><span class="line"><span class="nix">&lt;/openSlotList&gt;</span></span><br></pre></td></tr></table></figure>

<p>Each slot now has a link element which contains a URI to tell us how to book an appointment.</p>
<p>The point of hypermedia controls is that they tell us what we can do next, and the URI of the resource we need to manipulate to do it. Rather than us having to know where to post our appointment request, the hypermedia controls in the response tell us how to do it.</p>
<p>The POST would again copy that of level 2</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/slots/1234</span> <span class="meta">HTTP/1.1</span></span><br><span class="line">[various other headers]</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">appointmentRequest</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">patient</span> <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">appointmentRequest</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>And the reply contains a number of hypermedia controls for different things to do next.</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">201</span> Created</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>http://royalhope.nhs.uk/slots/1234/appointment</span><br><span class="line">[various headers]</span><br><span class="line"></span><br><span class="line"><span class="nix">&lt;appointment&gt;</span></span><br><span class="line"><span class="nix">  &lt;slot <span class="attr">id</span> = <span class="string">&quot;1234&quot;</span> <span class="attr">doctor</span> = <span class="string">&quot;mjones&quot;</span> <span class="attr">start</span> = <span class="string">&quot;1400&quot;</span> <span class="attr">end</span> = <span class="string">&quot;1450&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;patient <span class="attr">id</span> = <span class="string">&quot;jsmith&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/appointment/cancel&quot;</span></span></span><br><span class="line"><span class="nix">        <span class="attr">uri</span> = <span class="string">&quot;/slots/1234/appointment&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/appointment/addTest&quot;</span></span></span><br><span class="line"><span class="nix">        <span class="attr">uri</span> = <span class="string">&quot;/slots/1234/appointment/tests&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;link <span class="attr">rel</span> = <span class="string">&quot;self&quot;</span></span></span><br><span class="line"><span class="nix">        <span class="attr">uri</span> = <span class="string">&quot;/slots/1234/appointment&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/appointment/changeTime&quot;</span></span></span><br><span class="line"><span class="nix">        <span class="attr">uri</span> = <span class="string">&quot;/doctors/mjones/slots?date=20100104&amp;status=open&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/appointment/updateContactInfo&quot;</span></span></span><br><span class="line"><span class="nix">        <span class="attr">uri</span> = <span class="string">&quot;/patients/jsmith/contactInfo&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">  &lt;link <span class="attr">rel</span> = <span class="string">&quot;/linkrels/help&quot;</span></span></span><br><span class="line"><span class="nix">        <span class="attr">uri</span> = <span class="string">&quot;/help/appointment&quot;</span>/&gt;</span></span><br><span class="line"><span class="nix">&lt;/appointment&gt;</span></span><br></pre></td></tr></table></figure>

<p>One obvious benefit of hypermedia controls is that it allows the server to change its URI scheme without breaking clients. As long as clients look up the “addTest” link URI then the server team can juggle all URIs other than the initial entry points.</p>
<p>A further benefit is that it helps client developers explore the protocol. The links give client developers a hint as to what may be possible next. It doesn’t give all the information: both the “self” and “cancel” controls point to the same URI - they need to figure out that one is a GET and the other a DELETE. But at least it gives them a starting point as to what to think about for more information and to look for a similar URI in the protocol documentation.</p>
<p>Similarly it allows the server team to advertise new capabilities by putting new links in the responses. If the client developers are keeping an eye out for unknown links these links can be a trigger for further exploration.</p>
<p>There’s no absolute standard as to how to represent hypermedia controls. What I’ve done here is to use the current recommendations of the REST in Practice team, which is to follow ATOM (RFC 4287) I use a <code>&lt;link&gt;</code> element with a uri attribute for the target URI and a rel attribute for to describe the kind of relationship. A well known relationship (such as self for a reference to the element itself) is bare, any specific to that server is a fully qualified URI. ATOM states that the definition for well-known linkrels is the <a target="_blank" rel="noopener" href="https://www.iana.org/assignments/link-relations/link-relations.xhtml">Registry of Link Relations</a> . As I write these are confined to what’s done by ATOM, which is generally seen as a leader in level 3 restfulness.</p>
<h2 id="The-Meaning-of-the-Levels"><a href="#The-Meaning-of-the-Levels" class="headerlink" title="The Meaning of the Levels"></a>The Meaning of the Levels</h2><p>I should stress that the RMM, while a good way to think about what the elements of REST, is not a definition of levels of REST itself. Roy Fielding has made it clear that <a target="_blank" rel="noopener" href="https://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven">level 3 RMM is a pre-condition of REST</a>. Like many terms in software, REST gets lots of definitions, but since Roy Fielding coined the term, his definition should carry more weight than most.</p>
<p>What I find useful about this RMM is that it provides a good step by step way to understand the basic ideas behind restful thinking. As such I see it as tool to help us learn about the concepts and not something that should be used in some kind of assessment mechanism. I don’t think we have enough examples yet to be really sure that the restful approach is the right way to integrate systems, I do think it’s a very attractive approach and the one that I would recommend in most situations.</p>
<p>Talking about this with Ian Robinson, he stressed that something he found attractive about this model when Leonard Richardson first presented it was its relationship to common design techniques.</p>
<ul>
<li>Level 1 tackles the question of handling complexity by using divide and conquer, breaking a large service endpoint down into multiple resources.</li>
<li>Level 2 introduces a standard set of verbs so that we handle similar situations in the same way, removing unnecessary variation.</li>
<li>Level 3 introduces discoverability, providing a way of making a protocol more self-documenting.</li>
</ul>
<p>The result is a model that helps us think about the kind of HTTP service we want to provide and frame the expectations of people looking to interact with it.</p>
<h2 id="RMM-Richardson-Maturity-Model"><a href="#RMM-Richardson-Maturity-Model" class="headerlink" title="*[RMM]: Richardson Maturity Model"></a>*[RMM]: Richardson Maturity Model</h2><p>原文作者：Martin Fowler<br><a target="_blank" rel="noopener" href="https://martinfowler.com/articles/richardsonMaturityModel.html">链接</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2eac3dc053c1">中文译文</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9E%B6%E6%9E%84/">架构</a><a class="post-meta__tags" href="/tags/rest/">rest</a></div><div class="post_share"><div class="social-share" data-image="/img/4.jpg" data-sites="wechat,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/02/02/base64%E6%A0%BC%E5%BC%8F%E5%A4%84%E7%90%86/"><img class="prev-cover" src="/img/5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">base64格式处理</div></div></a></div><div class="next-post pull-right"><a href="/2020/01/30/%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86002/"><img class="next-cover" src="/img/6.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">面试题目收集002</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-0"><span class="toc-number">1.</span> <span class="toc-text">Level 0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-1-Resources"><span class="toc-number">2.</span> <span class="toc-text">Level 1 - Resources</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-2-HTTP-Verbs"><span class="toc-number">3.</span> <span class="toc-text">Level 2 - HTTP Verbs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-3-Hypermedia-Controls"><span class="toc-number">4.</span> <span class="toc-text">Level 3 - Hypermedia Controls</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Meaning-of-the-Levels"><span class="toc-number">5.</span> <span class="toc-text">The Meaning of the Levels</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RMM-Richardson-Maturity-Model"><span class="toc-number">6.</span> <span class="toc-text">*[RMM]: Richardson Maturity Model</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Xiaomo</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/#/Integrated/index"><span>京ICP备2021004430号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script></div></body></html>