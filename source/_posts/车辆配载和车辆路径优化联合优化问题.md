---
layout: posts
title: 车辆配载和车辆路径优化联合优化问题
date: 2020-01-28 18:09:24
categories:
- 论文学习
- 算法优化
---
## 问题：
车辆配载（VFP）和车辆路径优化（VRP）联合优化问题

## 目标：
求解整体运输成本最低（引入时间成本转换为运输成本的方法，转为单目标优化）

## 目标函数：
$$
Z  =  \sum_k^{k\in K}x_{ij}^k(C_k+F_k\sum_i^{i\in U}\sum_j^{j\in U}d_{ij})\\
+\sum_k^{k \in K}\sum_m^{m \in M}r_m(h_m^k-H_m)\\
\qquad\quad+I\sum_k^{k \in K}\max(\sum_m^{m \in M}q_my_m^k-Q_ky_m^k,0)\\
\qquad\quad+I\sum_k^{k \in K}\max(\sum_m^{m \in M}v_my_m^k-V_ky_m^k,0) \tag 1
$$

## 约束条件
$$
\sum_m^{m\in M}q_my_m^k\leq Q_ky_m^k\qquad k\in K \tag 2
$$
$$
\sum_m^{m\in M}v_my_m^k\leq V_ky_m^k\qquad k\in K \tag 3
$$
$$
\sum_i^{i\in U}x_{if_m}^k=\sum_i^{i\in U}x_{it_m}^k\qquad k\in K,m\in M \tag 4
$$
$$
y_m^k=0 or 1\qquad k\in K,m\in M \tag 5
$$
$$
x_{ij}^k=0 or 1\qquad k\in K,i\in U,j\in U \tag 6
$$
$$
\sum_i^{i\in E}=0\qquad k\in K,j\in U \tag 7
$$

**参数含义：**
$K$：为“空闲”车辆集合；
$k$：为车辆编号，其中$k\in K$；
$E$：为车辆初始位置集合；
$e_k$：为$k$车得初始位置，其中$e_k\in E$；
$Q_k$：为$k$车的额定载重；
$V_k$：为$k$车的额定再放，拉卷货车为鞍座个数，拉板货车为最多可拉钢板张数；
$M$：为待匹配订单数；
$m$：为订单序号，其中$m\in M$；
$F$：为订单的取货点位置集合；
$f_m$：为m订单的取货点位置，其中$f_m\in F$；
$T$：为订单的送货点位置集合；
$t_m$：为$m$订单的送货点位置，其中$t_m\in T$
$q_m$：为$m$订单的货物总重量；
$v_m$：为$m$订单的货物总件数；
$H_m$：为完成$m$订单所花费的最短时间，即货车以平均速度从取货点到送货点所花事件；
$h_m^k$：为$k$车从接收$m$订单任务起到送到其送货点所花时间，含从车辆初始位置到取货点所用时间；
$U$：物流节点，包含货车起始位置、取货点位置、送货点位置，即$U = E \cup F \cup T$；
$d_{ij}$：从物流节点$i$到$j$的距离，可通过经纬度坐标计算，或按给定运距计算，其中$i,j \in U$；
$x_{ij}^k$：为自定义参数，其中
$$
x_{ij}^k=
\begin{cases}
1, & \text{$k$车从$i$到$j$节点} \\
0, & \text{其他情况}
\end{cases}
$$
$y_m^k$：为自定义参数，其中
$$
y_m^k=
\begin{cases}
1, & \text{$k$车运送$m$订单} \\
0, & \text{其他情况}
\end{cases}
$$
$C_k$：为$k$车均摊到每月的固定费用，$C_k=c_k^1+c_k^2+c_k^3+c_k^4$，具体如下，

&emsp;$c_k^1$为折旧费用，$c_k^1=\frac{P_k^1}{D_k^1 \cdot A_k}$，其中$P_k^1$为$k$车的采购费用，$D_k^1$为$k$车的折旧时长，$A_k$为$k$车的月均出车次数；

&emsp;$c_k^2$为保险费用，$c_k^2=\frac{P_k^2}{D_k^2 \cdot A_k}$，其中$P_k^2$为$k$车的保险费用，$D_k^2$为$k$车的保险时长，$A_k$为$k$车的月均出车次数；

&emsp;$c_k^3$为人工成本，$c_k^3=\frac{P_k^3 \cdot n_k}{A_k}$，其中$P_k^3$为$k$车的司机月工资，$n_k$为$k$车的司机数量，$A_k$为$k$车的月均出车次数，如为公用的替班司机，则按比例均摊到每辆车上；

&emsp;$c_k^4$ ==？？？==；

$F_k$：为$k$车的均摊到每公里的浮动费用，$F_k=f_k^5+f_k^6+f_k^7+f_k^8$，具体如下

&emsp;$f_k^5$为燃油费，$f_k^5=P_k^5 \cdot p$，其中$p_k^5$为燃油费单价，$p$为$k$车满载时每公里油耗；

&emsp;$f_k^6$为维修保养费，$f_k^6=\frac{P_k^6}{D_k^6}$，其中$P_k^6$为维修保养费用，$D_k^6$为维修保养间隔里程；

&emsp;$f_k^7$为轮胎损耗，$f_k^7=\frac{P_k^7 \cdot l_k}{D_k^7}$，其中$P_k^7$为单个轮胎费用，$D_k^7$为更换轮胎间隔里程，$l_k$为该车每次更换轮胎数；

&emsp;$f_k^8$为路桥罚款等，$f_k^8=\frac{P_k^8}{l}$，其中$P_k^8$为过桥费罚款等合计费用，$l$为行驶里程；

$r_m$：为时间成本系数，定义时间成本$b_m=r_m(h_m^k-H_m)$，据此将时间成本转换为运输成本；
$I$：为超载成本系数，为了避免在求最优解时出现超载情况，定义$I$为很大的一个数。

## 问题求解
采用算法：遗传算法
适应度定义：$f=\frac{1}{z}$
终止条件：达到以下情形之一
- $适应度方差 \lt \varepsilon$
- $适应度 \div 最好的适应度 \gt \lambda$
- $每代的最优解个数=X$

即认为结果是收敛的，终止算法；若代数达到设定上限，则认为不收敛，重新进行求解。

## 算法流程图
```mermaid
flowchat
st=>start: 开始
e=>end: 结束
op=>operation: 我的操作
init=>operation: T=0
code=>inputoutput: 编码
op1=>inputoutput: 初始化种群
op2=>operation: 适应度评价
print=>operation: 输出结果
generate=>inputoutput: 根据适应度选择进入下一代的个体
直接复制到下一代
xo=>inputoutput: 选择杂交个体，进行杂交操作，复制到下一代
xr=>inputoutput: 选择变异个体，进行变异操作，复制到下一代
next=>operation: T+=1
cond=>condition: 满足终止条件？

st->op->op1->op2->cond
cond(yes)->print->e
cond(no)->generate->xo->xr(right)->op2
```

## 求解代码
略
## 来源
[1]陆江. 基于虚拟物流平台的多约束配车模型研究[D].北京邮电大学,2018.